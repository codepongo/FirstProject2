<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FirstProject2: include/coff.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FirstProject2
   &#160;<span id="projectnumber">12.12.2011</span>
   </div>
   <div id="projectbrief">Framework</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">include/coff.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef __COFF_H__</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define __COFF_H__</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;objectfileparser.h&quot;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keyword">namespace </span>System
<a name="l00007"></a>00007 {
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#pragma pack(push,2)</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="preprocessor">#define IMAGE_DOS_SIGNATURE                 0x5A4D      // MZ</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_OS2_SIGNATURE                 0x454E      // NE</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_OS2_SIGNATURE_LE              0x454C      // LE</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_VXD_SIGNATURE                 0x454C      // LE</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_NT_SIGNATURE                  0x00004550  // PE00</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="keyword">struct </span>OptionalStandardHeader
<a name="l00018"></a>00018 {
<a name="l00019"></a>00019         uint16  Magic;          <span class="comment">//      Unsigned integer identifying the state of the image file. The most common number is 0413 octal (0x10B), identifying it as a normal executable file. 0407 (0x107) identifies a ROM image.</span>
<a name="l00020"></a>00020         uint8   MajorLinkerVersion;<span class="comment">//   Linker major version number.</span>
<a name="l00021"></a>00021         uint8   MinorLinkerVersion;<span class="comment">//   Linker minor version number.</span>
<a name="l00022"></a>00022         uint32  SizeOfCode;<span class="comment">//   Size of the code (text) section, or the sum of all code sections if there are multiple sections.</span>
<a name="l00023"></a>00023         uint32  SizeOfInitializedData;<span class="comment">//        Size of the initialized data section, or the sum of all such sections if there are multiple data sections.</span>
<a name="l00024"></a>00024         uint32  SizeOfUninitializedData;<span class="comment">//      Size of the uninitialized data section (BSS), or the sum of all such sections if there are multiple BSS sections.</span>
<a name="l00025"></a>00025         uint32  AddressOfEntryPoint;<span class="comment">//  Address of entry point, relative to image base, when executable file is loaded into memory. For program images, this is the starting address. For device drivers, this is the address of the initialization function. An entry point is optional for DLLs. When none is present this field should be 0.</span>
<a name="l00026"></a>00026         uint32  BaseOfCode;<span class="comment">//   Address, relative to image base, of beginning of code section, when loaded into memory.</span>
<a name="l00027"></a>00027 };
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">struct </span>WindowsHeader
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031         uint32  ImageBase;<span class="comment">//    Preferred address of first byte of image when loaded into memory; must be a multiple of 64K. The default for DLLs is 0x10000000. The default for Windows CE EXEs is 0x00010000. The default for Windows NT, Windows 95, and Windows 98 is 0x00400000.      </span>
<a name="l00032"></a>00032         uint32  SectionAlignment;<span class="comment">//     Alignment (in bytes) of sections when loaded into memory. Must greater or equal to File Alignment. Default is the page size for the architecture.          </span>
<a name="l00033"></a>00033         uint32  FileAlignment;<span class="comment">//        Alignment factor (in bytes) used to align the raw data of sections in the image file. The value should be a power of 2 between 512 and 64K inclusive. The default is 512. If the SectionAlignment is less than the architecture’s page size than this must match the SectionAlignment.     </span>
<a name="l00034"></a>00034         uint16  MajorOperatingSystemVersion;<span class="comment">//  Major version number of required OS.       </span>
<a name="l00035"></a>00035         uint16  MinorOperatingSystemVersion;<span class="comment">//  Minor version number of required OS.       </span>
<a name="l00036"></a>00036         uint16  MajorImageVersion;<span class="comment">//    Major version number of image.     </span>
<a name="l00037"></a>00037         uint16  MinorImageVersion;<span class="comment">//    Minor version number of image.     </span>
<a name="l00038"></a>00038         uint16  MajorSubsystemVersion;<span class="comment">//        Major version number of subsystem.         </span>
<a name="l00039"></a>00039         uint16  MinorSubsystemVersion;<span class="comment">//        Minor version number of subsystem.         </span>
<a name="l00040"></a>00040         uint32  Reserved;<span class="comment">//     dd         </span>
<a name="l00041"></a>00041         uint32  SizeOfImage;<span class="comment">//  Size, in bytes, of image, including all headers; must be a multiple of Section Alignment.          </span>
<a name="l00042"></a>00042         uint32  SizeOfHeaders;<span class="comment">//        Combined size of MS-DOS stub, PE Header, and section headers rounded up to a multiple of FileAlignment.    </span>
<a name="l00043"></a>00043         uint32  CheckSum;<span class="comment">//     Image file checksum. The algorithm for computing is incorporated into IMAGHELP.DLL. The following are checked for validation at load time: all drivers, any DLL loaded at boot time, and any DLL that ends up in the server.       </span>
<a name="l00044"></a>00044         uint16  Subsystem;<span class="comment">//    Subsystem required to run this image. See “Windows NT Subsystem” below for more information.       </span>
<a name="l00045"></a>00045         uint16  DLLCharacteristics;<span class="comment">//   See “DLL Characteristics” below for more information.      </span>
<a name="l00046"></a>00046         uint32  SizeOfStackReserve;<span class="comment">//   Size of stack to reserve. Only the Stack Commit Size is committed; the rest is made available one page at a time, until reserve size is reached.           </span>
<a name="l00047"></a>00047         uint32  SizeOfStackCommit;<span class="comment">//    Size of stack to commit.           </span>
<a name="l00048"></a>00048         uint32  SizeOfHeapReserve;<span class="comment">//    Size of local heap space to reserve. Only the Heap Commit Size is committed; the rest is made available one page at a time, until reserve size is reached.         </span>
<a name="l00049"></a>00049         uint32  SizeOfHeapCommit;<span class="comment">//     Size of local heap space to commit.        </span>
<a name="l00050"></a>00050         uint32  LoaderFlags;<span class="comment">//  Obsolete.          </span>
<a name="l00051"></a>00051         uint32  NumberOfRvaAndSizes;<span class="comment">//  Number of data-dictionary entries in the remainder of the Optional Header. Each describes a location and size.   </span>
<a name="l00052"></a>00052 };
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="keyword">struct </span>IMAGE_OPTIONAL_HEADER_X
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056     WORD        Magic;
<a name="l00057"></a>00057     BYTE        MajorLinkerVersion;
<a name="l00058"></a>00058     BYTE        MinorLinkerVersion;
<a name="l00059"></a>00059     DWORD       SizeOfCode;
<a name="l00060"></a>00060     DWORD       SizeOfInitializedData;
<a name="l00061"></a>00061     DWORD       SizeOfUninitializedData;
<a name="l00062"></a>00062     DWORD       AddressOfEntryPoint;
<a name="l00063"></a>00063     DWORD       BaseOfCode;
<a name="l00064"></a>00064 <span class="preprocessor">#ifdef _M_IX86</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>    DWORD               BaseOfData;
<a name="l00066"></a>00066 <span class="preprocessor">#endif</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068     <span class="keywordtype">size_t</span>              ImageBase;
<a name="l00069"></a>00069     DWORD       SectionAlignment;
<a name="l00070"></a>00070     DWORD       FileAlignment;
<a name="l00071"></a>00071     WORD        MajorOperatingSystemVersion;
<a name="l00072"></a>00072     WORD        MinorOperatingSystemVersion;
<a name="l00073"></a>00073     WORD        MajorImageVersion;
<a name="l00074"></a>00074     WORD        MinorImageVersion;
<a name="l00075"></a>00075     WORD        MajorSubsystemVersion;
<a name="l00076"></a>00076     WORD        MinorSubsystemVersion;
<a name="l00077"></a>00077     DWORD       Win32VersionValue;
<a name="l00078"></a>00078     DWORD       SizeOfImage;
<a name="l00079"></a>00079     DWORD       SizeOfHeaders;
<a name="l00080"></a>00080     DWORD       CheckSum;
<a name="l00081"></a>00081     WORD        Subsystem;
<a name="l00082"></a>00082     WORD        DllCharacteristics;
<a name="l00083"></a>00083     <span class="keywordtype">size_t</span>              SizeOfStackReserve;
<a name="l00084"></a>00084     <span class="keywordtype">size_t</span>              SizeOfStackCommit;
<a name="l00085"></a>00085     <span class="keywordtype">size_t</span>              SizeOfHeapReserve;
<a name="l00086"></a>00086     <span class="keywordtype">size_t</span>              SizeOfHeapCommit;
<a name="l00087"></a>00087     DWORD               LoaderFlags;
<a name="l00088"></a>00088     DWORD       NumberOfRvaAndSizes;
<a name="l00089"></a>00089 <span class="comment">//    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span>
<a name="l00090"></a>00090 };
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="comment">// Subsystem Values</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="preprocessor">#ifndef IMAGE_SUBSYSTEM_UNKNOWN</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00096"></a>00096 <span class="preprocessor">#define IMAGE_SUBSYSTEM_UNKNOWN              0   // Unknown subsystem.</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_NATIVE               1   // Image doesn&#39;t require a subsystem.</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_WINDOWS_GUI          2   // Image runs in the Windows GUI subsystem.</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_WINDOWS_CUI          3   // Image runs in the Windows character subsystem.</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_OS2_CUI              5   // image runs in the OS/2 character subsystem.</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_POSIX_CUI            7   // image runs in the Posix character subsystem.</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_NATIVE_WINDOWS       8   // image is a native Win9x driver.</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_WINDOWS_CE_GUI       9   // Image runs in the Windows CE subsystem.</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_EFI_APPLICATION      10  //</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER  11   //</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER   12  //</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_EFI_ROM              13</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SUBSYSTEM_XBOX                 14</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00110"></a>00110 <span class="preprocessor">#endif</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span>
<a name="l00112"></a>00112 <span class="comment">/*</span>
<a name="l00113"></a>00113 <span class="comment">struct WindowsHeader</span>
<a name="l00114"></a>00114 <span class="comment">{</span>
<a name="l00115"></a>00115 <span class="comment">        28 / 24 4 / 8   ImageBase       Preferred address of first byte of image when loaded into memory; must be a multiple of 64K. The default for DLLs is 0x10000000. The default for Windows CE EXEs is 0x00010000. The default for Windows NT, Windows 95, and Windows 98 is 0x00400000.      </span>
<a name="l00116"></a>00116 <span class="comment">        32 / 32 4       SectionAlignment        Alignment (in bytes) of sections when loaded into memory. Must greater or equal to File Alignment. Default is the page size for the architecture.          </span>
<a name="l00117"></a>00117 <span class="comment">        36 / 36 4       FileAlignment   Alignment factor (in bytes) used to align the raw data of sections in the image file. The value should be a power of 2 between 512 and 64K inclusive. The default is 512. If the SectionAlignment is less than the architecture’s page size than this must match the SectionAlignment.     </span>
<a name="l00118"></a>00118 <span class="comment">        40 / 40 2       MajorOperatingSystemVersion     Major version number of required OS.       </span>
<a name="l00119"></a>00119 <span class="comment">        42 / 42 2       MinorOperatingSystemVersion     Minor version number of required OS.       </span>
<a name="l00120"></a>00120 <span class="comment">        44 / 44 2       MajorImageVersion       Major version number of image.     </span>
<a name="l00121"></a>00121 <span class="comment">        46 / 46 2       MinorImageVersion       Minor version number of image.     </span>
<a name="l00122"></a>00122 <span class="comment">        48 / 48 2       MajorSubsystemVersion   Major version number of subsystem.         </span>
<a name="l00123"></a>00123 <span class="comment">        50 / 50 2       MinorSubsystemVersion   Minor version number of subsystem.         </span>
<a name="l00124"></a>00124 <span class="comment">        52 / 52 4       Reserved        dd         </span>
<a name="l00125"></a>00125 <span class="comment">        56 / 56 4       SizeOfImage     Size, in bytes, of image, including all headers; must be a multiple of Section Alignment.          </span>
<a name="l00126"></a>00126 <span class="comment">        60 / 60 4       SizeOfHeaders   Combined size of MS-DOS stub, PE Header, and section headers rounded up to a multiple of FileAlignment.    </span>
<a name="l00127"></a>00127 <span class="comment">        64 / 64 4       CheckSum        Image file checksum. The algorithm for computing is incorporated into IMAGHELP.DLL. The following are checked for validation at load time: all drivers, any DLL loaded at boot time, and any DLL that ends up in the server.       </span>
<a name="l00128"></a>00128 <span class="comment">        68 / 68 2       Subsystem       Subsystem required to run this image. See “Windows NT Subsystem” below for more information.       </span>
<a name="l00129"></a>00129 <span class="comment">        70 / 70 2       DLL Characteristics     See “DLL Characteristics” below for more information.      </span>
<a name="l00130"></a>00130 <span class="comment">        72 / 72 4 / 8   SizeOfStackReserve      Size of stack to reserve. Only the Stack Commit Size is committed; the rest is made available one page at a time, until reserve size is reached.           </span>
<a name="l00131"></a>00131 <span class="comment">        76 / 80 4 / 8   SizeOfStackCommit       Size of stack to commit.           </span>
<a name="l00132"></a>00132 <span class="comment">        80 / 88 4 / 8   SizeOfHeapReserve       Size of local heap space to reserve. Only the Heap Commit Size is committed; the rest is made available one page at a time, until reserve size is reached.         </span>
<a name="l00133"></a>00133 <span class="comment">        84 / 96 4 / 8   SizeOfHeapCommit        Size of local heap space to commit.        </span>
<a name="l00134"></a>00134 <span class="comment">        88 / 104        4       LoaderFlags     Obsolete.          </span>
<a name="l00135"></a>00135 <span class="comment">        92 / 108        4       NumberOfRvaAndSizes     Number of data-dictionary entries in the remainder of the Optional Header. Each describes a location and size.   </span>
<a name="l00136"></a>00136 <span class="comment">};</span>
<a name="l00137"></a>00137 <span class="comment">*/</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="keyword">struct </span>IMAGE_IMPORT_DIRECTORY
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141         uint32 ImportLookupTable;<span class="comment">// RVA of the Import Lookup Table </span>
<a name="l00142"></a>00142         uint32 DateTimeStamp;<span class="comment">// Always 0 (see Section 23.1).</span>
<a name="l00143"></a>00143         uint32 ForwarderChain;  <span class="comment">//Always 0 (see Section 23.1).</span>
<a name="l00144"></a>00144         uint32 Name;<span class="comment">// RVA of null terminated ASCII string</span>
<a name="l00145"></a>00145         uint32 ImportAddressTable;<span class="comment">// RVA of Import Address Table (this is the same as the RVA of the IAT descriptor in the optional header). </span>
<a name="l00146"></a>00146 };
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">// Seems to be undefined in WinNT.h</span>
<a name="l00149"></a>00149 <span class="preprocessor">#define IMAGE_FILE_MACHINE_M68K 0x268</span>
<a name="l00150"></a>00150 <span class="preprocessor"></span>
<a name="l00151"></a>00151 <span class="preprocessor">#define IMAGE_FILE_AGGRESSIVE_WS_TRIM 0x10</span>
<a name="l00152"></a>00152 <span class="preprocessor"></span>
<a name="l00153"></a>00153 <span class="keyword">struct </span><span class="comment">/*__declspec(align(2))*/</span> IMAGE_AUX_SYMBOL_FUNCTION
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155         uint32 TagIndex;
<a name="l00156"></a>00156         uint32 TotalSize;
<a name="l00157"></a>00157         uint32 PointerToLinenumber;
<a name="l00158"></a>00158         uint32 PointerToNextFunction;
<a name="l00159"></a>00159         uint16 Unused;
<a name="l00160"></a>00160 };
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="keyword">struct </span><span class="comment">/*__declspec(align(2))*/</span> IMAGE_AUX_SYMBOL_FUNCTION2
<a name="l00163"></a>00163 {
<a name="l00164"></a>00164         uint32 Unused;
<a name="l00165"></a>00165         uint16 Linenumber;
<a name="l00166"></a>00166         uint16 Unused2;
<a name="l00167"></a>00167         uint32 PointerToNextFunction;
<a name="l00168"></a>00168         uint16 Unused3;
<a name="l00169"></a>00169 };
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="keyword">struct </span><span class="comment">/*__declspec(align(2))*/</span> IMAGE_AUX_SYMBOL_SECTION
<a name="l00172"></a>00172 {
<a name="l00173"></a>00173         uint32   Length;                         <span class="comment">// section length</span>
<a name="l00174"></a>00174         uint16    NumberOfRelocations;            <span class="comment">// number of relocation entries</span>
<a name="l00175"></a>00175         uint16    NumberOfLinenumbers;            <span class="comment">// number of line numbers</span>
<a name="l00176"></a>00176         uint32   CheckSum;                       <span class="comment">// checksum for communal</span>
<a name="l00177"></a>00177         SHORT   Number;                         <span class="comment">// section number to associate with</span>
<a name="l00178"></a>00178         uint8    Selection;                      <span class="comment">// communal selection type</span>
<a name="l00179"></a>00179 };
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="preprocessor">#ifndef _WINNT_</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>
<a name="l00183"></a>00183 <span class="keyword">typedef</span> <span class="keyword">struct </span>_IMAGE_FILE_HEADER {
<a name="l00184"></a>00184     uint16    Machine;
<a name="l00185"></a>00185     uint16    NumberOfSections;
<a name="l00186"></a>00186     uint32   TimeDateStamp;
<a name="l00187"></a>00187     uint32   PointerToSymbolTable;
<a name="l00188"></a>00188     uint32   NumberOfSymbols;
<a name="l00189"></a>00189     uint16    SizeOfOptionalHeader;
<a name="l00190"></a>00190     uint16    Characteristics;
<a name="l00191"></a>00191 } IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="preprocessor">#define IMAGE_SIZEOF_FILE_HEADER             20</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span>
<a name="l00195"></a>00195 <span class="preprocessor">#define IMAGE_FILE_MACHINE_UNKNOWN           0</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_I386              0x014c  // Intel 386.</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_R3000             0x0162  // MIPS little-endian, 0x160 big-endian</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_R4000             0x0166  // MIPS little-endian</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_R10000            0x0168  // MIPS little-endian</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_WCEMIPSV2         0x0169  // MIPS little-endian WCE v2</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_ALPHA             0x0184  // Alpha_AXP</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_SH3               0x01a2  // SH3 little-endian</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_SH3DSP            0x01a3</span>
<a name="l00204"></a>00204 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_SH3E              0x01a4  // SH3E little-endian</span>
<a name="l00205"></a>00205 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_SH4               0x01a6  // SH4 little-endian</span>
<a name="l00206"></a>00206 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_SH5               0x01a8  // SH5</span>
<a name="l00207"></a>00207 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_ARM               0x01c0  // ARM Little-Endian</span>
<a name="l00208"></a>00208 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_THUMB             0x01c2</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_AM33              0x01d3</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_POWERPC           0x01F0  // IBM PowerPC Little-Endian</span>
<a name="l00211"></a>00211 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_POWERPCFP         0x01f1</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_IA64              0x0200  // Intel 64</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_MIPS16            0x0266  // MIPS</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_ALPHA64           0x0284  // ALPHA64</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_MIPSFPU           0x0366  // MIPS</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_MIPSFPU16         0x0466  // MIPS</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_AXP64             IMAGE_FILE_MACHINE_ALPHA64</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_TRICORE           0x0520  // Infineon</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_CEF               0x0CEF</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_EBC               0x0EBC  // EFI Byte Code</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_AMD64             0x8664  // AMD64 (K8)</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_M32R              0x9041  // M32R little-endian</span>
<a name="l00223"></a>00223 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_FILE_MACHINE_CEE               0xC0EE</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span>
<a name="l00225"></a>00225 <span class="preprocessor">#define IMAGE_SIZEOF_SHORT_NAME              8</span>
<a name="l00226"></a>00226 <span class="preprocessor"></span>
<a name="l00227"></a>00227 <span class="keyword">typedef</span> <span class="keyword">struct </span>_IMAGE_SECTION_HEADER {
<a name="l00228"></a>00228     uint8    Name[IMAGE_SIZEOF_SHORT_NAME];
<a name="l00229"></a>00229     <span class="keyword">union </span>{
<a name="l00230"></a>00230             uint32   PhysicalAddress;
<a name="l00231"></a>00231             uint32   VirtualSize;
<a name="l00232"></a>00232     } Misc;
<a name="l00233"></a>00233     uint32   VirtualAddress;
<a name="l00234"></a>00234     uint32   SizeOfRawData;
<a name="l00235"></a>00235     uint32   PointerToRawData;
<a name="l00236"></a>00236     uint32   PointerToRelocations;
<a name="l00237"></a>00237     uint32   PointerToLinenumbers;
<a name="l00238"></a>00238     uint16    NumberOfRelocations;
<a name="l00239"></a>00239     uint16    NumberOfLinenumbers;
<a name="l00240"></a>00240     uint32   Characteristics;
<a name="l00241"></a>00241 } IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="preprocessor">#define IMAGE_SIZEOF_SECTION_HEADER          40</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span>
<a name="l00245"></a>00245 <span class="comment">//</span>
<a name="l00246"></a>00246 <span class="comment">// Section characteristics.</span>
<a name="l00247"></a>00247 <span class="comment">//</span>
<a name="l00248"></a>00248 <span class="comment">//      IMAGE_SCN_TYPE_REG                   0x00000000  // Reserved.</span>
<a name="l00249"></a>00249 <span class="comment">//      IMAGE_SCN_TYPE_DSECT                 0x00000001  // Reserved.</span>
<a name="l00250"></a>00250 <span class="comment">//      IMAGE_SCN_TYPE_NOLOAD                0x00000002  // Reserved.</span>
<a name="l00251"></a>00251 <span class="comment">//      IMAGE_SCN_TYPE_GROUP                 0x00000004  // Reserved.</span>
<a name="l00252"></a>00252 <span class="preprocessor">#define IMAGE_SCN_TYPE_NO_PAD                0x00000008  // Reserved.</span>
<a name="l00253"></a>00253 <span class="preprocessor"></span><span class="comment">//      IMAGE_SCN_TYPE_COPY                  0x00000010  // Reserved.</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="preprocessor">#define IMAGE_SCN_CNT_CODE                   0x00000020  // Section contains code.</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_CNT_INITIALIZED_DATA       0x00000040  // Section contains initialized data.</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_CNT_UNINITIALIZED_DATA     0x00000080  // Section contains uninitialized data.</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>
<a name="l00259"></a>00259 <span class="preprocessor">#define IMAGE_SCN_LNK_OTHER                  0x00000100  // Reserved.</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_LNK_INFO                   0x00000200  // Section contains comments or some other type of information.</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span><span class="comment">//      IMAGE_SCN_TYPE_OVER                  0x00000400  // Reserved.</span>
<a name="l00262"></a>00262 <span class="preprocessor">#define IMAGE_SCN_LNK_REMOVE                 0x00000800  // Section contents will not become part of image.</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_LNK_COMDAT                 0x00001000  // Section contents comdat.</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span><span class="comment">//                                           0x00002000  // Reserved.</span>
<a name="l00265"></a>00265 <span class="comment">//      IMAGE_SCN_MEM_PROTECTED - Obsolete   0x00004000</span>
<a name="l00266"></a>00266 <span class="preprocessor">#define IMAGE_SCN_NO_DEFER_SPEC_EXC          0x00004000  // Reset speculative exceptions handling bits in the TLB entries for this section.</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_GPREL                      0x00008000  // Section content can be accessed relative to GP</span>
<a name="l00268"></a>00268 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_FARDATA                0x00008000</span>
<a name="l00269"></a>00269 <span class="preprocessor"></span><span class="comment">//      IMAGE_SCN_MEM_SYSHEAP  - Obsolete    0x00010000</span>
<a name="l00270"></a>00270 <span class="preprocessor">#define IMAGE_SCN_MEM_PURGEABLE              0x00020000</span>
<a name="l00271"></a>00271 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_16BIT                  0x00020000</span>
<a name="l00272"></a>00272 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_LOCKED                 0x00040000</span>
<a name="l00273"></a>00273 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_PRELOAD                0x00080000</span>
<a name="l00274"></a>00274 <span class="preprocessor"></span>
<a name="l00275"></a>00275 <span class="preprocessor">#define IMAGE_SCN_ALIGN_1BYTES               0x00100000  //</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_2BYTES               0x00200000  //</span>
<a name="l00277"></a>00277 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_4BYTES               0x00300000  //</span>
<a name="l00278"></a>00278 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_8BYTES               0x00400000  //</span>
<a name="l00279"></a>00279 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_16BYTES              0x00500000  // Default alignment if no others are specified.</span>
<a name="l00280"></a>00280 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_32BYTES              0x00600000  //</span>
<a name="l00281"></a>00281 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_64BYTES              0x00700000  //</span>
<a name="l00282"></a>00282 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_128BYTES             0x00800000  //</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_256BYTES             0x00900000  //</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_512BYTES             0x00A00000  //</span>
<a name="l00285"></a>00285 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_1024BYTES            0x00B00000  //</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_2048BYTES            0x00C00000  //</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_4096BYTES            0x00D00000  //</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_ALIGN_8192BYTES            0x00E00000  //</span>
<a name="l00289"></a>00289 <span class="preprocessor"></span><span class="comment">// Unused                                    0x00F00000</span>
<a name="l00290"></a>00290 <span class="preprocessor">#define IMAGE_SCN_ALIGN_MASK                 0x00F00000</span>
<a name="l00291"></a>00291 <span class="preprocessor"></span>
<a name="l00292"></a>00292 <span class="preprocessor">#define IMAGE_SCN_LNK_NRELOC_OVFL            0x01000000  // Section contains extended relocations.</span>
<a name="l00293"></a>00293 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_DISCARDABLE            0x02000000  // Section can be discarded.</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_NOT_CACHED             0x04000000  // Section is not cachable.</span>
<a name="l00295"></a>00295 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_NOT_PAGED              0x08000000  // Section is not pageable.</span>
<a name="l00296"></a>00296 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_SHARED                 0x10000000  // Section is shareable.</span>
<a name="l00297"></a>00297 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_EXECUTE                0x20000000  // Section is executable.</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_READ                   0x40000000  // Section is readable.</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SCN_MEM_WRITE                  0x80000000  // Section is writeable.</span>
<a name="l00300"></a>00300 <span class="preprocessor"></span>
<a name="l00301"></a>00301 <span class="keyword">typedef</span> <span class="keyword">struct </span><span class="comment">/*__declspec(align(2))*/</span> _IMAGE_SYMBOL {
<a name="l00302"></a>00302     <span class="keyword">union </span>{
<a name="l00303"></a>00303         uint8    ShortName[8];
<a name="l00304"></a>00304         <span class="keyword">struct </span>{
<a name="l00305"></a>00305             uint32   Short;     <span class="comment">// if 0, use LongName</span>
<a name="l00306"></a>00306             uint32   Long;      <span class="comment">// offset into string table</span>
<a name="l00307"></a>00307         } Name;
<a name="l00308"></a>00308         uint32   LongName[2];    <span class="comment">// PBYTE [2]</span>
<a name="l00309"></a>00309     } N;
<a name="l00310"></a>00310     uint32   Value;
<a name="l00311"></a>00311     <span class="keywordtype">short</span>   SectionNumber;
<a name="l00312"></a>00312     uint16    Type;
<a name="l00313"></a>00313     uint8    StorageClass;
<a name="l00314"></a>00314     uint8   NumberOfAuxSymbols;
<a name="l00315"></a>00315 } IMAGE_SYMBOL;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 <span class="preprocessor">#define IMAGE_SIZEOF_SYMBOL                  18</span>
<a name="l00318"></a>00318 <span class="preprocessor"></span>
<a name="l00319"></a>00319 <span class="comment">// Line number format.</span>
<a name="l00320"></a>00320 <span class="comment">//</span>
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="keyword">typedef</span> <span class="keyword">struct </span><span class="comment">/*__declspec(align(2))*/</span> _IMAGE_LINENUMBER {
<a name="l00323"></a>00323     <span class="keyword">union </span>{
<a name="l00324"></a>00324         uint32   SymbolTableIndex;               <span class="comment">// Symbol table index of function name if Linenumber is 0.</span>
<a name="l00325"></a>00325         uint32   VirtualAddress;                 <span class="comment">// Virtual address of line number.</span>
<a name="l00326"></a>00326     } Type;
<a name="l00327"></a>00327     uint16    Linenumber;                         <span class="comment">// Line number.</span>
<a name="l00328"></a>00328 } IMAGE_LINENUMBER;
<a name="l00329"></a>00329 <span class="keyword">typedef</span> IMAGE_LINENUMBER <span class="comment">/*UNALIGNED*/</span> *PIMAGE_LINENUMBER;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 <span class="preprocessor">#define IMAGE_SIZEOF_LINENUMBER              6</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span>
<a name="l00333"></a>00333 <span class="comment">//</span>
<a name="l00334"></a>00334 <span class="comment">// Storage classes.</span>
<a name="l00335"></a>00335 <span class="comment">//</span>
<a name="l00336"></a>00336 <span class="preprocessor">#define IMAGE_SYM_CLASS_END_OF_FUNCTION     (BYTE )-1</span>
<a name="l00337"></a>00337 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_NULL                0x0000</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_AUTOMATIC           0x0001</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_EXTERNAL            0x0002</span>
<a name="l00340"></a>00340 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_STATIC              0x0003</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_REGISTER            0x0004</span>
<a name="l00342"></a>00342 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_EXTERNAL_DEF        0x0005</span>
<a name="l00343"></a>00343 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_LABEL               0x0006</span>
<a name="l00344"></a>00344 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_UNDEFINED_LABEL     0x0007</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_MEMBER_OF_STRUCT    0x0008</span>
<a name="l00346"></a>00346 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_ARGUMENT            0x0009</span>
<a name="l00347"></a>00347 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_STRUCT_TAG          0x000A</span>
<a name="l00348"></a>00348 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_MEMBER_OF_UNION     0x000B</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_UNION_TAG           0x000C</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_TYPE_DEFINITION     0x000D</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_UNDEFINED_STATIC    0x000E</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_ENUM_TAG            0x000F</span>
<a name="l00353"></a>00353 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_MEMBER_OF_ENUM      0x0010</span>
<a name="l00354"></a>00354 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_REGISTER_PARAM      0x0011</span>
<a name="l00355"></a>00355 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_BIT_FIELD           0x0012</span>
<a name="l00356"></a>00356 <span class="preprocessor"></span>
<a name="l00357"></a>00357 <span class="preprocessor">#define IMAGE_SYM_CLASS_FAR_EXTERNAL        0x0044  //</span>
<a name="l00358"></a>00358 <span class="preprocessor"></span>
<a name="l00359"></a>00359 <span class="preprocessor">#define IMAGE_SYM_CLASS_BLOCK               0x0064</span>
<a name="l00360"></a>00360 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_FUNCTION            0x0065</span>
<a name="l00361"></a>00361 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_END_OF_STRUCT       0x0066</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_FILE                0x0067</span>
<a name="l00363"></a>00363 <span class="preprocessor"></span><span class="comment">// new</span>
<a name="l00364"></a>00364 <span class="preprocessor">#define IMAGE_SYM_CLASS_SECTION             0x0068</span>
<a name="l00365"></a>00365 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_SYM_CLASS_WEAK_EXTERNAL       0x0069</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span>
<a name="l00367"></a>00367 <span class="preprocessor">#define IMAGE_SYM_CLASS_CLR_TOKEN           0x006B</span>
<a name="l00368"></a>00368 <span class="preprocessor"></span>
<a name="l00369"></a>00369 <span class="comment">//</span>
<a name="l00370"></a>00370 <span class="comment">// Relocation format.</span>
<a name="l00371"></a>00371 <span class="comment">//</span>
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 <span class="keyword">typedef</span> <span class="keyword">struct </span><span class="comment">/*__declspec(align(2))*/</span> _IMAGE_RELOCATION {
<a name="l00374"></a>00374     <span class="keyword">union </span>{
<a name="l00375"></a>00375         uint32   VirtualAddress;
<a name="l00376"></a>00376         uint32   RelocCount;             <span class="comment">// Set to the real count when IMAGE_SCN_LNK_NRELOC_OVFL is set</span>
<a name="l00377"></a>00377     };
<a name="l00378"></a>00378     uint32   SymbolTableIndex;
<a name="l00379"></a>00379     uint16    Type;
<a name="l00380"></a>00380 } IMAGE_RELOCATION;
<a name="l00381"></a>00381 <span class="keyword">typedef</span> IMAGE_RELOCATION <span class="comment">/*UNALIGNED*/</span> *PIMAGE_RELOCATION;
<a name="l00382"></a>00382 
<a name="l00383"></a>00383 <span class="preprocessor">#define IMAGE_SIZEOF_RELOCATION         10</span>
<a name="l00384"></a>00384 <span class="preprocessor"></span>
<a name="l00385"></a>00385 <span class="comment">//</span>
<a name="l00386"></a>00386 <span class="comment">// I386 relocation types.</span>
<a name="l00387"></a>00387 <span class="comment">//</span>
<a name="l00388"></a>00388 <span class="preprocessor">#define IMAGE_REL_I386_ABSOLUTE         0x0000  // Reference is absolute, no relocation is necessary</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_DIR16            0x0001  // Direct 16-bit reference to the symbols virtual address</span>
<a name="l00390"></a>00390 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_REL16            0x0002  // PC-relative 16-bit reference to the symbols virtual address</span>
<a name="l00391"></a>00391 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_DIR32            0x0006  // Direct 32-bit reference to the symbols virtual address</span>
<a name="l00392"></a>00392 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_DIR32NB          0x0007  // Direct 32-bit reference to the symbols virtual address, base not included</span>
<a name="l00393"></a>00393 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_SEG12            0x0009  // Direct 16-bit reference to the segment-selector bits of a 32-bit virtual address</span>
<a name="l00394"></a>00394 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_SECTION          0x000A</span>
<a name="l00395"></a>00395 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_SECREL           0x000B</span>
<a name="l00396"></a>00396 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_TOKEN            0x000C  // clr token</span>
<a name="l00397"></a>00397 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_SECREL7          0x000D  // 7 bit offset from base of section containing target</span>
<a name="l00398"></a>00398 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_I386_REL32            0x0014  // PC-relative 32-bit reference to the symbols virtual address</span>
<a name="l00399"></a>00399 <span class="preprocessor"></span>
<a name="l00400"></a>00400 <span class="comment">//</span>
<a name="l00401"></a>00401 <span class="comment">// MIPS relocation types.</span>
<a name="l00402"></a>00402 <span class="comment">//</span>
<a name="l00403"></a>00403 <span class="preprocessor">#define IMAGE_REL_MIPS_ABSOLUTE         0x0000  // Reference is absolute, no relocation is necessary</span>
<a name="l00404"></a>00404 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_REFHALF          0x0001</span>
<a name="l00405"></a>00405 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_REFWORD          0x0002</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_JMPADDR          0x0003</span>
<a name="l00407"></a>00407 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_REFHI            0x0004</span>
<a name="l00408"></a>00408 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_REFLO            0x0005</span>
<a name="l00409"></a>00409 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_GPREL            0x0006</span>
<a name="l00410"></a>00410 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_LITERAL          0x0007</span>
<a name="l00411"></a>00411 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_SECTION          0x000A</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_SECREL           0x000B</span>
<a name="l00413"></a>00413 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_SECRELLO         0x000C  // Low 16-bit section relative referemce (used for &gt;32k TLS)</span>
<a name="l00414"></a>00414 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_SECRELHI         0x000D  // High 16-bit section relative reference (used for &gt;32k TLS)</span>
<a name="l00415"></a>00415 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_TOKEN            0x000E  // clr token</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_JMPADDR16        0x0010</span>
<a name="l00417"></a>00417 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_REFWORDNB        0x0022</span>
<a name="l00418"></a>00418 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_MIPS_PAIR             0x0025</span>
<a name="l00419"></a>00419 <span class="preprocessor"></span>
<a name="l00420"></a>00420 <span class="comment">//</span>
<a name="l00421"></a>00421 <span class="comment">// Alpha Relocation types.</span>
<a name="l00422"></a>00422 <span class="comment">//</span>
<a name="l00423"></a>00423 <span class="preprocessor">#define IMAGE_REL_ALPHA_ABSOLUTE        0x0000</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFLONG         0x0001</span>
<a name="l00425"></a>00425 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFQUAD         0x0002</span>
<a name="l00426"></a>00426 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_GPREL32         0x0003</span>
<a name="l00427"></a>00427 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_LITERAL         0x0004</span>
<a name="l00428"></a>00428 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_LITUSE          0x0005</span>
<a name="l00429"></a>00429 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_GPDISP          0x0006</span>
<a name="l00430"></a>00430 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_BRADDR          0x0007</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_HINT            0x0008</span>
<a name="l00432"></a>00432 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_INLINE_REFLONG  0x0009</span>
<a name="l00433"></a>00433 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFHI           0x000A</span>
<a name="l00434"></a>00434 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFLO           0x000B</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_PAIR            0x000C</span>
<a name="l00436"></a>00436 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_MATCH           0x000D</span>
<a name="l00437"></a>00437 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_SECTION         0x000E</span>
<a name="l00438"></a>00438 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_SECREL          0x000F</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFLONGNB       0x0010</span>
<a name="l00440"></a>00440 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_SECRELLO        0x0011  // Low 16-bit section relative reference</span>
<a name="l00441"></a>00441 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_SECRELHI        0x0012  // High 16-bit section relative reference</span>
<a name="l00442"></a>00442 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFQ3           0x0013  // High 16 bits of 48 bit reference</span>
<a name="l00443"></a>00443 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFQ2           0x0014  // Middle 16 bits of 48 bit reference</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_REFQ1           0x0015  // Low 16 bits of 48 bit reference</span>
<a name="l00445"></a>00445 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_GPRELLO         0x0016  // Low 16-bit GP relative reference</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ALPHA_GPRELHI         0x0017  // High 16-bit GP relative reference</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>
<a name="l00448"></a>00448 <span class="comment">//</span>
<a name="l00449"></a>00449 <span class="comment">// IBM PowerPC relocation types.</span>
<a name="l00450"></a>00450 <span class="comment">//</span>
<a name="l00451"></a>00451 <span class="preprocessor">#define IMAGE_REL_PPC_ABSOLUTE          0x0000  // NOP</span>
<a name="l00452"></a>00452 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_ADDR64            0x0001  // 64-bit address</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_ADDR32            0x0002  // 32-bit address</span>
<a name="l00454"></a>00454 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_ADDR24            0x0003  // 26-bit address, shifted left 2 (branch absolute)</span>
<a name="l00455"></a>00455 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_ADDR16            0x0004  // 16-bit address</span>
<a name="l00456"></a>00456 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_ADDR14            0x0005  // 16-bit address, shifted left 2 (load doubleword)</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_REL24             0x0006  // 26-bit PC-relative offset, shifted left 2 (branch relative)</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_REL14             0x0007  // 16-bit PC-relative offset, shifted left 2 (br cond relative)</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_TOCREL16          0x0008  // 16-bit offset from TOC base</span>
<a name="l00460"></a>00460 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_TOCREL14          0x0009  // 16-bit offset from TOC base, shifted left 2 (load doubleword)</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span>
<a name="l00462"></a>00462 <span class="preprocessor">#define IMAGE_REL_PPC_ADDR32NB          0x000A  // 32-bit addr w/o image base</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_SECREL            0x000B  // va of containing section (as in an image sectionhdr)</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_SECTION           0x000C  // sectionheader number</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_IFGLUE            0x000D  // substitute TOC restore instruction iff symbol is glue code</span>
<a name="l00466"></a>00466 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_IMGLUE            0x000E  // symbol is glue code; virtual address is TOC restore instruction</span>
<a name="l00467"></a>00467 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_SECREL16          0x000F  // va of containing section (limited to 16 bits)</span>
<a name="l00468"></a>00468 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_REFHI             0x0010</span>
<a name="l00469"></a>00469 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_REFLO             0x0011</span>
<a name="l00470"></a>00470 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_PAIR              0x0012</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_SECRELLO          0x0013  // Low 16-bit section relative reference (used for &gt;32k TLS)</span>
<a name="l00472"></a>00472 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_SECRELHI          0x0014  // High 16-bit section relative reference (used for &gt;32k TLS)</span>
<a name="l00473"></a>00473 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_GPREL             0x0015</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_TOKEN             0x0016  // clr token</span>
<a name="l00475"></a>00475 <span class="preprocessor"></span>
<a name="l00476"></a>00476 <span class="preprocessor">#define IMAGE_REL_PPC_TYPEMASK          0x00FF  // mask to isolate above values in IMAGE_RELOCATION.Type</span>
<a name="l00477"></a>00477 <span class="preprocessor"></span>
<a name="l00478"></a>00478 <span class="comment">// Flag bits in IMAGE_RELOCATION.TYPE</span>
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="preprocessor">#define IMAGE_REL_PPC_NEG               0x0100  // subtract reloc value rather than adding it</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_BRTAKEN           0x0200  // fix branch prediction bit to predict branch taken</span>
<a name="l00482"></a>00482 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_BRNTAKEN          0x0400  // fix branch prediction bit to predict branch not taken</span>
<a name="l00483"></a>00483 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_PPC_TOCDEFN           0x0800  // toc slot defined in file (or, data in toc)</span>
<a name="l00484"></a>00484 <span class="preprocessor"></span>
<a name="l00485"></a>00485 <span class="comment">//</span>
<a name="l00486"></a>00486 <span class="comment">// Hitachi SH3 relocation types.</span>
<a name="l00487"></a>00487 <span class="comment">//</span>
<a name="l00488"></a>00488 <span class="preprocessor">#define IMAGE_REL_SH3_ABSOLUTE          0x0000  // No relocation</span>
<a name="l00489"></a>00489 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT16          0x0001  // 16 bit direct</span>
<a name="l00490"></a>00490 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT32          0x0002  // 32 bit direct</span>
<a name="l00491"></a>00491 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT8           0x0003  // 8 bit direct, -128..255</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT8_WORD      0x0004  // 8 bit direct .W (0 ext.)</span>
<a name="l00493"></a>00493 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT8_LONG      0x0005  // 8 bit direct .L (0 ext.)</span>
<a name="l00494"></a>00494 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT4           0x0006  // 4 bit direct (0 ext.)</span>
<a name="l00495"></a>00495 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT4_WORD      0x0007  // 4 bit direct .W (0 ext.)</span>
<a name="l00496"></a>00496 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT4_LONG      0x0008  // 4 bit direct .L (0 ext.)</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_PCREL8_WORD       0x0009  // 8 bit PC relative .W</span>
<a name="l00498"></a>00498 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_PCREL8_LONG       0x000A  // 8 bit PC relative .L</span>
<a name="l00499"></a>00499 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_PCREL12_WORD      0x000B  // 12 LSB PC relative .W</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_STARTOF_SECTION   0x000C  // Start of EXE section</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_SIZEOF_SECTION    0x000D  // Size of EXE section</span>
<a name="l00502"></a>00502 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_SECTION           0x000E  // Section table index</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_SECREL            0x000F  // Offset within section</span>
<a name="l00504"></a>00504 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_DIRECT32_NB       0x0010  // 32 bit direct not based</span>
<a name="l00505"></a>00505 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_GPREL4_LONG       0x0011  // GP-relative addressing</span>
<a name="l00506"></a>00506 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_SH3_TOKEN             0x0012  // clr token</span>
<a name="l00507"></a>00507 <span class="preprocessor"></span>
<a name="l00508"></a>00508 <span class="preprocessor">#define IMAGE_REL_ARM_ABSOLUTE          0x0000  // No relocation required</span>
<a name="l00509"></a>00509 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_ADDR32            0x0001  // 32 bit address</span>
<a name="l00510"></a>00510 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_ADDR32NB          0x0002  // 32 bit address w/o image base</span>
<a name="l00511"></a>00511 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_BRANCH24          0x0003  // 24 bit offset &lt;&lt; 2 &amp; sign ext.</span>
<a name="l00512"></a>00512 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_BRANCH11          0x0004  // Thumb: 2 11 bit offsets</span>
<a name="l00513"></a>00513 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_TOKEN             0x0005  // clr token</span>
<a name="l00514"></a>00514 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_GPREL12           0x0006  // GP-relative addressing (ARM)</span>
<a name="l00515"></a>00515 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_GPREL7            0x0007  // GP-relative addressing (Thumb)</span>
<a name="l00516"></a>00516 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_BLX24             0x0008</span>
<a name="l00517"></a>00517 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_BLX11             0x0009</span>
<a name="l00518"></a>00518 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_SECTION           0x000E  // Section table index</span>
<a name="l00519"></a>00519 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_ARM_SECREL            0x000F  // Offset within section</span>
<a name="l00520"></a>00520 <span class="preprocessor"></span>
<a name="l00521"></a>00521 <span class="preprocessor">#define IMAGE_REL_AM_ABSOLUTE           0x0000</span>
<a name="l00522"></a>00522 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_ADDR32             0x0001</span>
<a name="l00523"></a>00523 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_ADDR32NB           0x0002</span>
<a name="l00524"></a>00524 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_CALL32             0x0003</span>
<a name="l00525"></a>00525 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_FUNCINFO           0x0004</span>
<a name="l00526"></a>00526 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_REL32_1            0x0005</span>
<a name="l00527"></a>00527 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_REL32_2            0x0006</span>
<a name="l00528"></a>00528 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_SECREL             0x0007</span>
<a name="l00529"></a>00529 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_SECTION            0x0008</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AM_TOKEN              0x0009</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span>
<a name="l00532"></a>00532 <span class="comment">//</span>
<a name="l00533"></a>00533 <span class="comment">// X86-64 relocations</span>
<a name="l00534"></a>00534 <span class="comment">//</span>
<a name="l00535"></a>00535 <span class="preprocessor">#define IMAGE_REL_AMD64_ABSOLUTE        0x0000  // Reference is absolute, no relocation is necessary</span>
<a name="l00536"></a>00536 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_ADDR64          0x0001  // 64-bit address (VA).</span>
<a name="l00537"></a>00537 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_ADDR32          0x0002  // 32-bit address (VA).</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_ADDR32NB        0x0003  // 32-bit address w/o image base (RVA).</span>
<a name="l00539"></a>00539 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_REL32           0x0004  // 32-bit relative address from byte following reloc</span>
<a name="l00540"></a>00540 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_REL32_1         0x0005  // 32-bit relative address from byte distance 1 from reloc</span>
<a name="l00541"></a>00541 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_REL32_2         0x0006  // 32-bit relative address from byte distance 2 from reloc</span>
<a name="l00542"></a>00542 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_REL32_3         0x0007  // 32-bit relative address from byte distance 3 from reloc</span>
<a name="l00543"></a>00543 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_REL32_4         0x0008  // 32-bit relative address from byte distance 4 from reloc</span>
<a name="l00544"></a>00544 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_REL32_5         0x0009  // 32-bit relative address from byte distance 5 from reloc</span>
<a name="l00545"></a>00545 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_SECTION         0x000A  // Section index</span>
<a name="l00546"></a>00546 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_SECREL          0x000B  // 32 bit offset from base of section containing target</span>
<a name="l00547"></a>00547 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_SECREL7         0x000C  // 7 bit unsigned offset from base of section containing target</span>
<a name="l00548"></a>00548 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_TOKEN           0x000D  // 32 bit metadata token</span>
<a name="l00549"></a>00549 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_SREL32          0x000E  // 32 bit signed span-dependent value emitted into object</span>
<a name="l00550"></a>00550 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_PAIR            0x000F</span>
<a name="l00551"></a>00551 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_AMD64_SSPAN32         0x0010  // 32 bit signed span-dependent value applied at link time</span>
<a name="l00552"></a>00552 <span class="preprocessor"></span>
<a name="l00553"></a>00553 <span class="comment">//</span>
<a name="l00554"></a>00554 <span class="comment">// IA64 relocation types.</span>
<a name="l00555"></a>00555 <span class="comment">//</span>
<a name="l00556"></a>00556 <span class="preprocessor">#define IMAGE_REL_IA64_ABSOLUTE         0x0000</span>
<a name="l00557"></a>00557 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_IMM14            0x0001</span>
<a name="l00558"></a>00558 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_IMM22            0x0002</span>
<a name="l00559"></a>00559 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_IMM64            0x0003</span>
<a name="l00560"></a>00560 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_DIR32            0x0004</span>
<a name="l00561"></a>00561 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_DIR64            0x0005</span>
<a name="l00562"></a>00562 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL21B         0x0006</span>
<a name="l00563"></a>00563 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL21M         0x0007</span>
<a name="l00564"></a>00564 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL21F         0x0008</span>
<a name="l00565"></a>00565 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_GPREL22          0x0009</span>
<a name="l00566"></a>00566 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_LTOFF22          0x000A</span>
<a name="l00567"></a>00567 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SECTION          0x000B</span>
<a name="l00568"></a>00568 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SECREL22         0x000C</span>
<a name="l00569"></a>00569 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SECREL64I        0x000D</span>
<a name="l00570"></a>00570 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SECREL32         0x000E</span>
<a name="l00571"></a>00571 <span class="preprocessor"></span><span class="comment">// </span>
<a name="l00572"></a>00572 <span class="preprocessor">#define IMAGE_REL_IA64_DIR32NB          0x0010</span>
<a name="l00573"></a>00573 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SREL14           0x0011</span>
<a name="l00574"></a>00574 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SREL22           0x0012</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_SREL32           0x0013</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_UREL32           0x0014</span>
<a name="l00577"></a>00577 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL60X         0x0015  // This is always a BRL and never converted</span>
<a name="l00578"></a>00578 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL60B         0x0016  // If possible, convert to MBB bundle with NOP.B in slot 1</span>
<a name="l00579"></a>00579 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL60F         0x0017  // If possible, convert to MFB bundle with NOP.F in slot 1</span>
<a name="l00580"></a>00580 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL60I         0x0018  // If possible, convert to MIB bundle with NOP.I in slot 1</span>
<a name="l00581"></a>00581 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_PCREL60M         0x0019  // If possible, convert to MMB bundle with NOP.M in slot 1</span>
<a name="l00582"></a>00582 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_IMMGPREL64       0x001A</span>
<a name="l00583"></a>00583 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_TOKEN            0x001B  // clr token</span>
<a name="l00584"></a>00584 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_GPREL32          0x001C</span>
<a name="l00585"></a>00585 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_IA64_ADDEND           0x001F</span>
<a name="l00586"></a>00586 <span class="preprocessor"></span>
<a name="l00587"></a>00587 <span class="comment">//</span>
<a name="l00588"></a>00588 <span class="comment">// CEF relocation types.</span>
<a name="l00589"></a>00589 <span class="comment">//</span>
<a name="l00590"></a>00590 <span class="preprocessor">#define IMAGE_REL_CEF_ABSOLUTE          0x0000  // Reference is absolute, no relocation is necessary</span>
<a name="l00591"></a>00591 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEF_ADDR32            0x0001  // 32-bit address (VA).</span>
<a name="l00592"></a>00592 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEF_ADDR64            0x0002  // 64-bit address (VA).</span>
<a name="l00593"></a>00593 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEF_ADDR32NB          0x0003  // 32-bit address w/o image base (RVA).</span>
<a name="l00594"></a>00594 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEF_SECTION           0x0004  // Section index</span>
<a name="l00595"></a>00595 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEF_SECREL            0x0005  // 32 bit offset from base of section containing target</span>
<a name="l00596"></a>00596 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEF_TOKEN             0x0006  // 32 bit metadata token</span>
<a name="l00597"></a>00597 <span class="preprocessor"></span>
<a name="l00598"></a>00598 <span class="comment">//</span>
<a name="l00599"></a>00599 <span class="comment">// clr relocation types.</span>
<a name="l00600"></a>00600 <span class="comment">//</span>
<a name="l00601"></a>00601 <span class="preprocessor">#define IMAGE_REL_CEE_ABSOLUTE          0x0000  // Reference is absolute, no relocation is necessary</span>
<a name="l00602"></a>00602 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEE_ADDR32            0x0001  // 32-bit address (VA).</span>
<a name="l00603"></a>00603 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEE_ADDR64            0x0002  // 64-bit address (VA).</span>
<a name="l00604"></a>00604 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEE_ADDR32NB          0x0003  // 32-bit address w/o image base (RVA).</span>
<a name="l00605"></a>00605 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEE_SECTION           0x0004  // Section index</span>
<a name="l00606"></a>00606 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEE_SECREL            0x0005  // 32 bit offset from base of section containing target</span>
<a name="l00607"></a>00607 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_CEE_TOKEN             0x0006  // 32 bit metadata token</span>
<a name="l00608"></a>00608 <span class="preprocessor"></span>
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 <span class="preprocessor">#define IMAGE_REL_M32R_ABSOLUTE       0x0000   // No relocation required</span>
<a name="l00611"></a>00611 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_ADDR32         0x0001   // 32 bit address</span>
<a name="l00612"></a>00612 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_ADDR32NB       0x0002   // 32 bit address w/o image base</span>
<a name="l00613"></a>00613 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_ADDR24         0x0003   // 24 bit address</span>
<a name="l00614"></a>00614 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_GPREL16        0x0004   // GP relative addressing</span>
<a name="l00615"></a>00615 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_PCREL24        0x0005   // 24 bit offset &lt;&lt; 2 &amp; sign ext.</span>
<a name="l00616"></a>00616 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_PCREL16        0x0006   // 16 bit offset &lt;&lt; 2 &amp; sign ext.</span>
<a name="l00617"></a>00617 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_PCREL8         0x0007   // 8 bit offset &lt;&lt; 2 &amp; sign ext.</span>
<a name="l00618"></a>00618 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_REFHALF        0x0008   // 16 MSBs</span>
<a name="l00619"></a>00619 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_REFHI          0x0009   // 16 MSBs; adj for LSB sign ext.</span>
<a name="l00620"></a>00620 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_REFLO          0x000A   // 16 LSBs</span>
<a name="l00621"></a>00621 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_PAIR           0x000B   // Link HI and LO</span>
<a name="l00622"></a>00622 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_SECTION        0x000C   // Section table index</span>
<a name="l00623"></a>00623 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_SECREL32       0x000D   // 32 bit section relative reference</span>
<a name="l00624"></a>00624 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_REL_M32R_TOKEN          0x000E   // clr token</span>
<a name="l00625"></a>00625 <span class="preprocessor"></span>
<a name="l00626"></a>00626 <span class="keyword">typedef</span> <span class="keyword">struct </span>_IMAGE_DATA_DIRECTORY {
<a name="l00627"></a>00627     uint32   VirtualAddress;
<a name="l00628"></a>00628     uint32   Size;
<a name="l00629"></a>00629 } IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 <span class="preprocessor">#endif</span>
<a name="l00632"></a>00632 <span class="preprocessor"></span>
<a name="l00633"></a>00633 <span class="preprocessor">#pragma pack(pop)</span>
<a name="l00634"></a>00634 <span class="preprocessor"></span>
<a name="l00635"></a>00635 <span class="keyword">class </span>LFCEXT COFFParser : <span class="keyword">public</span> ObjectFileParser
<a name="l00636"></a>00636 {
<a name="l00637"></a>00637 <span class="keyword">public</span>:
<a name="l00638"></a>00638         CTOR COFFParser();
<a name="l00639"></a>00639         ~COFFParser();
<a name="l00640"></a>00640 
<a name="l00641"></a>00641         <span class="keyword">struct </span>SYMBOL
<a name="l00642"></a>00642         {
<a name="l00643"></a>00643                 IMAGE_SYMBOL* is;
<a name="l00644"></a>00644                 <span class="keywordtype">char</span>* name;
<a name="l00645"></a>00645         };
<a name="l00646"></a>00646 
<a name="l00647"></a>00647         <span class="keyword">virtual</span> <span class="keywordtype">long</span> GetFormat();
<a name="l00648"></a>00648         <span class="keyword">virtual</span> <span class="keywordtype">long</span> GetCPU();
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         <span class="keyword">virtual</span> uint GetNumberOfSymbols();
<a name="l00651"></a>00651 
<a name="l00652"></a>00652         <span class="keyword">virtual</span> uint GetNumberOfSections();
<a name="l00653"></a>00653         <span class="keyword">virtual</span> <span class="keywordtype">int</span> GetSection(uint n, SECTION* pSection);
<a name="l00654"></a>00654         <span class="keyword">virtual</span> uint8* GetData(uint nSection);
<a name="l00655"></a>00655         <span class="keyword">virtual</span> ULONG GetDataSize(uint nSection);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657         <span class="keyword">virtual</span> <span class="keywordtype">long</span> Read(IO::Stream* stream);
<a name="l00658"></a>00658 
<a name="l00659"></a>00659         <span class="keyword">virtual</span> String GetErrorMsg(<span class="keywordtype">long</span> nError);
<a name="l00660"></a>00660 
<a name="l00661"></a>00661         DebugInfo* GetDebugInfo(System::Scope* pGlobalScope);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663         ULONG RVA2FilePos(ULONG rva);
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 <span class="keyword">public</span>:
<a name="l00666"></a>00666 
<a name="l00667"></a>00667         ULONG m_size;
<a name="l00668"></a>00668         IMAGE_FILE_HEADER* m_header;
<a name="l00669"></a>00669         IMAGE_SECTION_HEADER* m_SectionHeader;
<a name="l00670"></a>00670         OptionalStandardHeader* m_optionalStandardHeader;
<a name="l00671"></a>00671         WindowsHeader* m_windowsHeader;
<a name="l00672"></a>00672         uint32  BaseOfData;<span class="comment">//   Address, relative to image base, of beginning of data section, when loaded into memory.</span>
<a name="l00673"></a>00673         IMAGE_DATA_DIRECTORY* m_DataDirectory;
<a name="l00674"></a>00674 <span class="comment">//      IMAGE_SYMBOL* pSymbolTable;</span>
<a name="l00675"></a>00675         <span class="keywordtype">int</span> m_NumberOfNameSymbols;
<a name="l00676"></a>00676         SYMBOL* m_NameSymbols;
<a name="l00677"></a>00677         uint32 m_StringTableSize;
<a name="l00678"></a>00678         <span class="keywordtype">char</span>* m_pStringData;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680         uint8* m_fbuf;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         ULONG m_loadAddress;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <span class="keyword">protected</span>:
<a name="l00685"></a>00685 
<a name="l00686"></a>00686         <span class="keywordtype">int</span> ImageNTSignature();
<a name="l00687"></a>00687         <span class="keywordtype">int</span> ParseCOFF();
<a name="l00688"></a>00688 
<a name="l00689"></a>00689         uint8* m_p;
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 };
<a name="l00692"></a>00692 
<a name="l00693"></a>00693 }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="preprocessor">#endif // __COFF_H__</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 17 2011 00:57:07 for FirstProject2 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FirstProject2: include/GUI/GUI.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FirstProject2
   &#160;<span id="projectnumber">12.12.2011</span>
   </div>
   <div id="projectbrief">Framework</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">include/GUI/GUI.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00006"></a>00006 <span class="preprocessor">#ifndef GUI_h</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span><span class="preprocessor">#define GUI_h</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span>
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef GUIEXT</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define GUIEXT DECLSPEC_DLLIMPORT</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span>
<a name="l00013"></a>00013 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#import &quot;LFC/LFC.h&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#else</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span><span class="preprocessor">#include &quot;LFC/LFC.h&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#endif</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a>00019 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#import &quot;Networking/Networking.h&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#else</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#include &quot;Networking/Networking.h&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#endif</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#import &quot;Graphics/Graphics.h&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#else</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#include &quot;Graphics/Graphics.h&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#endif</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#import &quot;DShowPlayer/DShowPlayer.h&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#else</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#include &quot;DShowPlayer/DShowPlayer.h&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#endif</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#import &quot;CSS/CSS.h&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#else</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">#include &quot;CSS/CSS.h&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#endif</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a>00043 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span><span class="preprocessor">#import &quot;XML/XML.h&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#else</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="preprocessor">#include &quot;XML/XML.h&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#endif</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#import &quot;Expressive/Expressive.h&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#else</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">#include &quot;Expressive/Expressive.h&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#endif</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>
<a name="l00055"></a>00055 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="keyword">struct </span>IGraphBuilder;
<a name="l00057"></a>00057 <span class="keyword">struct </span>ICaptureGraphBuilder2;
<a name="l00058"></a>00058 <span class="preprocessor">#else</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor">#include &lt;dshow.h&gt;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#undef GetWindowStyle</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#undef GetWindowExStyle</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00064"></a>00064 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#include &lt;UIAutomationCore.h&gt;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &lt;UIAutomationClient.h&gt;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &lt;UIAutomationCoreApi.h&gt;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#endif</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span>
<a name="l00070"></a>00070 <span class="preprocessor">#undef ChooseColor</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a>00072 <span class="keyword">struct </span>IDataObject;
<a name="l00073"></a>00073 <span class="keyword">typedef</span> IDataObject __IDataObject;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="keyword">namespace </span>System
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="keyword">class </span>DdeInstance
<a name="l00079"></a>00079 {
<a name="l00080"></a>00080 <span class="keyword">public</span>:
<a name="l00081"></a>00081         CTOR DdeInstance() : m_id(0), m_lockCount(0)
<a name="l00082"></a>00082         {
<a name="l00083"></a>00083         }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         ~DdeInstance()
<a name="l00086"></a>00086         {
<a name="l00087"></a>00087                 <span class="keywordflow">if</span> (m_lockCount != 0)
<a name="l00088"></a>00088                 {
<a name="l00089"></a>00089                         ASSERT(0);
<a name="l00090"></a>00090                 }
<a name="l00091"></a>00091 
<a name="l00092"></a>00092                 <span class="keywordflow">if</span> (m_id)
<a name="l00093"></a>00093                 {
<a name="l00094"></a>00094                         DdeUninitialize(m_id);
<a name="l00095"></a>00095                         m_id = 0;
<a name="l00096"></a>00096                 }
<a name="l00097"></a>00097         }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>
<a name="l00101"></a>00101         UINT Initialize(PFNCALLBACK pfnCallback, DWORD afCmd)
<a name="l00102"></a>00102         {
<a name="l00103"></a>00103                 ASSERT(m_id == 0);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105                 UINT ddeError = DdeInitializeW(&amp;m_id,         <span class="comment">// receives instance identifier </span>
<a name="l00106"></a>00106                         pfnCallback, <span class="comment">// pointer to callback function </span>
<a name="l00107"></a>00107                         afCmd,
<a name="l00108"></a>00108                         0);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110                 <span class="keywordflow">return</span> ddeError;
<a name="l00111"></a>00111         }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113         UINT GetLastError()<span class="keyword"> const</span>
<a name="l00114"></a>00114 <span class="keyword">        </span>{
<a name="l00115"></a>00115                 <span class="keywordflow">return</span> DdeGetLastError(m_id);
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         HDDEDATA NameService(HSZ hsz1, UINT afCmd)
<a name="l00119"></a>00119         {
<a name="l00120"></a>00120                 <span class="keywordflow">return</span> DdeNameService(m_id, hsz1, 0L, afCmd);
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         HCONV Connect(HSZ hszService, HSZ hszTopic, PCONVCONTEXT pCC)
<a name="l00124"></a>00124         {
<a name="l00125"></a>00125                 <span class="keywordflow">return</span> DdeConnect(m_id, hszService, hszTopic, pCC);
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128         HSZ CreateStringHandle(LPTSTR psz, <span class="keywordtype">int</span> iCodePage = CP_WINUNICODE)
<a name="l00129"></a>00129         {
<a name="l00130"></a>00130                 <span class="keywordflow">return</span> DdeCreateStringHandle(m_id, psz, iCodePage);
<a name="l00131"></a>00131         }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133         DWORD QueryString(
<a name="l00134"></a>00134                 HSZ hsz,
<a name="l00135"></a>00135                 LPTSTR psz,
<a name="l00136"></a>00136                 DWORD cchMaxChars,
<a name="l00137"></a>00137                 <span class="keywordtype">int</span> iCodePage = CP_WINUNICODE)
<a name="l00138"></a>00138         {
<a name="l00139"></a>00139                 <span class="keywordflow">return</span> DdeQueryString(m_id, hsz, psz, cchMaxChars, iCodePage);
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141 <span class="preprocessor">#endif</span>
<a name="l00142"></a>00142 <span class="preprocessor"></span>
<a name="l00143"></a>00143         operator DWORD ()<span class="keyword"> const</span>
<a name="l00144"></a>00144 <span class="keyword">        </span>{
<a name="l00145"></a>00145                 <span class="keywordflow">return</span> m_id;
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         DWORD m_id;
<a name="l00149"></a>00149         UINT m_lockCount;
<a name="l00150"></a>00150 };
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 }       <span class="comment">// System</span>
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">// TODO separate dll</span>
<a name="l00156"></a>00156 <span class="preprocessor">#include &quot;Expressive.h&quot;</span>
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="preprocessor">#ifdef _M_X64</span>
<a name="l00159"></a>00159 <span class="preprocessor"></span><span class="preprocessor">#define NX64    // PhysX</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>
<a name="l00162"></a>00162 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>
<a name="l00164"></a>00164 <span class="keyword">typedef</span> GUID KNOWNFOLDERID;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 <span class="keyword">typedef</span> DWORD COLORREF;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="keyword">struct </span>IXAudio2SourceVoice;
<a name="l00169"></a>00169 <span class="keyword">struct </span>IXAudio2SubmixVoice;
<a name="l00170"></a>00170 <span class="keyword">struct </span>IXAudio2MasteringVoice;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 <span class="keyword">struct </span>IXAudio2;
<a name="l00173"></a>00173 <span class="keyword">struct </span>IXAudio2SourceVoice;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="preprocessor">#endif</span>
<a name="l00176"></a>00176 <span class="preprocessor"></span>
<a name="l00177"></a>00177 <span class="keyword">class </span>NxPhysicsSDK;
<a name="l00178"></a>00178 <span class="keyword">class </span>NxScene;
<a name="l00179"></a>00179 <span class="keyword">class </span>NxActor;
<a name="l00180"></a>00180 <span class="keyword">class </span>NxActorDesc;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="comment">/*</span>
<a name="l00183"></a>00183 <span class="comment">typedef System::LDraw::vector2f float2;</span>
<a name="l00184"></a>00184 <span class="comment">typedef System::LDraw::vector3f float3;</span>
<a name="l00185"></a>00185 <span class="comment">typedef System::LDraw::vector4f float4;</span>
<a name="l00186"></a>00186 <span class="comment"></span>
<a name="l00187"></a>00187 <span class="comment">typedef System::LDraw::matrix3f float3x3;</span>
<a name="l00188"></a>00188 <span class="comment">typedef System::LDraw::matrix4f float4x4;</span>
<a name="l00189"></a>00189 <span class="comment">*/</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">/*</span>
<a name="l00192"></a>00192 <span class="comment">template&lt;int place1, int place2, int place3&gt; class Swizzled</span>
<a name="l00193"></a>00193 <span class="comment">{</span>
<a name="l00194"></a>00194 <span class="comment">public:</span>
<a name="l00195"></a>00195 <span class="comment">        float* p;</span>
<a name="l00196"></a>00196 <span class="comment"></span>
<a name="l00197"></a>00197 <span class="comment">        __property float3 get_xyz() const</span>
<a name="l00198"></a>00198 <span class="comment">        {</span>
<a name="l00199"></a>00199 <span class="comment">                return float3(x, y, z);</span>
<a name="l00200"></a>00200 <span class="comment">        }</span>
<a name="l00201"></a>00201 <span class="comment"></span>
<a name="l00202"></a>00202 <span class="comment">};</span>
<a name="l00203"></a>00203 <span class="comment">*/</span>
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <span class="preprocessor">#if 0</span>
<a name="l00206"></a>00206 <span class="preprocessor"></span><span class="preprocessor">#include &lt;xmmintrin.h&gt;</span>
<a name="l00207"></a>00207 <span class="preprocessor">#endif</span>
<a name="l00208"></a>00208 <span class="preprocessor"></span>
<a name="l00209"></a>00209 <span class="preprocessor">#if 0</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span><span class="keyword">class </span>GUIEXT <span class="comment">/*__declspec(align(8))*/</span> float2
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212 <span class="keyword">public</span>:
<a name="l00213"></a>00213         CTOR float2() : x(0), y(0)
<a name="l00214"></a>00214         {
<a name="l00215"></a>00215         }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         CTOR float2(<span class="keywordtype">float</span> _x, <span class="keywordtype">float</span> _y) : x(_x), y(_y)
<a name="l00218"></a>00218         {
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         operator float* ()
<a name="l00222"></a>00222         {
<a name="l00223"></a>00223                 <span class="keywordflow">return</span> &amp;x;
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="keywordtype">float</span> x, y;
<a name="l00227"></a>00227 };
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="keyword">class </span>GUIEXT <span class="comment">/*__declspec(align(16))*/</span> float3
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231 <span class="keyword">public</span>:
<a name="l00232"></a>00232         CTOR float3() : x(0), y(0), z(0)
<a name="l00233"></a>00233         {
<a name="l00234"></a>00234         }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         CTOR float3(<span class="keywordtype">float</span> _x, <span class="keywordtype">float</span> _y, <span class="keywordtype">float</span> _z = 0.0f) : x(_x), y(_y), z(_z)
<a name="l00237"></a>00237         {
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         operator float* ()
<a name="l00241"></a>00241         {
<a name="l00242"></a>00242                 <span class="keywordflow">return</span> &amp;x;
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="keywordtype">float</span> x, y, z;
<a name="l00246"></a>00246 };
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="keyword">class </span>GUIEXT <span class="comment">/*__declspec(align(16))*/</span> float4
<a name="l00249"></a>00249 {
<a name="l00250"></a>00250 <span class="keyword">public</span>:
<a name="l00251"></a>00251         <span class="keyword">inline</span> CTOR float4() : x(0), y(0), z(0), w(0)
<a name="l00252"></a>00252         {
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255         <span class="keyword">inline</span> CTOR float4(<span class="keywordtype">float</span> _x, <span class="keywordtype">float</span> _y, <span class="keywordtype">float</span> _z = 0.0f, <span class="keywordtype">float</span> _w = 1.0f) : x(_x), y(_y), z(_z), w(_w)
<a name="l00256"></a>00256         {
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259         <span class="keyword">inline</span> operator float* ()
<a name="l00260"></a>00260         {
<a name="l00261"></a>00261                 <span class="keywordflow">return</span> &amp;x;
<a name="l00262"></a>00262         }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="keyword">inline</span> operator const float* ()<span class="keyword"> const</span>
<a name="l00265"></a>00265 <span class="keyword">        </span>{
<a name="l00266"></a>00266                 <span class="keywordflow">return</span> &amp;x;
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="keyword">inline</span> <span class="keywordtype">float</span>&amp; operator [] (<span class="keywordtype">int</span> index)
<a name="l00270"></a>00270         {
<a name="l00271"></a>00271                 <span class="keywordflow">return</span> (&amp;x)[index];
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         <span class="keyword">inline</span> <span class="keywordtype">float</span> operator [] (<span class="keywordtype">int</span> index)<span class="keyword"> const</span>
<a name="l00275"></a>00275 <span class="keyword">        </span>{
<a name="l00276"></a>00276                 <span class="keywordflow">return</span> (&amp;x)[index];
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         <span class="comment">/*</span>
<a name="l00280"></a>00280 <span class="comment">#ifndef __LERSTAD__</span>
<a name="l00281"></a>00281 <span class="comment"></span>
<a name="l00282"></a>00282 <span class="comment">        __property float3 get_xyz() const</span>
<a name="l00283"></a>00283 <span class="comment">        {</span>
<a name="l00284"></a>00284 <span class="comment">                return float3(x, y, z);</span>
<a name="l00285"></a>00285 <span class="comment">        }</span>
<a name="l00286"></a>00286 <span class="comment"></span>
<a name="l00287"></a>00287 <span class="comment">        __property float3 get_yxz() const</span>
<a name="l00288"></a>00288 <span class="comment">        {</span>
<a name="l00289"></a>00289 <span class="comment">                return float3(y, x, z);</span>
<a name="l00290"></a>00290 <span class="comment">        }</span>
<a name="l00291"></a>00291 <span class="comment"></span>
<a name="l00292"></a>00292 <span class="comment">        __property float3 get_yzx() const</span>
<a name="l00293"></a>00293 <span class="comment">        {</span>
<a name="l00294"></a>00294 <span class="comment">                return float3(y, z, x);</span>
<a name="l00295"></a>00295 <span class="comment">        }</span>
<a name="l00296"></a>00296 <span class="comment"></span>
<a name="l00297"></a>00297 <span class="comment">        __property float3 get_xzy() const</span>
<a name="l00298"></a>00298 <span class="comment">        {</span>
<a name="l00299"></a>00299 <span class="comment">                return float3(x, z, y);</span>
<a name="l00300"></a>00300 <span class="comment">        }</span>
<a name="l00301"></a>00301 <span class="comment"></span>
<a name="l00302"></a>00302 <span class="comment">        __property float3 get_zyx() const</span>
<a name="l00303"></a>00303 <span class="comment">        {</span>
<a name="l00304"></a>00304 <span class="comment">                return float3(z, y, x);</span>
<a name="l00305"></a>00305 <span class="comment">        }</span>
<a name="l00306"></a>00306 <span class="comment"></span>
<a name="l00307"></a>00307 <span class="comment">#endif</span>
<a name="l00308"></a>00308 <span class="comment">*/</span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310         <span class="keywordtype">float</span> x, y, z, w;
<a name="l00311"></a>00311 <span class="comment">//      __m128 xyzw;</span>
<a name="l00312"></a>00312 };
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="keyword">class </span>GUIEXT <span class="comment">/*__declspec(align(16))*/</span> float4x3
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316 <span class="keyword">public</span>:
<a name="l00317"></a>00317         float4 row[3];
<a name="l00318"></a>00318 };
<a name="l00319"></a>00319 <span class="preprocessor">#endif</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span>
<a name="l00321"></a>00321 <span class="keyword">namespace </span>System
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323 
<a name="l00324"></a>00324 <span class="keyword">typedef</span> gm::vector2f float2;
<a name="l00325"></a>00325 <span class="keyword">typedef</span> gm::vector3f float3;
<a name="l00326"></a>00326 <span class="keyword">typedef</span> gm::vector4f float4;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="keyword">interface </span>IObjectChangedNotify
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnObjectChanged(Object*) abstract;
<a name="l00331"></a>00331 };
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 class GUIEXT <span class="comment">/*__declspec(align(16))*/</span> float4x4
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335 <span class="keyword">public</span>:
<a name="l00336"></a>00336         CTOR float4x4()
<a name="l00337"></a>00337         {
<a name="l00338"></a>00338                 row[0] = float4(1, 0, 0, 0);
<a name="l00339"></a>00339                 row[1] = float4(0, 1, 0, 0);
<a name="l00340"></a>00340                 row[2] = float4(0, 0, 1, 0);
<a name="l00341"></a>00341                 row[3] = float4(0, 0, 0, 1);
<a name="l00342"></a>00342         }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         CTOR float4x4(float4 row0, float4 row1, float4 row2, float4 row3)
<a name="l00345"></a>00345         {
<a name="l00346"></a>00346                 row[0] = row0;
<a name="l00347"></a>00347                 row[1] = row1;
<a name="l00348"></a>00348                 row[2] = row2;
<a name="l00349"></a>00349                 row[3] = row3;
<a name="l00350"></a>00350         }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352         CTOR float4x4(gm::matrix3f&amp; m)
<a name="l00353"></a>00353         {
<a name="l00354"></a>00354                 row[0] = float4(m[0][0], m[0][1], m[0][2], 0);
<a name="l00355"></a>00355                 row[1] = float4(m[1][0], m[1][1], m[1][2], 0);
<a name="l00356"></a>00356                 row[2] = float4(m[2][0], m[2][1], m[2][2], 0);
<a name="l00357"></a>00357                 row[3] = float4(0, 0, 0, 1);
<a name="l00358"></a>00358         }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360         float4&amp; operator [] (<span class="keywordtype">int</span> index)
<a name="l00361"></a>00361         {
<a name="l00362"></a>00362                 <span class="keywordflow">return</span> row[index];
<a name="l00363"></a>00363         }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         float4 operator [] (<span class="keywordtype">int</span> index)<span class="keyword"> const</span>
<a name="l00366"></a>00366 <span class="keyword">        </span>{
<a name="l00367"></a>00367                 <span class="keywordflow">return</span> row[index];
<a name="l00368"></a>00368         }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370         <span class="keywordtype">float</span> operator () (<span class="keywordtype">int</span> rowIndex, <span class="keywordtype">int</span> colIndex)
<a name="l00371"></a>00371         {
<a name="l00372"></a>00372                 <span class="keywordflow">return</span> row[rowIndex][colIndex];
<a name="l00373"></a>00373         }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         operator float* ()
<a name="l00376"></a>00376         {
<a name="l00377"></a>00377                 <span class="keywordflow">return</span> (<span class="keywordtype">float</span>*)<span class="keyword">this</span>;
<a name="l00378"></a>00378         }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380         <span class="comment">/*</span>
<a name="l00381"></a>00381 <span class="comment">        float4x4 transposed() const</span>
<a name="l00382"></a>00382 <span class="comment">        {</span>
<a name="l00383"></a>00383 <span class="comment">                return float4x4</span>
<a name="l00384"></a>00384 <span class="comment">        }</span>
<a name="l00385"></a>00385 <span class="comment">        */</span>
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         float4 row[4];
<a name="l00388"></a>00388 };
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l00393"></a>00393 <span class="preprocessor"></span>
<a name="l00394"></a>00394 <span class="keyword">struct </span>ID3DX10Mesh;
<a name="l00395"></a>00395 <span class="keyword">struct </span>ID3DX10SkinInfo;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">// DirectWrite</span>
<a name="l00398"></a>00398 <span class="keyword">struct </span>IDWriteTextFormat;
<a name="l00399"></a>00399 <span class="keyword">struct </span>IDWriteTextLayout;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401 <span class="keyword">typedef</span> HANDLE HTHUMBNAIL;
<a name="l00402"></a>00402 <span class="keyword">typedef</span> HTHUMBNAIL** PHTHUMBNAIL;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 <span class="keyword">typedef</span> HICON HCURSOR;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="keyword">struct </span>ID2D1StrokeStyle;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="preprocessor">#else</span>
<a name="l00409"></a>00409 <span class="preprocessor"></span>
<a name="l00410"></a>00410 <span class="preprocessor">#include &lt;XAudio2.h&gt;</span>
<a name="l00411"></a>00411 <span class="preprocessor">#include &lt;xaudio2fx.h&gt;</span>
<a name="l00412"></a>00412 <span class="preprocessor">#include &lt;x3daudio.h&gt;</span>
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="preprocessor">#include &lt;dwmapi.h&gt;</span>
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="preprocessor">#include &lt;Shlobj.h&gt;</span>
<a name="l00417"></a>00417 <span class="preprocessor">#include &lt;shobjidl.h&gt;</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="comment">//#undef SEVERITY_WARNING</span>
<a name="l00420"></a>00420 <span class="comment">//#undef SEVERITY_ERROR</span>
<a name="l00421"></a>00421 <span class="comment">//#undef SEVERITY_FATAL_ERROR</span>
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="preprocessor">#endif</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span>
<a name="l00425"></a>00425 <span class="keyword">namespace </span>System
<a name="l00426"></a>00426 {
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 <span class="keyword">enum</span> TextChangeKind
<a name="l00429"></a>00429 {
<a name="l00430"></a>00430         TextChangeKind_All,
<a name="l00431"></a>00431         TextChangeKind_Insert,
<a name="l00432"></a>00432         TextChangeKind_Delete,
<a name="l00433"></a>00433         TextChangeKind_Replace,
<a name="l00434"></a>00434 };
<a name="l00435"></a>00435 
<a name="l00436"></a>00436 <span class="keyword">struct </span>TextSourceChangeEventArgs
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438         TextChangeKind type;
<a name="l00439"></a>00439         <span class="keywordtype">size_t</span> offset;
<a name="l00440"></a>00440         <span class="keywordtype">size_t</span> len;
<a name="l00441"></a>00441 };
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="keyword">interface </span>ITextSource
<a name="l00444"></a>00444 {
<a name="l00445"></a>00445         <span class="keyword">virtual</span> Object* GetObject() abstract;
<a name="l00446"></a>00446         virtual Event2&lt;ITextSource*, TextSourceChangeEventArgs&gt;&amp; get_Changed() abstract;
<a name="l00447"></a>00447         virtual <span class="keywordtype">void</span> Insert(StringIn itext, <span class="keywordtype">size_t</span> offset) abstract;
<a name="l00448"></a>00448         virtual <span class="keywordtype">void</span> Delete(<span class="keywordtype">size_t</span> offset, <span class="keywordtype">size_t</span> len) abstract;
<a name="l00449"></a>00449 };
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 class GUIEXT TextDocument : public IO::StringWriter, public ITextSource, public IHasMimetype
<a name="l00452"></a>00452 {
<a name="l00453"></a>00453 <span class="keyword">public</span>:
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         CTOR TextDocument();
<a name="l00456"></a>00456         CTOR TextDocument(StringIn str);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458         <span class="keyword">virtual</span> Object* GetObject()<span class="keyword"> override</span>
<a name="l00459"></a>00459 <span class="keyword">        </span>{
<a name="l00460"></a>00460                 <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00461"></a>00461         }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463         <span class="keyword">virtual</span> Event2&lt;ITextSource*, TextSourceChangeEventArgs&gt;&amp; get_Changed()<span class="keyword"> override</span>
<a name="l00464"></a>00464 <span class="keyword">        </span>{
<a name="l00465"></a>00465                 <span class="keywordflow">return</span> Changed;
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         <span class="keywordtype">bool</span> SaveAs(StringIn filename);
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Insert(StringIn itext, <span class="keywordtype">size_t</span> offset) <span class="keyword">override</span>;
<a name="l00471"></a>00471         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Delete(<span class="keywordtype">size_t</span> offset, <span class="keywordtype">size_t</span> len) <span class="keyword">override</span>;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473         String get_Mimetype()
<a name="l00474"></a>00474         {
<a name="l00475"></a>00475                 <span class="keywordflow">return</span> m_Mimetype;
<a name="l00476"></a>00476         }
<a name="l00477"></a>00477 
<a name="l00478"></a>00478         <span class="keywordtype">void</span> set_Mimetype(StringIn mimetype)
<a name="l00479"></a>00479         {
<a name="l00480"></a>00480                 m_Mimetype = mimetype;
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         Object* get_Source()
<a name="l00484"></a>00484         {
<a name="l00485"></a>00485                 <span class="keywordflow">return</span> m_Source;
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         Object* m_Source;
<a name="l00489"></a>00489         String m_Mimetype;
<a name="l00490"></a>00490 
<a name="l00491"></a>00491         <span class="keyword">static</span> TextDocument* FromFile(StringIn filename);
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="keyword">protected</span>:
<a name="l00494"></a>00494 
<a name="l00495"></a>00495         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnWritten(<span class="keywordtype">size_t</span> len)<span class="keyword"> override</span>
<a name="l00496"></a>00496 <span class="keyword">        </span>{
<a name="l00497"></a>00497                 TextSourceChangeEventArgs args;
<a name="l00498"></a>00498                 args.type = TextChangeKind_Insert;
<a name="l00499"></a>00499                 args.offset = str().GetLength()-len;
<a name="l00500"></a>00500                 args.len = len;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502                 Changed(<span class="keyword">this</span>, args);
<a name="l00503"></a>00503         }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 <span class="keyword">private</span>:
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         Event2&lt;ITextSource*, TextSourceChangeEventArgs&gt; Changed;
<a name="l00508"></a>00508 };
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">class </span>GUIEXT TimeDuration
<a name="l00511"></a>00511 {
<a name="l00512"></a>00512 <span class="keyword">public</span>:
<a name="l00513"></a>00513         CTOR TimeDuration(uint64 durationNanoSeconds);
<a name="l00514"></a>00514         CTOR TimeDuration(<span class="keywordtype">double</span> durationSeconds);
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <span class="keywordtype">double</span> get_days();
<a name="l00517"></a>00517         <span class="keywordtype">double</span> get_hours();
<a name="l00518"></a>00518         <span class="keywordtype">double</span> get_minutes();
<a name="l00519"></a>00519         <span class="keywordtype">double</span> get_seconds();
<a name="l00520"></a>00520 
<a name="l00521"></a>00521         uint64 m_durationNanoSeconds;
<a name="l00522"></a>00522 };
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 IO::TextWriter&amp; WriteToStream(IO::TextWriter&amp; stream, <span class="keyword">const</span> TimeDuration&amp; duration);
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 <span class="keyword">interface </span>ICamera
<a name="l00527"></a>00527 {
<a name="l00528"></a>00528         <span class="keyword">virtual</span> D3DXMATRIX GetProjectionMatrixLH(<span class="keywordtype">float</span> width, <span class="keywordtype">float</span> height, <span class="keywordtype">float</span> zNear, <span class="keywordtype">float</span> zFar) = 0;
<a name="l00529"></a>00529         <span class="keyword">virtual</span> D3DXMATRIX GetProjectionMatrixRH(<span class="keywordtype">float</span> width, <span class="keywordtype">float</span> height, <span class="keywordtype">float</span> zNear, <span class="keywordtype">float</span> zFar) = 0;
<a name="l00530"></a>00530         <span class="keyword">virtual</span> D3DXMATRIX GetViewMatrix() = 0;
<a name="l00531"></a>00531         <span class="keyword">virtual</span> D3DXMATRIX GetViewMatrixI() = 0;
<a name="l00532"></a>00532 };
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 <span class="comment">// TODO, in LFC</span>
<a name="l00535"></a>00535 <span class="keyword">template</span>&lt;<span class="keyword">class</span> base, <span class="keyword">class</span> derived&gt; <span class="keyword">class </span>offsetofclass
<a name="l00536"></a>00536 {
<a name="l00537"></a>00537 <span class="keyword">public</span>:
<a name="l00538"></a>00538         <span class="keyword">inline</span> operator int ()
<a name="l00539"></a>00539         {
<a name="l00540"></a>00540                 <span class="keywordflow">return</span> ((<span class="keywordtype">int</span>)static_cast&lt;base*&gt;((derived*)8)) - 8;
<a name="l00541"></a>00541         }
<a name="l00542"></a>00542 };
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="comment">/*</span>
<a name="l00545"></a>00545 <span class="comment">#define DEPENDENCY_CLASS(classname, baseclassname)      \</span>
<a name="l00546"></a>00546 <span class="comment">        public: static Gui::DependencyClass* get_Class()        \</span>
<a name="l00547"></a>00547 <span class="comment">{       \</span>
<a name="l00548"></a>00548 <span class="comment">        static Gui::DependencyClass depclass INIT(typeid(classname), baseclassname::get_Class());       \</span>
<a name="l00549"></a>00549 <span class="comment">        return &amp;depclass;       \</span>
<a name="l00550"></a>00550 <span class="comment">}       \</span>
<a name="l00551"></a>00551 <span class="comment">        typedef baseclassname baseClass;</span>
<a name="l00552"></a>00552 <span class="comment">*/</span>
<a name="l00553"></a>00553 
<a name="l00554"></a>00554 <span class="preprocessor">#define DEPENDENCY_CLASS_ABSTRACT(classname, baseclassname)     \</span>
<a name="l00555"></a>00555 <span class="preprocessor">        public: static Gui::DependencyClass* get_Class();       \</span>
<a name="l00556"></a>00556 <span class="preprocessor">        typedef classname thisClass;    \</span>
<a name="l00557"></a>00557 <span class="preprocessor">        typedef baseclassname baseClass;</span>
<a name="l00558"></a>00558 <span class="preprocessor"></span>
<a name="l00559"></a>00559 <span class="preprocessor">#define DEPENDENCY_CLASS(classname, baseclassname)      \</span>
<a name="l00560"></a>00560 <span class="preprocessor">        private: static System::Gui::DependencyClass* pClass;   \</span>
<a name="l00561"></a>00561 <span class="preprocessor">        public: static System::Gui::DependencyClass* get_Class();       \</span>
<a name="l00562"></a>00562 <span class="preprocessor">        typedef classname thisClass;    \</span>
<a name="l00563"></a>00563 <span class="preprocessor">        typedef baseclassname baseClass;</span>
<a name="l00564"></a>00564 <span class="preprocessor"></span>
<a name="l00565"></a>00565 <span class="preprocessor">#define END_DEPENDENCY_CLASS()</span>
<a name="l00566"></a>00566 <span class="preprocessor"></span>
<a name="l00567"></a>00567 <span class="preprocessor">#define GET_PROPERTY(name)      get_##name##Property()</span>
<a name="l00568"></a>00568 <span class="preprocessor"></span>
<a name="l00569"></a>00569 <span class="preprocessor">#define DEPENDENCY_PROPERTY(type, name) \</span>
<a name="l00570"></a>00570 <span class="preprocessor">        static System::Gui::TypedDependencyProperty&lt;type&gt;* get_##name##Property();      \</span>
<a name="l00571"></a>00571 <span class="preprocessor">        type get_##name();      \</span>
<a name="l00572"></a>00572 <span class="preprocessor">        System::Gui::PropertyValue* get_##name##Binding();      \</span>
<a name="l00573"></a>00573 <span class="preprocessor">        void set_##name(type value);    \</span>
<a name="l00574"></a>00574 <span class="preprocessor">        void set_##name##Input(System::Gui::typed&lt;type&gt; value); \</span>
<a name="l00575"></a>00575 <span class="preprocessor">        void set_##name##Expression(System::Expressive::Expression* exp);</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span>
<a name="l00577"></a>00577 <span class="preprocessor">#define DEPENDENCY_PROPERTY_RO(type, name)      \</span>
<a name="l00578"></a>00578 <span class="preprocessor">        type get_##name();      \</span>
<a name="l00579"></a>00579 <span class="preprocessor">        System::Gui::PropertyValue* get_##name##Binding();      \</span>
<a name="l00580"></a>00580 <span class="preprocessor">        protected: void set_##name(type value); \</span>
<a name="l00581"></a>00581 <span class="preprocessor">        void set_##name##Input(System::Gui::typed&lt;type&gt; value); \</span>
<a name="l00582"></a>00582 <span class="preprocessor">        void set_##name##Expression(System::Expressive::Expression* exp);       \</span>
<a name="l00583"></a>00583 <span class="preprocessor">        public: static System::Gui::TypedDependencyProperty&lt;type&gt;* get_##name##Property();</span>
<a name="l00584"></a>00584 <span class="preprocessor"></span>
<a name="l00585"></a>00585 <span class="preprocessor">#define IMP_DEPENDENCY_PROPERTY(type, classname, name, defvalue)        \</span>
<a name="l00586"></a>00586 <span class="preprocessor">        System::Gui::TypedDependencyProperty&lt;type&gt;* classname::get_##name##Property()   \</span>
<a name="l00587"></a>00587 <span class="preprocessor">        {       \</span>
<a name="l00588"></a>00588 <span class="preprocessor">                static System::Gui::TypedDependencyProperty&lt;type&gt; v(classname::get_Class(), L#name, defvalue);  \</span>
<a name="l00589"></a>00589 <span class="preprocessor">                return &amp;v;      \</span>
<a name="l00590"></a>00590 <span class="preprocessor">        }       \</span>
<a name="l00591"></a>00591 <span class="preprocessor">\</span>
<a name="l00592"></a>00592 <span class="preprocessor">        type classname::get_##name()    \</span>
<a name="l00593"></a>00593 <span class="preprocessor">        {       \</span>
<a name="l00594"></a>00594 <span class="preprocessor">                return GetPropertyValueT&lt;type&gt;(GET_PROPERTY(name));     \</span>
<a name="l00595"></a>00595 <span class="preprocessor">        }       \</span>
<a name="l00596"></a>00596 <span class="preprocessor">\</span>
<a name="l00597"></a>00597 <span class="preprocessor">        Gui::PropertyValue* classname::get_##name##Binding()    \</span>
<a name="l00598"></a>00598 <span class="preprocessor">        {       \</span>
<a name="l00599"></a>00599 <span class="preprocessor">                return GetProperty(GET_PROPERTY(name)); \</span>
<a name="l00600"></a>00600 <span class="preprocessor">        }       \</span>
<a name="l00601"></a>00601 <span class="preprocessor">\</span>
<a name="l00602"></a>00602 <span class="preprocessor">        void classname::set_##name(type value)  \</span>
<a name="l00603"></a>00603 <span class="preprocessor">        {       \</span>
<a name="l00604"></a>00604 <span class="preprocessor">                SetPropertyValue(GET_PROPERTY(name), value);    \</span>
<a name="l00605"></a>00605 <span class="preprocessor">        }       \</span>
<a name="l00606"></a>00606 <span class="preprocessor">        void classname::set_##name##Input(Gui::typed&lt;type&gt; value)       \</span>
<a name="l00607"></a>00607 <span class="preprocessor">        {       \</span>
<a name="l00608"></a>00608 <span class="preprocessor">                Gui::SetBinding(this, GET_PROPERTY(name), value);       \</span>
<a name="l00609"></a>00609 <span class="preprocessor">        }       \</span>
<a name="l00610"></a>00610 <span class="preprocessor">        void classname::set_##name##Expression(Expressive::Expression* exp)     \</span>
<a name="l00611"></a>00611 <span class="preprocessor">        {       \</span>
<a name="l00612"></a>00612 <span class="preprocessor">                SetPropertyBinding(GET_PROPERTY(name), new Gui::ExpressionBinding(this, exp));  \</span>
<a name="l00613"></a>00613 <span class="preprocessor">        }</span>
<a name="l00614"></a>00614 <span class="preprocessor"></span>
<a name="l00615"></a>00615 <span class="preprocessor">#define IMP_DEPENDENCY_PROPERTY1(type, classname, name, defvalue, metadata)     \</span>
<a name="l00616"></a>00616 <span class="preprocessor">        System::Gui::TypedDependencyProperty&lt;type&gt;* classname::get_##name##Property()   \</span>
<a name="l00617"></a>00617 <span class="preprocessor">        {       \</span>
<a name="l00618"></a>00618 <span class="preprocessor">                static Gui::TypedDependencyProperty&lt;type&gt; v(classname::get_Class(), L#name, defvalue, metadata);        \</span>
<a name="l00619"></a>00619 <span class="preprocessor">                return &amp;v;      \</span>
<a name="l00620"></a>00620 <span class="preprocessor">        }       \</span>
<a name="l00621"></a>00621 <span class="preprocessor">\</span>
<a name="l00622"></a>00622 <span class="preprocessor">        type classname::get_##name()    \</span>
<a name="l00623"></a>00623 <span class="preprocessor">        {       \</span>
<a name="l00624"></a>00624 <span class="preprocessor">                return GetPropertyValueT&lt;type&gt;(GET_PROPERTY(name));     \</span>
<a name="l00625"></a>00625 <span class="preprocessor">        }       \</span>
<a name="l00626"></a>00626 <span class="preprocessor">\</span>
<a name="l00627"></a>00627 <span class="preprocessor">        System::Gui::PropertyValue* classname::get_##name##Binding()    \</span>
<a name="l00628"></a>00628 <span class="preprocessor">        {       \</span>
<a name="l00629"></a>00629 <span class="preprocessor">                return GetProperty(GET_PROPERTY(name)); \</span>
<a name="l00630"></a>00630 <span class="preprocessor">        }       \</span>
<a name="l00631"></a>00631 <span class="preprocessor">\</span>
<a name="l00632"></a>00632 <span class="preprocessor">        void classname::set_##name(type value)  \</span>
<a name="l00633"></a>00633 <span class="preprocessor">        {       \</span>
<a name="l00634"></a>00634 <span class="preprocessor">                SetPropertyValue(GET_PROPERTY(name), value);    \</span>
<a name="l00635"></a>00635 <span class="preprocessor">        }       \</span>
<a name="l00636"></a>00636 <span class="preprocessor">        void classname::set_##name##Input(Gui::typed&lt;type&gt; value)       \</span>
<a name="l00637"></a>00637 <span class="preprocessor">        {       \</span>
<a name="l00638"></a>00638 <span class="preprocessor">                System::Gui::SetBinding(this, GET_PROPERTY(name), value);       \</span>
<a name="l00639"></a>00639 <span class="preprocessor">        }       \</span>
<a name="l00640"></a>00640 <span class="preprocessor">        void classname::set_##name##Expression(Expressive::Expression* exp)     \</span>
<a name="l00641"></a>00641 <span class="preprocessor">        {       \</span>
<a name="l00642"></a>00642 <span class="preprocessor">                SetPropertyBinding(GET_PROPERTY(name), new Gui::ExpressionBinding(this, exp));  \</span>
<a name="l00643"></a>00643 <span class="preprocessor">        }</span>
<a name="l00644"></a>00644 <span class="preprocessor"></span>
<a name="l00645"></a>00645 <span class="preprocessor">#define IMP_DEPENDENCY_PROPERTY_T(T, type, classname, name, defvalue)   \</span>
<a name="l00646"></a>00646 <span class="preprocessor">        template&lt;class T&gt; Gui::TypedDependencyProperty&lt;type&gt;* classname::get_##name##Property() \</span>
<a name="l00647"></a>00647 <span class="preprocessor">        {       \</span>
<a name="l00648"></a>00648 <span class="preprocessor">                static Gui::TypedDependencyProperty&lt;type&gt; v(classname::get_Class(), L#name, defvalue);  \</span>
<a name="l00649"></a>00649 <span class="preprocessor">                return &amp;v;      \</span>
<a name="l00650"></a>00650 <span class="preprocessor">        }       \</span>
<a name="l00651"></a>00651 <span class="preprocessor">\</span>
<a name="l00652"></a>00652 <span class="preprocessor">        template&lt;class T&gt; type classname::get_##name()  \</span>
<a name="l00653"></a>00653 <span class="preprocessor">        {       \</span>
<a name="l00654"></a>00654 <span class="preprocessor">                return GetPropertyValueT&lt;type&gt;(GET_PROPERTY(name));     \</span>
<a name="l00655"></a>00655 <span class="preprocessor">        }       \</span>
<a name="l00656"></a>00656 <span class="preprocessor">\</span>
<a name="l00657"></a>00657 <span class="preprocessor">        template&lt;class T&gt; void classname::set_##name##Input(Gui::typed&lt;type&gt; value)     \</span>
<a name="l00658"></a>00658 <span class="preprocessor">        {       \</span>
<a name="l00659"></a>00659 <span class="preprocessor">                Gui::SetBinding(this, GET_PROPERTY(name), value);       \</span>
<a name="l00660"></a>00660 <span class="preprocessor">        }       \</span>
<a name="l00661"></a>00661 <span class="preprocessor">        template&lt;class T&gt; Gui::PropertyValue* classname::get_##name##Binding()  \</span>
<a name="l00662"></a>00662 <span class="preprocessor">        {       \</span>
<a name="l00663"></a>00663 <span class="preprocessor">                return GetProperty(GET_PROPERTY(name)); \</span>
<a name="l00664"></a>00664 <span class="preprocessor">        }       \</span>
<a name="l00665"></a>00665 <span class="preprocessor">\</span>
<a name="l00666"></a>00666 <span class="preprocessor">        template&lt;class T&gt; void classname::set_##name(type value)        \</span>
<a name="l00667"></a>00667 <span class="preprocessor">        {       \</span>
<a name="l00668"></a>00668 <span class="preprocessor">                SetPropertyValue(GET_PROPERTY(name), value);    \</span>
<a name="l00669"></a>00669 <span class="preprocessor">        }       \</span>
<a name="l00670"></a>00670 <span class="preprocessor">        template&lt;class T&gt; void classname::set_##name##Expression(Expressive::Expression* exp)   \</span>
<a name="l00671"></a>00671 <span class="preprocessor">        {       \</span>
<a name="l00672"></a>00672 <span class="preprocessor">                SetPropertyBinding(GET_PROPERTY(name), new Gui::ExpressionBinding(this, exp));  \</span>
<a name="l00673"></a>00673 <span class="preprocessor">        }</span>
<a name="l00674"></a>00674 <span class="preprocessor"></span>
<a name="l00675"></a>00675 <span class="preprocessor">#define IMP_USE_DEPENDENCY_PROPERTY(type, classname, fromclassname, name)       \</span>
<a name="l00676"></a>00676 <span class="preprocessor">        Gui::TypedDependencyProperty&lt;type&gt;* classname::get_##name##Property()   \</span>
<a name="l00677"></a>00677 <span class="preprocessor">        {       \</span>
<a name="l00678"></a>00678 <span class="preprocessor">                return fromclassname::get_##name##Property();   \</span>
<a name="l00679"></a>00679 <span class="preprocessor">        }       \</span>
<a name="l00680"></a>00680 <span class="preprocessor">\</span>
<a name="l00681"></a>00681 <span class="preprocessor">        type classname::get_##name()    \</span>
<a name="l00682"></a>00682 <span class="preprocessor">        {       \</span>
<a name="l00683"></a>00683 <span class="preprocessor">                return GetPropertyValueT&lt;type&gt;(GET_PROPERTY(name));     \</span>
<a name="l00684"></a>00684 <span class="preprocessor">        }       \</span>
<a name="l00685"></a>00685 <span class="preprocessor">\</span>
<a name="l00686"></a>00686 <span class="preprocessor">        void classname::set_##name(type value)  \</span>
<a name="l00687"></a>00687 <span class="preprocessor">        {       \</span>
<a name="l00688"></a>00688 <span class="preprocessor">                SetPropertyValue(GET_PROPERTY(name), value);    \</span>
<a name="l00689"></a>00689 <span class="preprocessor">        }</span>
<a name="l00690"></a>00690 <span class="preprocessor"></span>
<a name="l00691"></a>00691 <span class="preprocessor">#define ROUTEDEVENT_IMP0(cl, args, name)        \</span>
<a name="l00692"></a>00692 <span class="preprocessor">protected:      virtual void On##name(args* _args) {} \</span>
<a name="l00693"></a>00693 <span class="preprocessor">public: Event2&lt;cl*,args*&gt;&amp; get_##name##Event()  \</span>
<a name="l00694"></a>00694 <span class="preprocessor">        {       \</span>
<a name="l00695"></a>00695 <span class="preprocessor">        return *(Event2&lt;cl*,args*&gt;*)get_RoutedEvent(name##Event);       \</span>
<a name="l00696"></a>00696 <span class="preprocessor">        }       \</span>
<a name="l00697"></a>00697 <span class="preprocessor">        static RoutedEvent* name##Event;</span>
<a name="l00698"></a>00698 <span class="preprocessor"></span>
<a name="l00699"></a>00699 <span class="preprocessor">#define ROUTEDEVENT_IMP1(cl, args, name)        \</span>
<a name="l00700"></a>00700 <span class="preprocessor">protected:      virtual void On##name(args* _args); \</span>
<a name="l00701"></a>00701 <span class="preprocessor">public: Event2&lt;cl*,args*&gt;&amp; get_##name##Event()  \</span>
<a name="l00702"></a>00702 <span class="preprocessor">        {       \</span>
<a name="l00703"></a>00703 <span class="preprocessor">        return *(Event2&lt;cl*,args*&gt;*)get_RoutedEvent(name##Event);       \</span>
<a name="l00704"></a>00704 <span class="preprocessor">        }       \</span>
<a name="l00705"></a>00705 <span class="preprocessor">        static RoutedEvent* name##Event;</span>
<a name="l00706"></a>00706 <span class="preprocessor"></span>
<a name="l00707"></a>00707 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00708"></a>00708 <span class="preprocessor"></span><span class="keyword">namespace </span>Expressive
<a name="l00709"></a>00709 {
<a name="l00710"></a>00710 
<a name="l00711"></a>00711 <span class="keyword">template</span>&lt;&gt; <span class="keyword">class </span>typed_expression&lt;StringObject*&gt; : <span class="keyword">public</span> _Object
<a name="l00712"></a>00712 {
<a name="l00713"></a>00713 <span class="keyword">public</span>:
<a name="l00714"></a>00714         CTOR typed_expression&lt;StringObject*&gt;(<span class="keyword">const</span> expression&amp; exp) : _Object(exp)
<a name="l00715"></a>00715         {
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717 };
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 <span class="preprocessor">#endif</span>
<a name="l00721"></a>00721 <span class="preprocessor"></span>
<a name="l00722"></a>00722 <span class="keyword">typedef</span> Expressive::typed_expression&lt;StringObject*&gt; _String;
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="preprocessor">#if 0</span>
<a name="l00725"></a>00725 <span class="preprocessor"></span><span class="keyword">class </span>GUIEXT _String : <span class="keyword">public</span> Expressive::_Object
<a name="l00726"></a>00726 {
<a name="l00727"></a>00727 <span class="keyword">public</span>:
<a name="l00728"></a>00728 
<a name="l00729"></a>00729         <span class="comment">/*</span>
<a name="l00730"></a>00730 <span class="comment">        Expressive::typed_expression&lt;int&gt; getLength() const</span>
<a name="l00731"></a>00731 <span class="comment">        {</span>
<a name="l00732"></a>00732 <span class="comment"></span>
<a name="l00733"></a>00733 <span class="comment">                // TODO</span>
<a name="l00734"></a>00734 <span class="comment">                ASSERT(0);</span>
<a name="l00735"></a>00735 <span class="comment">                return NULL;</span>
<a name="l00736"></a>00736 <span class="comment">        }</span>
<a name="l00737"></a>00737 <span class="comment">        */</span>
<a name="l00738"></a>00738 };
<a name="l00739"></a>00739 <span class="preprocessor">#endif</span>
<a name="l00740"></a>00740 <span class="preprocessor"></span>
<a name="l00741"></a>00741 <span class="keyword">namespace </span>Gui
<a name="l00742"></a>00742 {
<a name="l00743"></a>00743 
<a name="l00744"></a>00744 <span class="keyword">interface </span>IInputElement;
<a name="l00745"></a>00745 <span class="keyword">interface </span>IRootVisual;
<a name="l00746"></a>00746 
<a name="l00747"></a>00747 <span class="keyword">class </span>Geometry;
<a name="l00748"></a>00748 <span class="keyword">class </span>RoutedEvent;
<a name="l00749"></a>00749 <span class="keyword">class </span>RoutedEventArgs;
<a name="l00750"></a>00750 <span class="keyword">class </span>DependencyClass;
<a name="l00751"></a>00751 <span class="keyword">class </span>DependencyProperty;
<a name="l00752"></a>00752 <span class="keyword">class </span>DependencyObject;
<a name="l00753"></a>00753 <span class="keyword">class </span>Brush;
<a name="l00754"></a>00754 <span class="keyword">class </span>Visual;
<a name="l00755"></a>00755 <span class="keyword">class </span>UIElement;
<a name="l00756"></a>00756 <span class="comment">//class Window;</span>
<a name="l00757"></a>00757 <span class="keyword">class </span>PlatformWindow;
<a name="l00758"></a>00758 <span class="keyword">class </span>PropertyValue;
<a name="l00759"></a>00759 <span class="keyword">class </span>VisualCollection;
<a name="l00760"></a>00760 <span class="keyword">class </span>Transform;
<a name="l00761"></a>00761 <span class="keyword">class </span>Visuals;
<a name="l00762"></a>00762 <span class="comment">//class FontFamily;</span>
<a name="l00763"></a>00763 <span class="keyword">class </span>Element;
<a name="l00764"></a>00764 <span class="keyword">class </span>WindowVisual;
<a name="l00765"></a>00765 <span class="keyword">class </span>BitmapSource;
<a name="l00766"></a>00766 <span class="keyword">class </span>GroupVisual;
<a name="l00767"></a>00767 <span class="keyword">class </span>StrokeStyle;
<a name="l00768"></a>00768 <span class="keyword">class </span>Cursor;
<a name="l00769"></a>00769 <span class="keyword">class </span>ExpressionBinding;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 <span class="keyword">class </span>geometry;
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 <span class="keyword">typedef</span> WindowVisual Window;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775 <span class="keyword">class </span>OleContainer;
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 <span class="keyword">namespace </span>Media3D
<a name="l00778"></a>00778 {
<a name="l00779"></a>00779 <span class="keyword">class </span>Transform3D;
<a name="l00780"></a>00780 }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782 <span class="keyword">class </span>_DependencyObject;
<a name="l00783"></a>00783 <span class="keyword">class </span>_Window;
<a name="l00784"></a>00784 <span class="keyword">class </span>_Element;
<a name="l00785"></a>00785 <span class="keyword">class </span>_UIElement;
<a name="l00786"></a>00786 <span class="keyword">class </span>_FrameworkElement;
<a name="l00787"></a>00787 <span class="keyword">class </span>_ContentElement;
<a name="l00788"></a>00788 <span class="comment">//class _TextElement;</span>
<a name="l00789"></a>00789 <span class="keyword">class </span>_Control;
<a name="l00790"></a>00790 <span class="keyword">class </span>_ContentControl;
<a name="l00791"></a>00791 <span class="keyword">class </span>_Visual;
<a name="l00792"></a>00792 <span class="keyword">class </span>_BitmapVisual;
<a name="l00793"></a>00793 <span class="keyword">class </span>_Geometry;
<a name="l00794"></a>00794 <span class="keyword">class </span>_RectangleGeometry;
<a name="l00795"></a>00795 <span class="keyword">class </span>_EllipseGeometry;
<a name="l00796"></a>00796 <span class="keyword">class </span>_Button;
<a name="l00797"></a>00797 <span class="keyword">class </span>_GeneralTransform;
<a name="l00798"></a>00798 <span class="keyword">class </span>_RotateTransform;
<a name="l00799"></a>00799 <span class="keyword">class </span>_TextVisual;
<a name="l00800"></a>00800 <span class="keyword">class </span>_WindowVisual;
<a name="l00801"></a>00801 <span class="keyword">class </span>_FillGeometryVisual;
<a name="l00802"></a>00802 <span class="keyword">class </span>_StrokeGeometryVisual;
<a name="l00803"></a>00803 <span class="keyword">class </span>_RenderGeometryVisual;
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 <span class="keyword">class </span>RenderContext;
<a name="l00806"></a>00806 <span class="keyword">class </span>RetainedRenderContext;
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00809"></a>00809 <span class="preprocessor"></span>D2D1_POINT_2F cnv(gm::PointF point);
<a name="l00810"></a>00810 gm::PointF cnv(D2D1_POINT_2F point);
<a name="l00811"></a>00811 <span class="preprocessor">#endif</span>
<a name="l00812"></a>00812 <span class="preprocessor"></span>
<a name="l00813"></a>00813 <span class="keyword">interface </span>IBitmapSource
<a name="l00814"></a>00814 {
<a name="l00815"></a>00815         <span class="keyword">virtual</span> Graphics::Bitmap* GetBitmap() abstract;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817 <span class="comment">// TODO, changed</span>
<a name="l00818"></a>00818 };
<a name="l00819"></a>00819 
<a name="l00820"></a>00820 enum FlowDirection
<a name="l00821"></a>00821 {
<a name="l00822"></a>00822         FlowDirection_LeftToRight,
<a name="l00823"></a>00823         FlowDirection_RightToLeft
<a name="l00824"></a>00824 };
<a name="l00825"></a>00825 
<a name="l00826"></a>00826 <span class="keyword">enum</span> HorizontalAlignment
<a name="l00827"></a>00827 {
<a name="l00828"></a>00828         HorizontalAlignment_Left,
<a name="l00829"></a>00829         HorizontalAlignment_Center,
<a name="l00830"></a>00830         HorizontalAlignment_Right,
<a name="l00831"></a>00831         HorizontalAlignment_Stretch
<a name="l00832"></a>00832 };
<a name="l00833"></a>00833 
<a name="l00834"></a>00834 <span class="keyword">class </span>GUIEXT Thickness : <span class="keyword">public</span> Object
<a name="l00835"></a>00835 {
<a name="l00836"></a>00836 <span class="keyword">public</span>:
<a name="l00837"></a>00837 
<a name="l00838"></a>00838         CTOR Thickness() :
<a name="l00839"></a>00839                 m_left(0),
<a name="l00840"></a>00840                 m_right(0),
<a name="l00841"></a>00841                 m_top(0),
<a name="l00842"></a>00842                 m_bottom(0)
<a name="l00843"></a>00843         {
<a name="l00844"></a>00844         }
<a name="l00845"></a>00845 
<a name="l00846"></a>00846         CTOR Thickness(<span class="keywordtype">float</span> value) :
<a name="l00847"></a>00847                 m_left(value),
<a name="l00848"></a>00848                 m_right(value),
<a name="l00849"></a>00849                 m_top(value),
<a name="l00850"></a>00850                 m_bottom(value)
<a name="l00851"></a>00851         {
<a name="l00852"></a>00852         }
<a name="l00853"></a>00853 
<a name="l00854"></a>00854         CTOR Thickness(<span class="keywordtype">float</span> leftright, <span class="keywordtype">float</span> topbottom) :
<a name="l00855"></a>00855                 m_left(leftright),
<a name="l00856"></a>00856                 m_right(leftright),
<a name="l00857"></a>00857                 m_top(topbottom),
<a name="l00858"></a>00858                 m_bottom(topbottom)
<a name="l00859"></a>00859         {
<a name="l00860"></a>00860         }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862         CTOR Thickness(<span class="keywordtype">float</span> left, <span class="keywordtype">float</span> right, <span class="keywordtype">float</span> top, <span class="keywordtype">float</span> bottom) :
<a name="l00863"></a>00863                 m_left(left),
<a name="l00864"></a>00864                 m_right(right),
<a name="l00865"></a>00865                 m_top(top),
<a name="l00866"></a>00866                 m_bottom(bottom)
<a name="l00867"></a>00867         {
<a name="l00868"></a>00868         }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870 <span class="keyword">public</span>:
<a name="l00871"></a>00871 
<a name="l00872"></a>00872         <span class="keywordtype">float</span> m_left;
<a name="l00873"></a>00873         <span class="keywordtype">float</span> m_top;
<a name="l00874"></a>00874         <span class="keywordtype">float</span> m_right;
<a name="l00875"></a>00875         <span class="keywordtype">float</span> m_bottom;
<a name="l00876"></a>00876 };
<a name="l00877"></a>00877 
<a name="l00878"></a>00878 <span class="keyword">interface </span>IRootVisual
<a name="l00879"></a>00879 {
<a name="l00880"></a>00880         <span class="keyword">virtual</span> <span class="keywordtype">void</span> InvalidateRender() = 0;
<a name="l00881"></a>00881         <span class="keyword">virtual</span> OleContainer* GetOleContainer() = 0;
<a name="l00882"></a>00882         <span class="keyword">virtual</span> Graphics::GraphicsI* GetGI() = 0;
<a name="l00883"></a>00883         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> ElementCaptureMouse(UIElement* element) = 0;
<a name="l00884"></a>00884         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> ElementReleaseMouseCapture(UIElement* element) = 0;
<a name="l00885"></a>00885         <span class="keyword">virtual</span> <span class="keywordtype">void</span> ElementSetMouseCursor(UIElement* element) = 0;
<a name="l00886"></a>00886         <span class="keyword">virtual</span> <span class="keywordtype">void</span> ElementSetFocus(UIElement* element) = 0;
<a name="l00887"></a>00887 };
<a name="l00888"></a>00888 
<a name="l00889"></a>00889 <span class="keyword">class </span>RectBorder
<a name="l00890"></a>00890 {
<a name="l00891"></a>00891 <span class="keyword">public</span>:
<a name="l00892"></a>00892 
<a name="l00893"></a>00893         <span class="keyword">class </span>_RectBorder : <span class="keyword">public</span> Expressive::_object
<a name="l00894"></a>00894         {
<a name="l00895"></a>00895         <span class="keyword">public</span>:
<a name="l00896"></a>00896 
<a name="l00897"></a>00897                 <span class="keyword">typedef</span> RectBorder type_t;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899                 <span class="keyword">virtual</span> <span class="keywordtype">int</span> get_sizeof()<span class="keyword"> const</span>
<a name="l00900"></a>00900 <span class="keyword">                </span>{
<a name="l00901"></a>00901                         <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(RectBorder);
<a name="l00902"></a>00902                 }
<a name="l00903"></a>00903 
<a name="l00904"></a>00904                 Expressive::typed_expression&lt;float&gt; Left()<span class="keyword"> const</span>
<a name="l00905"></a>00905 <span class="keyword">                </span>{
<a name="l00906"></a>00906 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00907"></a>00907 <span class="preprocessor"></span>                        <span class="keywordflow">return</span> getMember(offsetof(RectBorder, Left));
<a name="l00908"></a>00908 <span class="preprocessor">#endif</span>
<a name="l00909"></a>00909 <span class="preprocessor"></span>                }
<a name="l00910"></a>00910 
<a name="l00911"></a>00911                 Expressive::typed_expression&lt;float&gt; Top()<span class="keyword"> const</span>
<a name="l00912"></a>00912 <span class="keyword">                </span>{
<a name="l00913"></a>00913 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00914"></a>00914 <span class="preprocessor"></span>                        <span class="keywordflow">return</span> getMember(offsetof(RectBorder, Top));
<a name="l00915"></a>00915 <span class="preprocessor">#endif</span>
<a name="l00916"></a>00916 <span class="preprocessor"></span>                }
<a name="l00917"></a>00917 
<a name="l00918"></a>00918                 Expressive::typed_expression&lt;float&gt; Right()<span class="keyword"> const</span>
<a name="l00919"></a>00919 <span class="keyword">                </span>{
<a name="l00920"></a>00920 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00921"></a>00921 <span class="preprocessor"></span>                        <span class="keywordflow">return</span> getMember(offsetof(RectBorder, Right));
<a name="l00922"></a>00922 <span class="preprocessor">#endif</span>
<a name="l00923"></a>00923 <span class="preprocessor"></span>                }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925                 Expressive::typed_expression&lt;float&gt; Bottom()<span class="keyword"> const</span>
<a name="l00926"></a>00926 <span class="keyword">                </span>{
<a name="l00927"></a>00927 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l00928"></a>00928 <span class="preprocessor"></span>                        <span class="keywordflow">return</span> getMember(offsetof(RectBorder, Bottom));
<a name="l00929"></a>00929 <span class="preprocessor">#endif</span>
<a name="l00930"></a>00930 <span class="preprocessor"></span>                }
<a name="l00931"></a>00931         };
<a name="l00932"></a>00932 
<a name="l00933"></a>00933         <span class="keyword">inline</span> CTOR RectBorder() : Left(0), Top(0), Right(0), Bottom(0)
<a name="l00934"></a>00934         {
<a name="l00935"></a>00935         }
<a name="l00936"></a>00936 
<a name="l00937"></a>00937         <span class="keyword">inline</span> CTOR RectBorder(<span class="keywordtype">float</span> left, <span class="keywordtype">float</span> top, <span class="keywordtype">float</span> right, <span class="keywordtype">float</span> bottom) : Left(left), Top(top), Right(right), Bottom(bottom)
<a name="l00938"></a>00938         {
<a name="l00939"></a>00939         }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941         <span class="keywordtype">float</span> Left;
<a name="l00942"></a>00942         <span class="keywordtype">float</span> Top;
<a name="l00943"></a>00943         <span class="keywordtype">float</span> Right;
<a name="l00944"></a>00944         <span class="keywordtype">float</span> Bottom;
<a name="l00945"></a>00945 };
<a name="l00946"></a>00946 
<a name="l00947"></a>00947 <span class="comment">/*</span>
<a name="l00948"></a>00948 <span class="comment">struct MATRIX_3X2_F</span>
<a name="l00949"></a>00949 <span class="comment">{</span>
<a name="l00950"></a>00950 <span class="comment">    float _11, _12;</span>
<a name="l00951"></a>00951 <span class="comment">    float _21, _22;</span>
<a name="l00952"></a>00952 <span class="comment">    float _31, _32;</span>
<a name="l00953"></a>00953 <span class="comment">};</span>
<a name="l00954"></a>00954 <span class="comment">*/</span>
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 <span class="keyword">typedef</span> RenderContext RenderTarget;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958 <span class="keyword">class </span>GUIEXT EventArgs : <span class="keyword">public</span> Object
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960 <span class="keyword">public</span>:
<a name="l00961"></a>00961         CTOR EventArgs();
<a name="l00962"></a>00962 };
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 <span class="keyword">typedef</span> gm::PointF Point;
<a name="l00965"></a>00965 
<a name="l00966"></a>00966 <span class="keyword">interface </span>IInputElement
<a name="l00967"></a>00967 {
<a name="l00968"></a>00968 <span class="comment">//      virtual void AddHandler(RoutedEvent* routedEvent, EventHandler handler) = 0;</span>
<a name="l00969"></a>00969 <span class="comment">//      virtual void RemoveHandler(RoutedEvent* routedEvent, EventHandler handler) = 0;</span>
<a name="l00970"></a>00970         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RaiseEvent(RoutedEventArgs* args) = 0;
<a name="l00971"></a>00971         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> CaptureMouse() = 0;
<a name="l00972"></a>00972         <span class="keyword">virtual</span> <span class="keywordtype">void</span> ReleaseMouseCapture() = 0;
<a name="l00973"></a>00973         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetCaptureMouse(<span class="keywordtype">bool</span> b) = 0;
<a name="l00974"></a>00974 <span class="preprocessor">#if 0</span>
<a name="l00975"></a>00975 <span class="preprocessor"></span>
<a name="l00976"></a>00976         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Focus() = 0;
<a name="l00977"></a>00977 
<a name="l00978"></a>00978         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_IsEnabled() = 0;
<a name="l00979"></a>00979         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_IsKeyboardFocused() = 0;
<a name="l00980"></a>00980         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_IsKeyboardFocusWithin() = 0;
<a name="l00981"></a>00981         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_IsMouseCaptured() = 0;
<a name="l00982"></a>00982         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_IsMouseOver() = 0;
<a name="l00983"></a>00983         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> get_IsMouseDirectlyOver() = 0;
<a name="l00984"></a>00984 <span class="preprocessor">#endif</span>
<a name="l00985"></a>00985 <span class="preprocessor"></span>};
<a name="l00986"></a>00986 
<a name="l00987"></a>00987 <span class="keyword">interface </span>ICommand
<a name="l00988"></a>00988 {
<a name="l00989"></a>00989         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> CanExecute(Object* parameter) = 0;
<a name="l00990"></a>00990         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Execute(Object* parameter) = 0;
<a name="l00991"></a>00991         <span class="keyword">virtual</span> Event1&lt;Object*&gt;&amp; get_CanExecuteChanged() = 0;
<a name="l00992"></a>00992 };
<a name="l00993"></a>00993 
<a name="l00994"></a>00994 <span class="keyword">interface </span>ICommandSource
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996         <span class="keyword">virtual</span> ICommand* get_Command() = 0;
<a name="l00997"></a>00997         <span class="keyword">virtual</span> Object* get_CommandParameter() = 0;
<a name="l00998"></a>00998         <span class="keyword">virtual</span> IInputElement* get_CommandTarget() = 0;
<a name="l00999"></a>00999 };
<a name="l01000"></a>01000 
<a name="l01001"></a>01001 <span class="keyword">enum</span> RoutingStrategy
<a name="l01002"></a>01002 {
<a name="l01003"></a>01003         RoutingStrategy_Tunnel,
<a name="l01004"></a>01004         RoutingStrategy_Bubble,
<a name="l01005"></a>01005         RoutingStrategy_Direct,
<a name="l01006"></a>01006 };
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 }
<a name="l01009"></a>01009 }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 <span class="preprocessor">#include &quot;DataFormats.h&quot;</span>
<a name="l01012"></a>01012 
<a name="l01013"></a>01013 <span class="preprocessor">#include &quot;RoutedEvent.h&quot;</span>
<a name="l01014"></a>01014 <span class="preprocessor">#include &quot;RoutedEventArgs.h&quot;</span>
<a name="l01015"></a>01015 <span class="preprocessor">#include &quot;EventManager.h&quot;</span>
<a name="l01016"></a>01016 
<a name="l01017"></a>01017 <span class="preprocessor">#include &quot;MouseEventArgs.h&quot;</span>
<a name="l01018"></a>01018 <span class="preprocessor">#include &quot;MouseButtonEventArgs.h&quot;</span>
<a name="l01019"></a>01019 
<a name="l01020"></a>01020 <span class="keyword">namespace </span>System
<a name="l01021"></a>01021 {
<a name="l01022"></a>01022 
<a name="l01023"></a>01023 <span class="keyword">namespace </span>Gdi
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025 
<a name="l01026"></a>01026 <span class="keyword">class </span>GUIEXT Rgn
<a name="l01027"></a>01027 {
<a name="l01028"></a>01028 <span class="keyword">public</span>:
<a name="l01029"></a>01029 
<a name="l01030"></a>01030         CTOR Rgn() : m_hRgn(nullptr)
<a name="l01031"></a>01031         {
<a name="l01032"></a>01032         }
<a name="l01033"></a>01033 
<a name="l01034"></a>01034         CTOR Rgn(HRGN hRgn) : m_hRgn(hRgn)
<a name="l01035"></a>01035         {
<a name="l01036"></a>01036         }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038         <span class="comment">/*</span>
<a name="l01039"></a>01039 <span class="comment">        ~Rgn()</span>
<a name="l01040"></a>01040 <span class="comment">        {</span>
<a name="l01041"></a>01041 <span class="comment">                if (m_hRgn)</span>
<a name="l01042"></a>01042 <span class="comment">                {</span>
<a name="l01043"></a>01043 <span class="comment">                        if (m_refcount == 1)</span>
<a name="l01044"></a>01044 <span class="comment">                        {</span>
<a name="l01045"></a>01045 <span class="comment">                                DeleteObject(m_hRgn);</span>
<a name="l01046"></a>01046 <span class="comment">                        }</span>
<a name="l01047"></a>01047 <span class="comment">                }</span>
<a name="l01048"></a>01048 <span class="comment">        }</span>
<a name="l01049"></a>01049 <span class="comment">        */</span>
<a name="l01050"></a>01050 
<a name="l01051"></a>01051         HRGN Detach() throw()
<a name="l01052"></a>01052         {
<a name="l01053"></a>01053                 HRGN hRgn = m_hRgn;
<a name="l01054"></a>01054                 m_hRgn = <span class="keyword">nullptr</span>;
<a name="l01055"></a>01055                 <span class="keywordflow">return</span> hRgn;
<a name="l01056"></a>01056         }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058         operator HRGN () <span class="keyword">const</span> throw()
<a name="l01059"></a>01059         {
<a name="l01060"></a>01060                 <span class="keywordflow">return</span> m_hRgn;
<a name="l01061"></a>01061         }
<a name="l01062"></a>01062 
<a name="l01063"></a>01063 <span class="keyword">protected</span>:
<a name="l01064"></a>01064 
<a name="l01065"></a>01065         HRGN m_hRgn;
<a name="l01066"></a>01066 <span class="comment">//      int m_refcount;</span>
<a name="l01067"></a>01067 };
<a name="l01068"></a>01068 
<a name="l01069"></a>01069 }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071 <span class="keyword">namespace </span>Gui
<a name="l01072"></a>01072 {
<a name="l01073"></a>01073 
<a name="l01074"></a>01074 <span class="keyword">enum</span> FontStyle
<a name="l01075"></a>01075 {
<a name="l01076"></a>01076         FontStyle_Normal,
<a name="l01077"></a>01077         FontStyle_Oblique,
<a name="l01078"></a>01078         FontStyle_Italic
<a name="l01079"></a>01079 };
<a name="l01080"></a>01080 
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 <span class="comment">/*</span>
<a name="l01084"></a>01084 <span class="comment">#ifndef __LERSTAD__</span>
<a name="l01085"></a>01085 <span class="comment"></span>
<a name="l01086"></a>01086 <span class="comment">template&lt;&gt; inline Gui::FontStyle unbox_cast&lt;Gui::FontStyle&gt;(Object* object)</span>
<a name="l01087"></a>01087 <span class="comment">{</span>
<a name="l01088"></a>01088 <span class="comment">        IntObject* value = dynamic_cast&lt;IntObject*&gt;(object);</span>
<a name="l01089"></a>01089 <span class="comment">        if (value == NULL)</span>
<a name="l01090"></a>01090 <span class="comment">        {</span>
<a name="l01091"></a>01091 <span class="comment">                raise(Exception(L&quot;Not IntObject&quot;));</span>
<a name="l01092"></a>01092 <span class="comment">        }</span>
<a name="l01093"></a>01093 <span class="comment">        return (Gui::FontStyle)value-&gt;GetValue();</span>
<a name="l01094"></a>01094 <span class="comment">}</span>
<a name="l01095"></a>01095 <span class="comment"></span>
<a name="l01096"></a>01096 <span class="comment">#endif</span>
<a name="l01097"></a>01097 <span class="comment">*/</span>
<a name="l01098"></a>01098 
<a name="l01099"></a>01099 <span class="keyword">namespace </span>Gui
<a name="l01100"></a>01100 {
<a name="l01101"></a>01101 
<a name="l01102"></a>01102 <span class="keyword">class </span>GUIEXT ColorF
<a name="l01103"></a>01103 {
<a name="l01104"></a>01104 <span class="keyword">public</span>:
<a name="l01105"></a>01105 
<a name="l01106"></a>01106         CTOR ColorF() : r(0), g(0), b(0), a(0)
<a name="l01107"></a>01107         {
<a name="l01108"></a>01108         }
<a name="l01109"></a>01109 
<a name="l01110"></a>01110         CTOR ColorF(<span class="keywordtype">float</span> _r, <span class="keywordtype">float</span> _g, <span class="keywordtype">float</span> _b) : r(_r), g(_g), b(_b), a(1.0f)
<a name="l01111"></a>01111         {
<a name="l01112"></a>01112         }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114         CTOR ColorF(<span class="keywordtype">float</span> _r, <span class="keywordtype">float</span> _g, <span class="keywordtype">float</span> _b, <span class="keywordtype">float</span> _a) : r(_r), g(_g), b(_b), a(_a)
<a name="l01115"></a>01115         {
<a name="l01116"></a>01116         }
<a name="l01117"></a>01117 
<a name="l01118"></a>01118         operator float* ()
<a name="l01119"></a>01119         {
<a name="l01120"></a>01120                 <span class="keywordflow">return</span> &amp;r;
<a name="l01121"></a>01121         }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123         operator const float* ()<span class="keyword"> const</span>
<a name="l01124"></a>01124 <span class="keyword">        </span>{
<a name="l01125"></a>01125                 <span class="keywordflow">return</span> &amp;r;
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128         <span class="keywordtype">float</span>&amp; operator [] (uint index)
<a name="l01129"></a>01129         {
<a name="l01130"></a>01130                 <span class="keywordflow">if</span> (index &gt;= 4) <span class="keyword">raise</span>(ArgumentOutOfRangeException());
<a name="l01131"></a>01131                 <span class="keywordflow">return</span> (&amp;r)[index];
<a name="l01132"></a>01132         }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134         <span class="keywordtype">float</span> operator [] (uint index)<span class="keyword"> const</span>
<a name="l01135"></a>01135 <span class="keyword">        </span>{
<a name="l01136"></a>01136                 <span class="keywordflow">if</span> (index &gt;= 4) <span class="keyword">raise</span>(ArgumentOutOfRangeException());
<a name="l01137"></a>01137                 <span class="keywordflow">return</span> (&amp;r)[index];
<a name="l01138"></a>01138         }
<a name="l01139"></a>01139 
<a name="l01140"></a>01140         <span class="keyword">static</span> ColorF FromCOLORREF(COLORREF clr)
<a name="l01141"></a>01141         {
<a name="l01142"></a>01142                 <span class="keywordflow">return</span> ColorF(GetRValue(clr)/255.0f, GetGValue(clr)/255.0f, GetBValue(clr)/255.0f);
<a name="l01143"></a>01143         }
<a name="l01144"></a>01144 
<a name="l01145"></a>01145         operator gm::vector4f()<span class="keyword"> const</span>
<a name="l01146"></a>01146 <span class="keyword">        </span>{
<a name="l01147"></a>01147                 <span class="keywordflow">return</span> gm::vector4f(r, g, b, a);
<a name="l01148"></a>01148         }
<a name="l01149"></a>01149 
<a name="l01150"></a>01150         <span class="keyword">static</span> ColorF Transparent;
<a name="l01151"></a>01151         <span class="keyword">static</span> ColorF Black;
<a name="l01152"></a>01152         <span class="keyword">static</span> ColorF White;
<a name="l01153"></a>01153         <span class="keyword">static</span> ColorF Red;
<a name="l01154"></a>01154         <span class="keyword">static</span> ColorF Green;
<a name="l01155"></a>01155         <span class="keyword">static</span> ColorF Blue;
<a name="l01156"></a>01156         <span class="keyword">static</span> ColorF Yellow;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158         <span class="keywordtype">float</span> r;
<a name="l01159"></a>01159         <span class="keywordtype">float</span> g;
<a name="l01160"></a>01160         <span class="keywordtype">float</span> b;
<a name="l01161"></a>01161         <span class="keywordtype">float</span> a;
<a name="l01162"></a>01162 };
<a name="l01163"></a>01163 
<a name="l01164"></a>01164 <span class="keyword">interface </span>IEffect
<a name="l01165"></a>01165 {
<a name="l01166"></a>01166         <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> GetInputCount() = 0;
<a name="l01167"></a>01167         <span class="keyword">virtual</span> IEffect* GetInput(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index) = 0;
<a name="l01168"></a>01168         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetInput(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index, IEffect* input) = 0;
<a name="l01169"></a>01169         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderOutput(RenderContext* renderContext) = 0;
<a name="l01170"></a>01170 <span class="comment">//      virtual void RenderOutputNormalMap(RenderTarget* rt) = 0;</span>
<a name="l01171"></a>01171         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(RenderContext* renderContext, gm::RectF destRect, <span class="keyword">const</span> gm::matrix4f&amp; modelView, <span class="keyword">const</span> gm::matrix4f&amp; projection) = 0;
<a name="l01172"></a>01172         <span class="keyword">virtual</span> Graphics::Bitmap* GetOutputBitmap() = 0;
<a name="l01173"></a>01173         <span class="keyword">virtual</span> Graphics::Bitmap* GetOutputNormalMap() = 0;
<a name="l01174"></a>01174 };
<a name="l01175"></a>01175 
<a name="l01176"></a>01176 <span class="keyword">class </span>GUIEXT CEffect : <span class="keyword">public</span> Object, <span class="keyword">public</span> IEffect
<a name="l01177"></a>01177 {
<a name="l01178"></a>01178 <span class="keyword">protected</span>:
<a name="l01179"></a>01179 
<a name="l01180"></a>01180         CTOR CEffect(); <span class="comment">// protected, this class can&#39;t be created directly, must derive from it</span>
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 <span class="keyword">public</span>:
<a name="l01183"></a>01183 
<a name="l01184"></a>01184         <span class="keyword">virtual</span> ~CEffect();
<a name="l01185"></a>01185 
<a name="l01186"></a>01186         <span class="comment">/*</span>
<a name="l01187"></a>01187 <span class="comment">        virtual unsigned int GetInputCount() = 0;</span>
<a name="l01188"></a>01188 <span class="comment">        virtual CEffect* GetInput(unsigned int index) = 0;</span>
<a name="l01189"></a>01189 <span class="comment">        virtual void Render(LDraw::GraphicsO* pGraphics, LDraw::RectF destRect, const LDraw::matrix4f&amp; modelView, const LDraw::matrix4f&amp; projection) = 0;</span>
<a name="l01190"></a>01190 <span class="comment">        */</span>
<a name="l01191"></a>01191 
<a name="l01192"></a>01192         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderOutput(Gui::RenderContext* rt);
<a name="l01193"></a>01193 <span class="preprocessor">#if 0</span>
<a name="l01194"></a>01194 <span class="preprocessor"></span>        <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderOutputNormalMap(RenderTarget* rt);
<a name="l01195"></a>01195 <span class="preprocessor">#endif</span>
<a name="l01196"></a>01196 <span class="preprocessor"></span>
<a name="l01197"></a>01197         <span class="keyword">virtual</span> Graphics::Bitmap* GetOutputBitmap()
<a name="l01198"></a>01198         {
<a name="l01199"></a>01199                 <span class="keywordflow">return</span> m_outImage;
<a name="l01200"></a>01200         }
<a name="l01201"></a>01201 
<a name="l01202"></a>01202         <span class="keyword">virtual</span> Graphics::Bitmap* GetOutputNormalMap()
<a name="l01203"></a>01203         {
<a name="l01204"></a>01204                 <span class="keywordflow">return</span> m_outNormalMap;
<a name="l01205"></a>01205         }
<a name="l01206"></a>01206 
<a name="l01207"></a>01207 <span class="keyword">protected</span>:
<a name="l01208"></a>01208 
<a name="l01209"></a>01209         <span class="keywordtype">void</span> DrawBitmap(RenderContext* renderContext, gm::RectF destRect);
<a name="l01210"></a>01210 
<a name="l01211"></a>01211 <span class="keyword">public</span>:
<a name="l01212"></a>01212         gm::RectF m_subRegion;
<a name="l01213"></a>01213         Graphics::Bitmap* m_outImage;
<a name="l01214"></a>01214         Graphics::Bitmap* m_outNormalMap;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216         <span class="keywordtype">int</span> m_scaledWidth;
<a name="l01217"></a>01217         <span class="keywordtype">int</span> m_scaledHeight;
<a name="l01218"></a>01218 };
<a name="l01219"></a>01219 
<a name="l01220"></a>01220 <span class="keyword">class </span>GUIEXT AlphaChannelEffect : <span class="keyword">public</span> CEffect
<a name="l01221"></a>01221 {
<a name="l01222"></a>01222 <span class="keyword">public</span>:
<a name="l01223"></a>01223 };
<a name="l01224"></a>01224 
<a name="l01225"></a>01225 <span class="keyword">class </span>GUIEXT VisualEffect : <span class="keyword">public</span> CEffect
<a name="l01226"></a>01226 {
<a name="l01227"></a>01227 <span class="keyword">public</span>:
<a name="l01228"></a>01228         CTOR VisualEffect()
<a name="l01229"></a>01229         {
<a name="l01230"></a>01230         }
<a name="l01231"></a>01231 
<a name="l01232"></a>01232         CTOR VisualEffect(Visual* visual) : m_visual(visual)
<a name="l01233"></a>01233         {
<a name="l01234"></a>01234         }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderOutput(RenderTarget* rt);
<a name="l01237"></a>01237         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(RenderTarget* rt, gm::RectF destRect, <span class="keyword">const</span> gm::matrix4f&amp; modelView, <span class="keyword">const</span> gm::matrix4f&amp; projection)
<a name="l01238"></a>01238         {
<a name="l01239"></a>01239                 ASSERT(0);
<a name="l01240"></a>01240         }
<a name="l01241"></a>01241 
<a name="l01242"></a>01242         <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> GetInputCount()
<a name="l01243"></a>01243         {
<a name="l01244"></a>01244                 <span class="keywordflow">return</span> 0;
<a name="l01245"></a>01245         }
<a name="l01246"></a>01246 
<a name="l01247"></a>01247         <span class="keyword">virtual</span> IEffect* GetInput(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index)
<a name="l01248"></a>01248         {
<a name="l01249"></a>01249                 <span class="keywordflow">return</span> NULL;
<a name="l01250"></a>01250         }
<a name="l01251"></a>01251 
<a name="l01252"></a>01252         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetInput(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index, IEffect* input)
<a name="l01253"></a>01253         {
<a name="l01254"></a>01254                 <span class="keyword">raise</span>(Exception(<span class="stringliteral">&quot;Doesn&#39;t take any inputs&quot;</span>));
<a name="l01255"></a>01255         }
<a name="l01256"></a>01256 
<a name="l01257"></a>01257         Visual* m_visual;
<a name="l01258"></a>01258 };
<a name="l01259"></a>01259 
<a name="l01260"></a>01260 }
<a name="l01261"></a>01261 }
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 <span class="preprocessor">#include &quot;GaussianBlurEffect.h&quot;</span>
<a name="l01264"></a>01264 
<a name="l01265"></a>01265 <span class="keyword">namespace </span>System
<a name="l01266"></a>01266 {
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 <span class="keyword">namespace </span>Gui
<a name="l01269"></a>01269 {
<a name="l01270"></a>01270 
<a name="l01271"></a>01271 <span class="keyword">typedef</span> gm::vector2f Vec2f;
<a name="l01272"></a>01272 <span class="keyword">typedef</span> gm::vector3f Vec3f;
<a name="l01273"></a>01273 <span class="keyword">typedef</span> gm::vector4f Vec4f;
<a name="l01274"></a>01274 
<a name="l01275"></a>01275 <span class="keyword">class </span>GUIEXT Effect : <span class="keyword">public</span> Object
<a name="l01276"></a>01276 {
<a name="l01277"></a>01277 <span class="keyword">public</span>:
<a name="l01278"></a>01278 
<a name="l01279"></a>01279         CTOR Effect(IEffect* root) : m_root(root)
<a name="l01280"></a>01280         {
<a name="l01281"></a>01281         }
<a name="l01282"></a>01282 
<a name="l01283"></a>01283         IEffect* m_root;
<a name="l01284"></a>01284 };
<a name="l01285"></a>01285 
<a name="l01286"></a>01286 <span class="preprocessor">#if 0</span>
<a name="l01287"></a>01287 <span class="preprocessor"></span><span class="keyword">class </span>Property
<a name="l01288"></a>01288 {
<a name="l01289"></a>01289 <span class="keyword">public</span>:
<a name="l01290"></a>01290 };
<a name="l01291"></a>01291 
<a name="l01292"></a>01292 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TYPE&gt; <span class="keyword">class </span>PropertyT : <span class="keyword">public</span> Property
<a name="l01293"></a>01293 {
<a name="l01294"></a>01294 <span class="keyword">public</span>:
<a name="l01295"></a>01295 
<a name="l01296"></a>01296         TYPE GetValue();
<a name="l01297"></a>01297 };
<a name="l01298"></a>01298 
<a name="l01299"></a>01299 <span class="keyword">class </span>GUIEXT PropertyMetadata : <span class="keyword">public</span> Object
<a name="l01300"></a>01300 {
<a name="l01301"></a>01301 <span class="keyword">public</span>:
<a name="l01302"></a>01302 };
<a name="l01303"></a>01303 <span class="preprocessor">#endif</span>
<a name="l01304"></a>01304 <span class="preprocessor"></span>
<a name="l01305"></a>01305 <span class="keyword">class </span>GUIEXT PropertyMetadata : <span class="keyword">public</span> Object
<a name="l01306"></a>01306 {
<a name="l01307"></a>01307 <span class="keyword">public</span>:
<a name="l01308"></a>01308 
<a name="l01309"></a>01309         CTOR PropertyMetadata() :
<a name="l01310"></a>01310                 m_notifyOnValueChange(false)
<a name="l01311"></a>01311         {
<a name="l01312"></a>01312         }
<a name="l01313"></a>01313 
<a name="l01314"></a>01314         CTOR PropertyMetadata(<span class="keywordtype">bool</span> notifyOnValueChange) :
<a name="l01315"></a>01315                 m_notifyOnValueChange(notifyOnValueChange)
<a name="l01316"></a>01316         {
<a name="l01317"></a>01317         }
<a name="l01318"></a>01318 
<a name="l01319"></a>01319         <span class="keywordtype">bool</span> m_notifyOnValueChange;
<a name="l01320"></a>01320 };
<a name="l01321"></a>01321 
<a name="l01322"></a>01322 }
<a name="l01323"></a>01323 }
<a name="l01324"></a>01324 
<a name="l01325"></a>01325 <span class="preprocessor">#include &quot;DependencyClass.h&quot;</span>
<a name="l01326"></a>01326 <span class="preprocessor">#include &quot;DependencyProperty.h&quot;</span>
<a name="l01327"></a>01327 
<a name="l01328"></a>01328 <span class="keyword">namespace </span>System
<a name="l01329"></a>01329 {
<a name="l01330"></a>01330 <span class="keyword">namespace </span>Gui
<a name="l01331"></a>01331 {
<a name="l01332"></a>01332 
<a name="l01333"></a>01333 <span class="comment">/*</span>
<a name="l01334"></a>01334 <span class="comment">class RoutedEvent : public Object</span>
<a name="l01335"></a>01335 <span class="comment">{</span>
<a name="l01336"></a>01336 <span class="comment">public:</span>
<a name="l01337"></a>01337 <span class="comment">        CTOR RoutedEvent(Type_Info&amp; handlerType, Type_Info&amp; ownerType) : m_handlerType(handlerType), m_ownerType(ownerType)</span>
<a name="l01338"></a>01338 <span class="comment">        {</span>
<a name="l01339"></a>01339 <span class="comment">        }</span>
<a name="l01340"></a>01340 <span class="comment"></span>
<a name="l01341"></a>01341 <span class="comment">        const Type_Info&amp; m_handlerType;</span>
<a name="l01342"></a>01342 <span class="comment">        const Type_Info&amp; m_ownerType;</span>
<a name="l01343"></a>01343 <span class="comment"></span>
<a name="l01344"></a>01344 <span class="comment">        int m_index;</span>
<a name="l01345"></a>01345 <span class="comment">};</span>
<a name="l01346"></a>01346 <span class="comment">*/</span>
<a name="l01347"></a>01347 
<a name="l01348"></a>01348 <span class="comment">/*</span>
<a name="l01349"></a>01349 <span class="comment">class GUIEXT RoutedEventManager</span>
<a name="l01350"></a>01350 <span class="comment">{</span>
<a name="l01351"></a>01351 <span class="comment">public:</span>
<a name="l01352"></a>01352 <span class="comment"></span>
<a name="l01353"></a>01353 <span class="comment">        static RoutedEvent* RegisterRoutedEvent(StringW* name, const Type_Info&amp; handlerType, const Type_Info&amp; ownerType);</span>
<a name="l01354"></a>01354 <span class="comment"></span>
<a name="l01355"></a>01355 <span class="comment">        class PerClass</span>
<a name="l01356"></a>01356 <span class="comment">        {</span>
<a name="l01357"></a>01357 <span class="comment">        };</span>
<a name="l01358"></a>01358 <span class="comment"></span>
<a name="l01359"></a>01359 <span class="comment">private:</span>
<a name="l01360"></a>01360 <span class="comment">        CTOR RoutedEventManager();</span>
<a name="l01361"></a>01361 <span class="comment">};</span>
<a name="l01362"></a>01362 <span class="comment">*/</span>
<a name="l01363"></a>01363 
<a name="l01364"></a>01364 <span class="comment">/*</span>
<a name="l01365"></a>01365 <span class="comment">class GUIEXT InputEventArgs : public RoutedEventArgs</span>
<a name="l01366"></a>01366 <span class="comment">{</span>
<a name="l01367"></a>01367 <span class="comment">public:</span>
<a name="l01368"></a>01368 <span class="comment">        Window* m_window;</span>
<a name="l01369"></a>01369 <span class="comment">        double m_time;</span>
<a name="l01370"></a>01370 <span class="comment">};</span>
<a name="l01371"></a>01371 <span class="comment"></span>
<a name="l01372"></a>01372 <span class="comment">class GUIEXT MouseEventArgs : public InputEventArgs</span>
<a name="l01373"></a>01373 <span class="comment">{</span>
<a name="l01374"></a>01374 <span class="comment">public:</span>
<a name="l01375"></a>01375 <span class="comment">        LDraw::PointF m_screenPos;</span>
<a name="l01376"></a>01376 <span class="comment">        LDraw::PointF m_windowPos;</span>
<a name="l01377"></a>01377 <span class="comment">        //LDraw::PointF m_localPos;</span>
<a name="l01378"></a>01378 <span class="comment"></span>
<a name="l01379"></a>01379 <span class="comment">        LDraw::PointF GetLocalPoint(Visual* visual);</span>
<a name="l01380"></a>01380 <span class="comment">};</span>
<a name="l01381"></a>01381 <span class="comment">*/</span>
<a name="l01382"></a>01382 
<a name="l01383"></a>01383 <span class="comment">/*</span>
<a name="l01384"></a>01384 <span class="comment">class ObjectProperty</span>
<a name="l01385"></a>01385 <span class="comment">{</span>
<a name="l01386"></a>01386 <span class="comment">public:</span>
<a name="l01387"></a>01387 <span class="comment">        Object* m_object;</span>
<a name="l01388"></a>01388 <span class="comment">        Property* m_property;</span>
<a name="l01389"></a>01389 <span class="comment">};</span>
<a name="l01390"></a>01390 <span class="comment">*/</span>
<a name="l01391"></a>01391 
<a name="l01392"></a>01392 <span class="keyword">interface </span>IBinding;
<a name="l01393"></a>01393 
<a name="l01394"></a>01394 <span class="keyword">interface </span>IInputBinding
<a name="l01395"></a>01395 {
<a name="l01396"></a>01396         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetInput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) = 0;
<a name="l01397"></a>01397 <span class="comment">//      virtual Type* GetInputType() = 0;</span>
<a name="l01398"></a>01398 };
<a name="l01399"></a>01399 
<a name="l01400"></a>01400 <span class="keyword">interface </span>IBinding : <span class="keyword">public</span> IInputBinding
<a name="l01401"></a>01401 {
<a name="l01402"></a>01402         <span class="keyword">virtual</span> Variant GetOutput(IBinding* caller) = 0;
<a name="l01403"></a>01403         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) = 0;
<a name="l01404"></a>01404 
<a name="l01405"></a>01405         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keywordtype">bool</span> value)
<a name="l01406"></a>01406         {
<a name="l01407"></a>01407                 <span class="keywordflow">return</span> SetOutput(caller, Variant(value));
<a name="l01408"></a>01408         }
<a name="l01409"></a>01409 
<a name="l01410"></a>01410         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keywordtype">int</span> value)
<a name="l01411"></a>01411         {
<a name="l01412"></a>01412                 <span class="keywordflow">return</span> SetOutput(caller, Variant(value));
<a name="l01413"></a>01413         }
<a name="l01414"></a>01414 
<a name="l01415"></a>01415         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keywordtype">float</span> value)
<a name="l01416"></a>01416         {
<a name="l01417"></a>01417                 <span class="keywordflow">return</span> SetOutput(caller, Variant(value));
<a name="l01418"></a>01418         }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keywordtype">double</span> value)
<a name="l01421"></a>01421         {
<a name="l01422"></a>01422                 <span class="keywordflow">return</span> SetOutput(caller, Variant(value));
<a name="l01423"></a>01423         }
<a name="l01424"></a>01424 
<a name="l01425"></a>01425         <span class="keyword">virtual</span> Type* GetOutputType() = 0;
<a name="l01426"></a>01426 <span class="comment">//      virtual Type* GetInputType() = 0;</span>
<a name="l01427"></a>01427 
<a name="l01428"></a>01428         <span class="keyword">virtual</span> <span class="keywordtype">void</span>* Connect(IInputBinding* binding) = 0;
<a name="l01429"></a>01429 };
<a name="l01430"></a>01430 
<a name="l01431"></a>01431 <span class="keyword">class </span>GUIEXT PropertyValueConstraint : <span class="keyword">public</span> Object
<a name="l01432"></a>01432 {
<a name="l01433"></a>01433 <span class="keyword">public</span>:
<a name="l01434"></a>01434         <span class="keyword">virtual</span> Object* Constrain(Object* val) = 0;
<a name="l01435"></a>01435 };
<a name="l01436"></a>01436 
<a name="l01437"></a>01437 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>PropertyValueMinConstraint : <span class="keyword">public</span> PropertyValueConstraint
<a name="l01438"></a>01438 {
<a name="l01439"></a>01439 <span class="keyword">public</span>:
<a name="l01440"></a>01440 
<a name="l01441"></a>01441         CTOR PropertyValueMinConstraint(T minVal) : m_minVal(minVal)
<a name="l01442"></a>01442         {
<a name="l01443"></a>01443         }
<a name="l01444"></a>01444 
<a name="l01445"></a>01445         <span class="keyword">virtual</span> Object* Constrain(Object* val)
<a name="l01446"></a>01446         {
<a name="l01447"></a>01447                 <span class="keywordflow">return</span> NULL;
<a name="l01448"></a>01448         }
<a name="l01449"></a>01449 
<a name="l01450"></a>01450         T Constrain(T val)
<a name="l01451"></a>01451         {
<a name="l01452"></a>01452                 <span class="keywordflow">if</span> (val &lt; m_minVal)
<a name="l01453"></a>01453                 {
<a name="l01454"></a>01454                         <span class="keywordflow">return</span> m_minVal;
<a name="l01455"></a>01455                 }
<a name="l01456"></a>01456                 <span class="keywordflow">return</span> val;
<a name="l01457"></a>01457         }
<a name="l01458"></a>01458 
<a name="l01459"></a>01459         T m_minVal;
<a name="l01460"></a>01460 };
<a name="l01461"></a>01461 
<a name="l01462"></a>01462 <span class="keyword">template</span>&lt;<span class="keyword">class</span> type_t&gt;
<a name="l01463"></a>01463 <span class="keyword">class </span>typed
<a name="l01464"></a>01464 {
<a name="l01465"></a>01465 <span class="keyword">public</span>:
<a name="l01466"></a>01466 
<a name="l01467"></a>01467 <span class="comment">/*</span>
<a name="l01468"></a>01468 <span class="comment">        CTOR typed(bool const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01469"></a>01469 <span class="comment">        {</span>
<a name="l01470"></a>01470 <span class="comment">        }</span>
<a name="l01471"></a>01471 <span class="comment"></span>
<a name="l01472"></a>01472 <span class="comment">        CTOR typed(unsigned char const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01473"></a>01473 <span class="comment">        {</span>
<a name="l01474"></a>01474 <span class="comment">        }</span>
<a name="l01475"></a>01475 <span class="comment"></span>
<a name="l01476"></a>01476 <span class="comment">        CTOR typed(int const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01477"></a>01477 <span class="comment">        {</span>
<a name="l01478"></a>01478 <span class="comment">        }</span>
<a name="l01479"></a>01479 <span class="comment"></span>
<a name="l01480"></a>01480 <span class="comment">        CTOR typed(long const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01481"></a>01481 <span class="comment">        {</span>
<a name="l01482"></a>01482 <span class="comment">        }</span>
<a name="l01483"></a>01483 <span class="comment"></span>
<a name="l01484"></a>01484 <span class="comment">        CTOR typed(float const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01485"></a>01485 <span class="comment">        {</span>
<a name="l01486"></a>01486 <span class="comment">        }</span>
<a name="l01487"></a>01487 <span class="comment"></span>
<a name="l01488"></a>01488 <span class="comment"></span>
<a name="l01489"></a>01489 <span class="comment">        CTOR typed(double const_value) : m_const_value(const_value), m_exp(NULL), m_binding(NULL)</span>
<a name="l01490"></a>01490 <span class="comment">        {</span>
<a name="l01491"></a>01491 <span class="comment">        }</span>
<a name="l01492"></a>01492 <span class="comment">*/</span>
<a name="l01493"></a>01493 
<a name="l01494"></a>01494         <span class="comment">/*</span>
<a name="l01495"></a>01495 <span class="comment">        CTOR typed(Expressive::Expression* exp) : m_exp(exp), m_binding(NULL)</span>
<a name="l01496"></a>01496 <span class="comment">        {</span>
<a name="l01497"></a>01497 <span class="comment">        }</span>
<a name="l01498"></a>01498 <span class="comment">        */</span>
<a name="l01499"></a>01499 
<a name="l01500"></a>01500 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l01501"></a>01501 <span class="preprocessor"></span>        <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l01502"></a>01502         CTOR typed(<span class="keyword">const</span> Expressive::typed_expression&lt;T&gt;&amp; exp) : m_exp(Expressive::cast&lt;type_t&gt;(exp)), m_binding(NULL)
<a name="l01503"></a>01503         {
<a name="l01504"></a>01504         }
<a name="l01505"></a>01505 <span class="comment">/*</span>
<a name="l01506"></a>01506 <span class="comment">        CTOR typed(const Expressive::typed_expression&lt;int&gt;&amp; exp) : m_exp(Expressive::cast&lt;type_t&gt;(exp)), m_binding(NULL)</span>
<a name="l01507"></a>01507 <span class="comment">        {</span>
<a name="l01508"></a>01508 <span class="comment">        }</span>
<a name="l01509"></a>01509 <span class="comment"></span>
<a name="l01510"></a>01510 <span class="comment">        CTOR typed(const Expressive::typed_expression&lt;float&gt;&amp; exp) : m_exp(Expressive::cast&lt;type_t&gt;(exp)), m_binding(NULL)</span>
<a name="l01511"></a>01511 <span class="comment">        {</span>
<a name="l01512"></a>01512 <span class="comment">        }</span>
<a name="l01513"></a>01513 <span class="comment"></span>
<a name="l01514"></a>01514 <span class="comment">        CTOR typed(const Expressive::typed_expression&lt;double&gt;&amp; exp) : m_exp(Expressive::cast&lt;type_t&gt;(exp)), m_binding(NULL)</span>
<a name="l01515"></a>01515 <span class="comment">        {</span>
<a name="l01516"></a>01516 <span class="comment">        }</span>
<a name="l01517"></a>01517 <span class="comment"></span>
<a name="l01518"></a>01518 <span class="comment">        CTOR typed(const Expressive::typed_expression&lt;double&gt;&amp; exp) : m_exp(Expressive::cast&lt;type_t&gt;(exp)), m_binding(NULL)</span>
<a name="l01519"></a>01519 <span class="comment">        {</span>
<a name="l01520"></a>01520 <span class="comment">        }</span>
<a name="l01521"></a>01521 <span class="comment">        */</span>
<a name="l01522"></a>01522 <span class="preprocessor">#endif</span>
<a name="l01523"></a>01523 <span class="preprocessor"></span>
<a name="l01524"></a>01524         <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l01525"></a>01525         CTOR typed(T const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)
<a name="l01526"></a>01526         {
<a name="l01527"></a>01527         }
<a name="l01528"></a>01528 <span class="comment">/*</span>
<a name="l01529"></a>01529 <span class="comment">        CTOR typed(type_t const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01530"></a>01530 <span class="comment">        {</span>
<a name="l01531"></a>01531 <span class="comment">        }</span>
<a name="l01532"></a>01532 <span class="comment">*/</span>
<a name="l01533"></a>01533         <span class="comment">/*</span>
<a name="l01534"></a>01534 <span class="comment">        CTOR typed(int const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01535"></a>01535 <span class="comment">        {</span>
<a name="l01536"></a>01536 <span class="comment">        }</span>
<a name="l01537"></a>01537 <span class="comment"></span>
<a name="l01538"></a>01538 <span class="comment">        CTOR typed(float const_value) : m_const_value(type_t(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01539"></a>01539 <span class="comment">        {</span>
<a name="l01540"></a>01540 <span class="comment">        }</span>
<a name="l01541"></a>01541 <span class="comment"></span>
<a name="l01542"></a>01542 <span class="comment">        CTOR typed(Object* const_value) : m_const_value(unbox_cast&lt;type_t&gt;(const_value)), m_exp(NULL), m_binding(NULL)</span>
<a name="l01543"></a>01543 <span class="comment">        {</span>
<a name="l01544"></a>01544 <span class="comment">        }</span>
<a name="l01545"></a>01545 <span class="comment">        */</span>
<a name="l01546"></a>01546 
<a name="l01547"></a>01547         CTOR typed(IBinding* binding) : m_exp(nullptr), m_binding(binding)
<a name="l01548"></a>01548         {
<a name="l01549"></a>01549         }
<a name="l01550"></a>01550 
<a name="l01551"></a>01551         CTOR typed(PropertyValue* binding) : m_exp(nullptr), m_binding(binding)
<a name="l01552"></a>01552         {
<a name="l01553"></a>01553         }
<a name="l01554"></a>01554 
<a name="l01555"></a>01555         <span class="keywordtype">bool</span> hasBinding()<span class="keyword"> const</span>
<a name="l01556"></a>01556 <span class="keyword">        </span>{
<a name="l01557"></a>01557                 <span class="keywordflow">if</span> (m_exp != <span class="keyword">nullptr</span> || m_binding != <span class="keyword">nullptr</span>)
<a name="l01558"></a>01558                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01559"></a>01559                 <span class="keywordflow">else</span>
<a name="l01560"></a>01560                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01561"></a>01561         }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563         IBinding* binding(DependencyObject* _this) <span class="keyword">const</span>;
<a name="l01564"></a>01564 
<a name="l01565"></a>01565 
<a name="l01566"></a>01566         <span class="comment">/*</span>
<a name="l01567"></a>01567 <span class="comment">        operator Object* () const</span>
<a name="l01568"></a>01568 <span class="comment">        {</span>
<a name="l01569"></a>01569 <span class="comment">                return box_cast&lt;type_t&gt;(m_const_value);</span>
<a name="l01570"></a>01570 <span class="comment">        }</span>
<a name="l01571"></a>01571 <span class="comment">        */</span>
<a name="l01572"></a>01572 
<a name="l01573"></a>01573         operator type_t ()<span class="keyword"> const</span>
<a name="l01574"></a>01574 <span class="keyword">        </span>{
<a name="l01575"></a>01575                 <span class="comment">// TODO, evaluate exp if != NULL</span>
<a name="l01576"></a>01576                 ASSERT(m_exp == <span class="keyword">nullptr</span>);
<a name="l01577"></a>01577                 ASSERT(m_binding == <span class="keyword">nullptr</span>);
<a name="l01578"></a>01578 
<a name="l01579"></a>01579                 <span class="keywordflow">return</span> m_const_value;
<a name="l01580"></a>01580         }
<a name="l01581"></a>01581 
<a name="l01582"></a>01582         Expressive::Expression* m_exp;
<a name="l01583"></a>01583         IBinding* m_binding;
<a name="l01584"></a>01584         type_t m_const_value;
<a name="l01585"></a>01585 };
<a name="l01586"></a>01586 
<a name="l01587"></a>01587 <span class="keyword">class </span>GUIEXT BindingExpression : <span class="keyword">public</span> Expressive::Expression, <span class="keyword">public</span> IInputBinding
<a name="l01588"></a>01588 {
<a name="l01589"></a>01589 <span class="keyword">public</span>:
<a name="l01590"></a>01590         CTOR BindingExpression(IBinding* binding);
<a name="l01591"></a>01591 
<a name="l01592"></a>01592         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetInput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) <span class="keyword">override</span>;  <span class="comment">// IInputBinding</span>
<a name="l01593"></a>01593 <span class="comment">//      virtual int SetInput(IBinding* caller, int value) override;     // IInputBinding</span>
<a name="l01594"></a>01594 
<a name="l01595"></a>01595         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Set(Expressive::EvalContext* context, <span class="keyword">const</span> Variant&amp; value)<span class="keyword"> override</span>
<a name="l01596"></a>01596 <span class="keyword">        </span>{
<a name="l01597"></a>01597                 m_binding-&gt;SetOutput(<span class="keyword">nullptr</span>, value);
<a name="l01598"></a>01598                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01599"></a>01599         }
<a name="l01600"></a>01600 
<a name="l01601"></a>01601         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Set(Expressive::EvalContext* context, <span class="keywordtype">bool</span> value)<span class="keyword"> override</span>
<a name="l01602"></a>01602 <span class="keyword">        </span>{
<a name="l01603"></a>01603                 m_binding-&gt;SetOutput(<span class="keyword">nullptr</span>, value);
<a name="l01604"></a>01604                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01605"></a>01605         }
<a name="l01606"></a>01606 
<a name="l01607"></a>01607         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Set(Expressive::EvalContext* context, <span class="keywordtype">int</span> value)<span class="keyword"> override</span>
<a name="l01608"></a>01608 <span class="keyword">        </span>{
<a name="l01609"></a>01609                 m_binding-&gt;SetOutput(<span class="keyword">nullptr</span>, value);
<a name="l01610"></a>01610                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01611"></a>01611         }
<a name="l01612"></a>01612 
<a name="l01613"></a>01613         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Set(Expressive::EvalContext* context, <span class="keywordtype">float</span> value)<span class="keyword"> override</span>
<a name="l01614"></a>01614 <span class="keyword">        </span>{
<a name="l01615"></a>01615                 m_binding-&gt;SetOutput(<span class="keyword">nullptr</span>, value);
<a name="l01616"></a>01616                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01617"></a>01617         }
<a name="l01618"></a>01618 
<a name="l01619"></a>01619         <span class="keyword">virtual</span> Variant Evaluate(Expressive::EvalContext* context) <span class="keyword">override</span>;
<a name="l01620"></a>01620         <span class="keyword">virtual</span> <span class="keywordtype">void</span> TraceCallback(Expressive::EvalContext* context, Expressive::ExpTrace&amp; trace, Expressive::ITraceCallback* callback) <span class="keyword">override</span>;
<a name="l01621"></a>01621 
<a name="l01622"></a>01622         IBinding* m_binding;
<a name="l01623"></a>01623         <span class="keywordtype">void</span>* m_ptr;
<a name="l01624"></a>01624 
<a name="l01625"></a>01625         ExpressionBinding* m_ownerBinding;
<a name="l01626"></a>01626         <span class="keywordtype">bool</span> m_setting;
<a name="l01627"></a>01627 };
<a name="l01628"></a>01628 
<a name="l01629"></a>01629 }       <span class="comment">// Gui</span>
<a name="l01630"></a>01630 }       <span class="comment">// System</span>
<a name="l01631"></a>01631 
<a name="l01632"></a>01632 <span class="preprocessor">#include &quot;PropertyValue.h&quot;</span>
<a name="l01633"></a>01633 
<a name="l01634"></a>01634 <span class="keyword">namespace </span>System
<a name="l01635"></a>01635 {
<a name="l01636"></a>01636 <span class="keyword">namespace </span>Gui
<a name="l01637"></a>01637 {
<a name="l01638"></a>01638 
<a name="l01639"></a>01639 <span class="preprocessor">#if 0</span>
<a name="l01640"></a>01640 <span class="preprocessor"></span><span class="comment">// 1 input, many outputs</span>
<a name="l01641"></a>01641 <span class="keyword">class </span>GUIEXT PropertyValueBase : <span class="keyword">public</span> IInOutBinding
<a name="l01642"></a>01642 {
<a name="l01643"></a>01643 <span class="keyword">public</span>:
<a name="l01644"></a>01644 };
<a name="l01645"></a>01645 
<a name="l01646"></a>01646 <span class="keyword">class </span>GUIEXT PropertyValue : <span class="keyword">public</span> PropertyValueBase
<a name="l01647"></a>01647 {
<a name="l01648"></a>01648 <span class="keyword">public</span>:
<a name="l01649"></a>01649 
<a name="l01650"></a>01650         CTOR PropertyValue();
<a name="l01651"></a>01651 
<a name="l01652"></a>01652         StringW* get_Name()
<a name="l01653"></a>01653         {
<a name="l01654"></a>01654                 <span class="keywordflow">return</span> GetDependencyProperty()-&gt;get_Name();
<a name="l01655"></a>01655         }
<a name="l01656"></a>01656 
<a name="l01657"></a>01657         <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; GetPropertyType() <span class="keyword">const</span> = 0;
<a name="l01658"></a>01658         <span class="keyword">virtual</span> DependencyProperty* GetDependencyProperty() = 0;
<a name="l01659"></a>01659         <span class="keyword">virtual</span> DependencyObject* GetContainer() = 0;
<a name="l01660"></a>01660 
<a name="l01661"></a>01661         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetLocalObjectValue(Object* value) = 0;
<a name="l01662"></a>01662         <span class="keyword">virtual</span> Object* GetLocalObjectValue() = 0;
<a name="l01663"></a>01663         <span class="keyword">virtual</span> Object* GetComputedObjectValue() = 0;
<a name="l01664"></a>01664 
<a name="l01665"></a>01665         <span class="keyword">virtual</span> Object* GetUpStream(IInOutBinding* caller);     <span class="comment">// Called on upstream</span>
<a name="l01666"></a>01666         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetUpStream(IInOutBinding* caller, Object* value);  <span class="comment">// Called on upstream</span>
<a name="l01667"></a>01667         <span class="keyword">virtual</span> <span class="keywordtype">int</span> IncomingObjectValue(IOutBinding* caller, Object* value);    <span class="comment">// Called on downstream</span>
<a name="l01668"></a>01668         <span class="keyword">virtual</span> <span class="keywordtype">void</span>* Connect(IInOutBinding* binding);
<a name="l01669"></a>01669 
<a name="l01670"></a>01670         <span class="keywordtype">void</span> UpdateObjectValue(Object* value);
<a name="l01671"></a>01671 
<a name="l01672"></a>01672         <span class="keyword">static</span> Object UnsetValue;
<a name="l01673"></a>01673 
<a name="l01674"></a>01674 };
<a name="l01675"></a>01675 
<a name="l01676"></a>01676 <span class="keyword">class </span>GUIEXT PropertyValue2 : <span class="keyword">public</span> PropertyValue
<a name="l01677"></a>01677 {
<a name="l01678"></a>01678 <span class="keyword">public</span>:
<a name="l01679"></a>01679 
<a name="l01680"></a>01680         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetLocalObjectValue(Object* value);
<a name="l01681"></a>01681         <span class="keyword">virtual</span> Object* GetLocalObjectValue();
<a name="l01682"></a>01682         <span class="keyword">virtual</span> Object* GetComputedObjectValue();
<a name="l01683"></a>01683 
<a name="l01684"></a>01684         <span class="keywordtype">void</span> SetIn(IOutBinding* inBinding);
<a name="l01685"></a>01685 
<a name="l01686"></a>01686 <span class="keyword">protected</span>:
<a name="l01687"></a>01687 
<a name="l01688"></a>01688         IOutBinding* m_inBinding;
<a name="l01689"></a>01689         <span class="keywordtype">void</span>* m_inBindingPtr;
<a name="l01690"></a>01690         list&lt;IInOutBinding*&gt; m_outBindings;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692         <span class="keywordtype">int</span> SendComputedValueDownStreamExcept(IInOutBinding* exceptThis);
<a name="l01693"></a>01693 
<a name="l01694"></a>01694         <span class="keyword">inline</span> <span class="keywordtype">int</span> SendComputedValueDownStream()
<a name="l01695"></a>01695         {
<a name="l01696"></a>01696                 <span class="keywordflow">return</span> SendComputedValueDownStreamExcept(NULL);
<a name="l01697"></a>01697         }
<a name="l01698"></a>01698 
<a name="l01699"></a>01699 <span class="keyword">private</span>:
<a name="l01700"></a>01700 
<a name="l01701"></a>01701         Object* m_localValue;
<a name="l01702"></a>01702         Object* m_computedValue;
<a name="l01703"></a>01703 };
<a name="l01704"></a>01704 
<a name="l01705"></a>01705 <span class="keyword">class </span>GUIEXT PropertyValueExp : <span class="keyword">public</span> PropertyValue
<a name="l01706"></a>01706 {
<a name="l01707"></a>01707 <span class="keyword">public</span>:
<a name="l01708"></a>01708 
<a name="l01709"></a>01709         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetLocalObjectValue(Object* value);
<a name="l01710"></a>01710         <span class="keyword">virtual</span> Object* GetLocalObjectValue();
<a name="l01711"></a>01711         <span class="keyword">virtual</span> Object* GetComputedObjectValue();
<a name="l01712"></a>01712 };
<a name="l01713"></a>01713 
<a name="l01714"></a>01714 <span class="keyword">template</span>&lt;<span class="keyword">class</span> PropertyType&gt; <span class="keyword">class </span>PropertyValueTBase : <span class="keyword">public</span> PropertyValue2
<a name="l01715"></a>01715 {
<a name="l01716"></a>01716 <span class="keyword">public</span>:
<a name="l01717"></a>01717 
<a name="l01718"></a>01718         CTOR PropertyValueTBase()
<a name="l01719"></a>01719         {
<a name="l01720"></a>01720         }
<a name="l01721"></a>01721 
<a name="l01722"></a>01722         <span class="keyword">typedef</span> PropertyType propertyType_t;
<a name="l01723"></a>01723 
<a name="l01724"></a>01724         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; propertyType()
<a name="l01725"></a>01725         {
<a name="l01726"></a>01726                 <span class="keywordflow">return</span> <span class="keyword">typeid</span>(propertyType_t);
<a name="l01727"></a>01727         }
<a name="l01728"></a>01728 
<a name="l01729"></a>01729         <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; GetPropertyType()<span class="keyword"> const</span>
<a name="l01730"></a>01730 <span class="keyword">        </span>{
<a name="l01731"></a>01731                 <span class="keywordflow">return</span> <span class="keyword">typeid</span>(propertyType_t);
<a name="l01732"></a>01732         }
<a name="l01733"></a>01733 
<a name="l01734"></a>01734         PropertyType GetValue()
<a name="l01735"></a>01735         {
<a name="l01736"></a>01736                 <span class="keywordflow">return</span> unbox_cast&lt;PropertyType&gt;(GetComputedObjectValue());
<a name="l01737"></a>01737         }
<a name="l01738"></a>01738 
<a name="l01739"></a>01739         <span class="keywordtype">void</span> SetValue(PropertyType value)
<a name="l01740"></a>01740         {
<a name="l01741"></a>01741                 SetLocalObjectValue(box_cast(value));
<a name="l01742"></a>01742         }
<a name="l01743"></a>01743 
<a name="l01744"></a>01744         <span class="keywordtype">void</span> UpdateValue(PropertyType value)
<a name="l01745"></a>01745         {
<a name="l01746"></a>01746                 UpdateObjectValue(box_cast(value));
<a name="l01747"></a>01747         }
<a name="l01748"></a>01748 };
<a name="l01749"></a>01749 
<a name="l01750"></a>01750 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ContainerType, <span class="keyword">class</span> PropertyType, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = 0&gt; <span class="keyword">class </span>PropertyValueT : <span class="keyword">public</span> PropertyValueTBase&lt;PropertyType&gt;
<a name="l01751"></a>01751 {
<a name="l01752"></a>01752 <span class="keyword">public</span>:
<a name="l01753"></a>01753         CTOR PropertyValueT()
<a name="l01754"></a>01754         {
<a name="l01755"></a>01755         }
<a name="l01756"></a>01756 
<a name="l01757"></a>01757 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l01758"></a>01758 <span class="preprocessor"></span>        <span class="keyword">friend</span> ContainerType;
<a name="l01759"></a>01759 <span class="preprocessor">#endif</span>
<a name="l01760"></a>01760 <span class="preprocessor"></span>
<a name="l01761"></a>01761         <span class="keyword">typedef</span> ContainerType t_classType;
<a name="l01762"></a>01762 
<a name="l01763"></a>01763         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; GetClassType()
<a name="l01764"></a>01764         {
<a name="l01765"></a>01765                 <span class="keywordflow">return</span> <span class="keyword">typeid</span>(t_classType);
<a name="l01766"></a>01766         }
<a name="l01767"></a>01767 
<a name="l01768"></a>01768         <span class="keyword">virtual</span> DependencyProperty* GetDependencyProperty()
<a name="l01769"></a>01769         {
<a name="l01770"></a>01770                 <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>ContainerType*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;s_Class.GetLocalProperty(index);
<a name="l01771"></a>01771         }
<a name="l01772"></a>01772 
<a name="l01773"></a>01773         <span class="keyword">virtual</span> DependencyObject* GetContainer()
<a name="l01774"></a>01774         {
<a name="l01775"></a>01775                 <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>ContainerType*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);
<a name="l01776"></a>01776         }
<a name="l01777"></a>01777 };
<a name="l01778"></a>01778 <span class="preprocessor">#endif</span>
<a name="l01779"></a>01779 <span class="preprocessor"></span>
<a name="l01780"></a>01780 <span class="comment">/*</span>
<a name="l01781"></a>01781 <span class="comment">class GUIEXT TemplatedOwnerExpression : public Expressive::ObjectExpression</span>
<a name="l01782"></a>01782 <span class="comment">{</span>
<a name="l01783"></a>01783 <span class="comment">public:</span>
<a name="l01784"></a>01784 <span class="comment"></span>
<a name="l01785"></a>01785 <span class="comment">        static TemplatedOwnerExpression only;</span>
<a name="l01786"></a>01786 <span class="comment"></span>
<a name="l01787"></a>01787 <span class="comment">        virtual Object* Evaluate(Expressive::EvalContext* context);</span>
<a name="l01788"></a>01788 <span class="comment">        virtual void TraceCallback(Expressive::EvalContext* context, Expressive::ExpTrace&amp; trace, Expressive::ITraceCallback* callback);</span>
<a name="l01789"></a>01789 <span class="comment"></span>
<a name="l01790"></a>01790 <span class="comment">protected:</span>
<a name="l01791"></a>01791 <span class="comment"></span>
<a name="l01792"></a>01792 <span class="comment">        CTOR TemplatedOwnerExpression()</span>
<a name="l01793"></a>01793 <span class="comment">        {</span>
<a name="l01794"></a>01794 <span class="comment">        }</span>
<a name="l01795"></a>01795 <span class="comment">};</span>
<a name="l01796"></a>01796 <span class="comment">*/</span>
<a name="l01797"></a>01797 
<a name="l01798"></a>01798 <span class="keyword">class </span>GUIEXT GetDPExpression : <span class="keyword">public</span> Expressive::GetPropertyExpression
<a name="l01799"></a>01799 {
<a name="l01800"></a>01800 <span class="keyword">protected</span>:
<a name="l01801"></a>01801         CTOR GetDPExpression(Expressive::Expression* <span class="keywordtype">object</span>) : Expressive::GetPropertyExpression(object)
<a name="l01802"></a>01802         {
<a name="l01803"></a>01803         }
<a name="l01804"></a>01804 };
<a name="l01805"></a>01805 
<a name="l01806"></a>01806 <span class="keyword">class </span>ExpressionBinding;
<a name="l01807"></a>01807 
<a name="l01808"></a>01808 <span class="keyword">class </span>GUIEXT GetDPByDPExpression : <span class="keyword">public</span> GetDPExpression, <span class="keyword">public</span> IInputBinding
<a name="l01809"></a>01809 {
<a name="l01810"></a>01810 <span class="keyword">public</span>:
<a name="l01811"></a>01811         CTOR GetDPByDPExpression(Expressive::Expression* <span class="keywordtype">object</span>, DependencyProperty* dp);
<a name="l01812"></a>01812 
<a name="l01813"></a>01813         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnChildChanged(Expressive::Expression* child) <span class="keyword">override</span>;
<a name="l01814"></a>01814 
<a name="l01815"></a>01815         <span class="keyword">virtual</span> Variant Evaluate(Expressive::EvalContext* context);
<a name="l01816"></a>01816         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Set(Expressive::EvalContext* context, <span class="keyword">const</span> Variant&amp; value);
<a name="l01817"></a>01817 
<a name="l01818"></a>01818         <span class="keyword">virtual</span> <span class="keywordtype">void</span> TraceCallback(Expressive::EvalContext* context, Expressive::ExpTrace&amp; trace, Expressive::ITraceCallback* callback);
<a name="l01819"></a>01819 
<a name="l01820"></a>01820         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetInput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) <span class="keyword">override</span>;  <span class="comment">// IInputBinding</span>
<a name="l01821"></a>01821         <span class="keyword">virtual</span> Type* GetInputType();<span class="comment">// override;       // IInputBinding</span>
<a name="l01822"></a>01822 
<a name="l01823"></a>01823         <span class="keyword">virtual</span> IO::TextWriter&amp; WriteMLString(IO::TextWriter&amp; stream, map&lt;Object*,int&gt;&amp; defs)<span class="keyword"> override</span>
<a name="l01824"></a>01824 <span class="keyword">        </span>{
<a name="l01825"></a>01825 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l01826"></a>01826 <span class="preprocessor"></span>                m_object-&gt;WriteMLString(stream, defs);
<a name="l01827"></a>01827                 stream &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;
<a name="l01828"></a>01828                 stream &lt;&lt; m_dp-&gt;get_Name();
<a name="l01829"></a>01829                 <span class="keywordflow">return</span> stream;
<a name="l01830"></a>01830 <span class="preprocessor">#endif</span>
<a name="l01831"></a>01831 <span class="preprocessor"></span>        }
<a name="l01832"></a>01832 
<a name="l01833"></a>01833         DependencyProperty* GetDP()<span class="keyword"> const</span>
<a name="l01834"></a>01834 <span class="keyword">        </span>{
<a name="l01835"></a>01835                 <span class="keywordflow">return</span> m_dp;
<a name="l01836"></a>01836         }
<a name="l01837"></a>01837 
<a name="l01838"></a>01838         IBinding* m_inBinding;
<a name="l01839"></a>01839         ExpressionBinding* m_ownerBinding;
<a name="l01840"></a>01840 
<a name="l01841"></a>01841 <span class="keyword">protected</span>:
<a name="l01842"></a>01842 
<a name="l01843"></a>01843         DependencyProperty* m_dp;
<a name="l01844"></a>01844         <span class="keywordtype">bool</span> m_setting;
<a name="l01845"></a>01845 };
<a name="l01846"></a>01846 
<a name="l01847"></a>01847 <span class="keyword">class </span>GUIEXT GetDPByExpExpression : <span class="keyword">public</span> GetDPExpression
<a name="l01848"></a>01848 {
<a name="l01849"></a>01849 <span class="keyword">public</span>:
<a name="l01850"></a>01850         CTOR GetDPByExpExpression(Expressive::Expression* <span class="keywordtype">object</span>, Expressive::Expression* exp) :
<a name="l01851"></a>01851                 GetDPExpression(object), m_exp(exp)
<a name="l01852"></a>01852         {
<a name="l01853"></a>01853         }
<a name="l01854"></a>01854 
<a name="l01855"></a>01855         <span class="keyword">virtual</span> Variant Evaluate(Expressive::EvalContext* context);
<a name="l01856"></a>01856         <span class="keywordtype">bool</span> Set(Expressive::EvalContext* context, Variant value);
<a name="l01857"></a>01857 
<a name="l01858"></a>01858         <span class="keyword">virtual</span> <span class="keywordtype">void</span> TraceCallback(Expressive::EvalContext* context, Expressive::ExpTrace&amp; trace, Expressive::ITraceCallback* callback);
<a name="l01859"></a>01859 
<a name="l01860"></a>01860         Expressive::Expression* m_exp;
<a name="l01861"></a>01861 };
<a name="l01862"></a>01862 
<a name="l01863"></a>01863 <span class="comment">// many inputs, 1 output</span>
<a name="l01864"></a>01864 <span class="keyword">class </span>GUIEXT ExpressionBinding : <span class="keyword">public</span> Object, <span class="keyword">public</span> IBinding
<a name="l01865"></a>01865 {
<a name="l01866"></a>01866 <span class="keyword">public</span>:
<a name="l01867"></a>01867 
<a name="l01868"></a>01868         <span class="comment">/*</span>
<a name="l01869"></a>01869 <span class="comment">        CTOR ExpressionBinding(DependencyObject* templatedOwner, Expressive::Expression* exp) : m_templateOwner(templateOwner), m_exp(exp)</span>
<a name="l01870"></a>01870 <span class="comment">        {</span>
<a name="l01871"></a>01871 <span class="comment">                ASSERT(dynamic_cast&lt;Expressive::Expression*&gt;((Object*)exp) != NULL);</span>
<a name="l01872"></a>01872 <span class="comment">        }</span>
<a name="l01873"></a>01873 <span class="comment">        */</span>
<a name="l01874"></a>01874 
<a name="l01875"></a>01875         CTOR ExpressionBinding(DependencyObject* _this, Expressive::Expression* exp);
<a name="l01876"></a>01876 
<a name="l01877"></a>01877         <span class="keyword">virtual</span> Type* GetOutputType() <span class="keyword">override</span>;
<a name="l01878"></a>01878         <span class="keyword">virtual</span> Variant GetOutput(IBinding* caller) <span class="keyword">override</span>;
<a name="l01879"></a>01879 
<a name="l01880"></a>01880         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) <span class="keyword">override</span>;
<a name="l01881"></a>01881         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keywordtype">float</span> value) <span class="keyword">override</span>;
<a name="l01882"></a>01882 
<a name="l01883"></a>01883         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetInput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) <span class="keyword">override</span>;
<a name="l01884"></a>01884         <span class="keyword">virtual</span> <span class="keywordtype">void</span>* Connect(IInputBinding* binding) <span class="keyword">override</span>;
<a name="l01885"></a>01885 
<a name="l01886"></a>01886         <span class="keywordtype">void</span> ReEval();
<a name="l01887"></a>01887 
<a name="l01888"></a>01888         DependencyObject* m_this;       <span class="comment">// ???</span>
<a name="l01889"></a>01889         Expressive::Expression* m_exp;
<a name="l01890"></a>01890 
<a name="l01891"></a>01891         list&lt;IBinding*&gt; m_inBindings;
<a name="l01892"></a>01892         IInputBinding* m_outBinding;
<a name="l01893"></a>01893 };
<a name="l01894"></a>01894 
<a name="l01895"></a>01895 <span class="comment">// many inputs, 1 output</span>
<a name="l01896"></a>01896 <span class="keyword">class </span>GUIEXT ExpressionBinding2 : <span class="keyword">public</span> Object, <span class="keyword">public</span> IBinding
<a name="l01897"></a>01897 {
<a name="l01898"></a>01898 <span class="keyword">public</span>:
<a name="l01899"></a>01899         <span class="comment">// vm expression</span>
<a name="l01900"></a>01900 };
<a name="l01901"></a>01901 
<a name="l01902"></a>01902 <span class="comment">// 1 input, many outputs (e.g: connect an expression to many outputs)</span>
<a name="l01903"></a>01903 <span class="keyword">class </span>GUIEXT OneToManyOutputsBinding : <span class="keyword">public</span> Object, <span class="keyword">public</span> IBinding
<a name="l01904"></a>01904 {
<a name="l01905"></a>01905 <span class="keyword">public</span>:
<a name="l01906"></a>01906         CTOR OneToManyOutputsBinding();
<a name="l01907"></a>01907         CTOR OneToManyOutputsBinding(IBinding* inBinding);
<a name="l01908"></a>01908 
<a name="l01909"></a>01909         <span class="keyword">virtual</span> Variant GetOutput(IBinding* caller) <span class="keyword">override</span>;
<a name="l01910"></a>01910         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetOutput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) <span class="keyword">override</span>;
<a name="l01911"></a>01911         <span class="keyword">virtual</span> <span class="keywordtype">int</span> SetInput(IBinding* caller, <span class="keyword">const</span> Variant&amp; value) <span class="keyword">override</span>;
<a name="l01912"></a>01912         <span class="keyword">virtual</span> <span class="keywordtype">void</span>* Connect(IInputBinding* binding) <span class="keyword">override</span>;
<a name="l01913"></a>01913 
<a name="l01914"></a>01914         <span class="keywordtype">void</span> SetInputBinding(IBinding* inBinding);
<a name="l01915"></a>01915 
<a name="l01916"></a>01916 <span class="keyword">protected</span>:
<a name="l01917"></a>01917 
<a name="l01918"></a>01918         <span class="keyword">virtual</span> Variant GetValue() = 0;
<a name="l01919"></a>01919         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetValue(<span class="keyword">const</span> Variant&amp; value) = 0;
<a name="l01920"></a>01920 
<a name="l01921"></a>01921         <span class="keywordtype">int</span> OutputValue(<span class="keyword">const</span> Variant&amp; value);
<a name="l01922"></a>01922 
<a name="l01923"></a>01923         IBinding* m_inBinding;
<a name="l01924"></a>01924         <span class="keywordtype">void</span>* m_inBindingPtr;
<a name="l01925"></a>01925         list&lt;IInputBinding*&gt; m_outBindings;
<a name="l01926"></a>01926 };
<a name="l01927"></a>01927 
<a name="l01928"></a>01928 <span class="preprocessor">#if 0</span>
<a name="l01929"></a>01929 <span class="preprocessor"></span><span class="comment">// TODO remove</span>
<a name="l01930"></a>01930 <span class="keyword">class </span>GUIEXT PropertyTemplate : <span class="keyword">public</span> Object
<a name="l01931"></a>01931 {
<a name="l01932"></a>01932 <span class="keyword">public</span>:
<a name="l01933"></a>01933 
<a name="l01934"></a>01934         CTOR PropertyTemplate(DependencyProperty* dp, Object* value = NULL) :
<a name="l01935"></a>01935                 m_dp(dp),
<a name="l01936"></a>01936                 m_value(value)
<a name="l01937"></a>01937         {
<a name="l01938"></a>01938         }
<a name="l01939"></a>01939 
<a name="l01940"></a>01940         DependencyProperty* m_dp;
<a name="l01941"></a>01941         Object* m_value;
<a name="l01942"></a>01942 };
<a name="l01943"></a>01943 
<a name="l01944"></a>01944 <span class="comment">// TODO remove</span>
<a name="l01945"></a>01945 <span class="keyword">class </span>GUIEXT SetProperty : <span class="keyword">public</span> Object
<a name="l01946"></a>01946 {
<a name="l01947"></a>01947 <span class="keyword">public</span>:
<a name="l01948"></a>01948         CTOR SetProperty(DependencyProperty* dp) : m_dp(dp)
<a name="l01949"></a>01949         {
<a name="l01950"></a>01950         }
<a name="l01951"></a>01951 
<a name="l01952"></a>01952         DependencyProperty* m_dp;
<a name="l01953"></a>01953 };
<a name="l01954"></a>01954 
<a name="l01955"></a>01955 <span class="comment">// TODO remove</span>
<a name="l01956"></a>01956 <span class="keyword">class </span>GUIEXT SetPropertyToConst : <span class="keyword">public</span> SetProperty
<a name="l01957"></a>01957 {
<a name="l01958"></a>01958 <span class="keyword">public</span>:
<a name="l01959"></a>01959         CTOR SetPropertyToConst(DependencyProperty* dp, Object* value) : SetProperty(dp), m_value(value)
<a name="l01960"></a>01960         {
<a name="l01961"></a>01961         }
<a name="l01962"></a>01962 
<a name="l01963"></a>01963         <span class="comment">/*</span>
<a name="l01964"></a>01964 <span class="comment">        Binding* CreateBinding()</span>
<a name="l01965"></a>01965 <span class="comment">        {</span>
<a name="l01966"></a>01966 <span class="comment">                return new PropertyValueBinding(m_dp, m_value);</span>
<a name="l01967"></a>01967 <span class="comment">        }</span>
<a name="l01968"></a>01968 <span class="comment">*/</span>
<a name="l01969"></a>01969 
<a name="l01970"></a>01970         DependencyProperty* m_dp;
<a name="l01971"></a>01971         Object* m_value;
<a name="l01972"></a>01972 };
<a name="l01973"></a>01973 
<a name="l01974"></a>01974 <span class="comment">// TODO remove</span>
<a name="l01975"></a>01975 <span class="keyword">class </span>GUIEXT SetPropertyToExpression : <span class="keyword">public</span> SetProperty
<a name="l01976"></a>01976 {
<a name="l01977"></a>01977 <span class="keyword">public</span>:
<a name="l01978"></a>01978         CTOR SetPropertyToExpression(DependencyProperty* dp, Expressive::Expression* exp) : SetProperty(dp), m_exp(exp)
<a name="l01979"></a>01979         {
<a name="l01980"></a>01980                 ASSERT(dynamic_cast&lt;Expressive::Expression*&gt;((Object*)exp) != NULL);
<a name="l01981"></a>01981         }
<a name="l01982"></a>01982 
<a name="l01983"></a>01983         <span class="comment">/*</span>
<a name="l01984"></a>01984 <span class="comment">        Binding* CreateBinding()</span>
<a name="l01985"></a>01985 <span class="comment">        {</span>
<a name="l01986"></a>01986 <span class="comment">                return new ExpressionBinding(m_dp, m_exp);</span>
<a name="l01987"></a>01987 <span class="comment">        }</span>
<a name="l01988"></a>01988 <span class="comment">        */</span>
<a name="l01989"></a>01989 
<a name="l01990"></a>01990         Expressive::Expression* m_exp;
<a name="l01991"></a>01991 };
<a name="l01992"></a>01992 
<a name="l01993"></a>01993 <span class="comment">// TODO remove</span>
<a name="l01994"></a>01994 <span class="keyword">class </span>ObjectTemplateBase;
<a name="l01995"></a>01995 
<a name="l01996"></a>01996 <span class="comment">// TODO remove</span>
<a name="l01997"></a>01997 <span class="keyword">class </span>GUIEXT SetPropertyToObjectTemplate : <span class="keyword">public</span> SetProperty
<a name="l01998"></a>01998 {
<a name="l01999"></a>01999 <span class="keyword">public</span>:
<a name="l02000"></a>02000 
<a name="l02001"></a>02001         CTOR SetPropertyToObjectTemplate(DependencyProperty* dp, ObjectTemplateBase* objectTemplate) :
<a name="l02002"></a>02002                 SetProperty(dp),
<a name="l02003"></a>02003                 m_objectTemplate(objectTemplate)
<a name="l02004"></a>02004         {
<a name="l02005"></a>02005         }
<a name="l02006"></a>02006 
<a name="l02007"></a>02007         ObjectTemplateBase* m_objectTemplate;
<a name="l02008"></a>02008 };
<a name="l02009"></a>02009 
<a name="l02010"></a>02010 <span class="comment">/*</span>
<a name="l02011"></a>02011 <span class="comment">class GUIEXT SetPropertyToObjectCollectionTemplate : public SetProperty</span>
<a name="l02012"></a>02012 <span class="comment">{</span>
<a name="l02013"></a>02013 <span class="comment">public:</span>
<a name="l02014"></a>02014 <span class="comment"></span>
<a name="l02015"></a>02015 <span class="comment">        CTOR SetPropertyToObjectCollectionTemplate(DependencyProperty* dp, ObjectCollectionTemplate* objectCollectionTemplate) :</span>
<a name="l02016"></a>02016 <span class="comment">                SetProperty(dp),</span>
<a name="l02017"></a>02017 <span class="comment">                m_objectCollectionTemplate(objectCollectionTemplate)</span>
<a name="l02018"></a>02018 <span class="comment">        {</span>
<a name="l02019"></a>02019 <span class="comment">        }</span>
<a name="l02020"></a>02020 <span class="comment"></span>
<a name="l02021"></a>02021 <span class="comment">        ObjectCollectionTemplate* m_objectCollectionTemplate;</span>
<a name="l02022"></a>02022 <span class="comment">};</span>
<a name="l02023"></a>02023 <span class="comment">*/</span>
<a name="l02024"></a>02024 
<a name="l02025"></a>02025 <span class="comment">// TODO remove</span>
<a name="l02026"></a>02026 <span class="keyword">class </span>GUIEXT SetPropertyGroup : <span class="keyword">public</span> Object
<a name="l02027"></a>02027 {
<a name="l02028"></a>02028 <span class="keyword">public</span>:
<a name="l02029"></a>02029         vector&lt;SetProperty*&gt; m_items;
<a name="l02030"></a>02030 };
<a name="l02031"></a>02031 
<a name="l02032"></a>02032 <span class="comment">// TODO remove</span>
<a name="l02033"></a>02033 <span class="keyword">class </span>Deps
<a name="l02034"></a>02034 {
<a name="l02035"></a>02035 <span class="keyword">public</span>:
<a name="l02036"></a>02036         ObjectTemplateBase* m_objTemplate;
<a name="l02037"></a>02037         Expressive::StaticObjectExpression* m_exp;
<a name="l02038"></a>02038 };
<a name="l02039"></a>02039 
<a name="l02040"></a>02040 <span class="comment">// TODO remove</span>
<a name="l02041"></a>02041 <span class="keyword">class </span>GUIEXT Refs2
<a name="l02042"></a>02042 {
<a name="l02043"></a>02043 <span class="keyword">public</span>:
<a name="l02044"></a>02044 <span class="comment">//      map&lt;int, Deps*&gt; m_objects;</span>
<a name="l02045"></a>02045         map&lt;int, ObjectTemplateBase*&gt; m_objects;
<a name="l02046"></a>02046         map&lt;ObjectTemplateBase*, int&gt; m_objects2;
<a name="l02047"></a>02047 };
<a name="l02048"></a>02048 
<a name="l02049"></a>02049 <span class="comment">// TODO remove</span>
<a name="l02050"></a>02050 <span class="keyword">class </span>GUIEXT ObjectTemplateBase : <span class="keyword">public</span> Object
<a name="l02051"></a>02051 {
<a name="l02052"></a>02052 <span class="keyword">public</span>:
<a name="l02053"></a>02053         CTOR ObjectTemplateBase(<span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; classType) : m_classType(classType)
<a name="l02054"></a>02054         {
<a name="l02055"></a>02055                 ASSERT(&amp;classType);
<a name="l02056"></a>02056                 ASSERT(classType.GetType());
<a name="l02057"></a>02057         }
<a name="l02058"></a>02058 
<a name="l02059"></a>02059         <span class="keyword">virtual</span> Object* Create(Refs2* refs, map&lt;int, Expressive::StaticObjectExpression*&gt;&amp; irefs, Window* ownerWindow, UIElement* templatedOwner, IRootVisual* rootVisual) = 0;
<a name="l02060"></a>02060 
<a name="l02061"></a>02061         <span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; m_classType;
<a name="l02062"></a>02062 };
<a name="l02063"></a>02063 
<a name="l02064"></a>02064 <span class="comment">// TODO remove</span>
<a name="l02065"></a>02065 <span class="keyword">class </span>GUIEXT ObjectTemplateCollection : <span class="keyword">public</span> Object
<a name="l02066"></a>02066 {
<a name="l02067"></a>02067 <span class="keyword">public</span>:
<a name="l02068"></a>02068         list&lt;ObjectTemplateBase*&gt; m_items;
<a name="l02069"></a>02069 };
<a name="l02070"></a>02070 
<a name="l02071"></a>02071 <span class="comment">// TODO remove</span>
<a name="l02072"></a>02072 <span class="keyword">class </span>GUIEXT ObjectTemplate : <span class="keyword">public</span> ObjectTemplateBase
<a name="l02073"></a>02073 {
<a name="l02074"></a>02074 <span class="keyword">public</span>:
<a name="l02075"></a>02075 
<a name="l02076"></a>02076         CTOR ObjectTemplate(<span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; classType, SetPropertyGroup* setPropertyGroup = NULL) :
<a name="l02077"></a>02077                 ObjectTemplateBase(classType),
<a name="l02078"></a>02078                 m_setPropertyGroup(setPropertyGroup)
<a name="l02079"></a>02079         {
<a name="l02080"></a>02080         }
<a name="l02081"></a>02081 
<a name="l02082"></a>02082 <span class="comment">//      virtual Object* Evaluate(EvalContext* context); // TODO, only if Expression</span>
<a name="l02083"></a>02083 
<a name="l02084"></a>02084         <span class="keyword">virtual</span> Object* Create(Refs2* refs, map&lt;int, Expressive::StaticObjectExpression*&gt;&amp; irefs, Window* ownerWindow, UIElement* templatedOwner, IRootVisual* rootVisual);
<a name="l02085"></a>02085 
<a name="l02086"></a>02086         SetPropertyGroup* m_setPropertyGroup;
<a name="l02087"></a>02087 };
<a name="l02088"></a>02088 
<a name="l02089"></a>02089 <span class="comment">// TODO remove</span>
<a name="l02090"></a>02090 <span class="keyword">class </span>GUIEXT CollectionObjectTemplate : <span class="keyword">public</span> ObjectTemplateBase
<a name="l02091"></a>02091 {
<a name="l02092"></a>02092 <span class="keyword">public</span>:
<a name="l02093"></a>02093 
<a name="l02094"></a>02094         CTOR CollectionObjectTemplate(<span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; classType, ObjectTemplateCollection* items) :
<a name="l02095"></a>02095                 ObjectTemplateBase(classType),
<a name="l02096"></a>02096                 m_items(items)
<a name="l02097"></a>02097         {
<a name="l02098"></a>02098         }
<a name="l02099"></a>02099 
<a name="l02100"></a>02100         <span class="keyword">virtual</span> Object* Create(Refs2* refs, map&lt;int, Expressive::StaticObjectExpression*&gt;&amp; irefs, Window* ownerWindow, UIElement* templatedOwner, IRootVisual* rootVisual);
<a name="l02101"></a>02101 
<a name="l02102"></a>02102         ObjectTemplateCollection* m_items;
<a name="l02103"></a>02103 };
<a name="l02104"></a>02104 <span class="preprocessor">#endif</span>
<a name="l02105"></a>02105 <span class="preprocessor"></span>
<a name="l02106"></a>02106 <span class="comment">// TODO remove</span>
<a name="l02107"></a>02107 <span class="keyword">class </span>GUIEXT Template : <span class="keyword">public</span> Object
<a name="l02108"></a>02108 {
<a name="l02109"></a>02109 <span class="keyword">public</span>:
<a name="l02110"></a>02110 <span class="comment">//      Refs2* m_refs;</span>
<a name="l02111"></a>02111         Object* m_object;
<a name="l02112"></a>02112 };
<a name="l02113"></a>02113 
<a name="l02114"></a>02114 <span class="preprocessor">#if 0</span>
<a name="l02115"></a>02115 <span class="preprocessor"></span><span class="keyword">class </span>tProperty;
<a name="l02116"></a>02116 <span class="keyword">class </span>tSetProperty;
<a name="l02117"></a>02117 <span class="keyword">class </span>tSetPropertyGroup;
<a name="l02118"></a>02118 <span class="keyword">class </span>_ObjectCollection;
<a name="l02119"></a>02119 <span class="keyword">class </span>tCollectionObjectTemplate;
<a name="l02120"></a>02120 <span class="keyword">template</span>&lt;<span class="keyword">class</span>&gt; <span class="keyword">class </span>tObjectTemplate;
<a name="l02121"></a>02121 
<a name="l02122"></a>02122 <span class="keyword">class </span>GUIEXT tSetProperty
<a name="l02123"></a>02123 {
<a name="l02124"></a>02124 <span class="keyword">public</span>:
<a name="l02125"></a>02125 
<a name="l02126"></a>02126         CTOR tSetProperty(SetProperty* p) : m_p(p)
<a name="l02127"></a>02127         {
<a name="l02128"></a>02128         }
<a name="l02129"></a>02129 
<a name="l02130"></a>02130         operator SetProperty* ()<span class="keyword"> const</span>
<a name="l02131"></a>02131 <span class="keyword">        </span>{
<a name="l02132"></a>02132                 <span class="keywordflow">return</span> m_p;
<a name="l02133"></a>02133         }
<a name="l02134"></a>02134 
<a name="l02135"></a>02135 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02136"></a>02136 <span class="preprocessor"></span>        tSetPropertyGroup operator, (tSetProperty prop);
<a name="l02137"></a>02137 <span class="preprocessor">#endif</span>
<a name="l02138"></a>02138 <span class="preprocessor"></span>
<a name="l02139"></a>02139         SetProperty* m_p;
<a name="l02140"></a>02140 };
<a name="l02141"></a>02141 
<a name="l02142"></a>02142 <span class="keyword">class </span>GUIEXT tProperty
<a name="l02143"></a>02143 {
<a name="l02144"></a>02144 <span class="keyword">public</span>:
<a name="l02145"></a>02145 
<a name="l02146"></a>02146         <span class="comment">/*</span>
<a name="l02147"></a>02147 <span class="comment">        CTOR tProperty(DependencyProperty&amp; dp) : m_dp(&amp;dp)</span>
<a name="l02148"></a>02148 <span class="comment">        {</span>
<a name="l02149"></a>02149 <span class="comment">        }</span>
<a name="l02150"></a>02150 <span class="comment">        */</span>
<a name="l02151"></a>02151 
<a name="l02152"></a>02152         <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l02153"></a>02153         CTOR tProperty(TypedDependencyProperty&lt;T&gt;&amp; dp) : m_dp(&amp;dp)
<a name="l02154"></a>02154         {
<a name="l02155"></a>02155         }
<a name="l02156"></a>02156 
<a name="l02157"></a>02157         <span class="comment">/*</span>
<a name="l02158"></a>02158 <span class="comment">        operator Expressive::expression () const</span>
<a name="l02159"></a>02159 <span class="comment">        {</span>
<a name="l02160"></a>02160 <span class="comment">                return new WithGetPropertyExpression(m_dp);</span>
<a name="l02161"></a>02161 <span class="comment">        }</span>
<a name="l02162"></a>02162 <span class="comment">        */</span>
<a name="l02163"></a>02163 
<a name="l02164"></a>02164         tSetProperty operator = (<span class="keyword">const</span> Expressive::expression&amp; exp)<span class="keyword"> const</span>
<a name="l02165"></a>02165 <span class="keyword">        </span>{
<a name="l02166"></a>02166                 <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToExpression(m_dp, exp.m_p);
<a name="l02167"></a>02167         }
<a name="l02168"></a>02168 
<a name="l02169"></a>02169         <span class="comment">/*</span>
<a name="l02170"></a>02170 <span class="comment">        tSetProperty operator = (Expressive::Expression* exp) const</span>
<a name="l02171"></a>02171 <span class="comment">        {</span>
<a name="l02172"></a>02172 <span class="comment">                return new SetPropertyToExpression(m_dp, exp);</span>
<a name="l02173"></a>02173 <span class="comment">        }</span>
<a name="l02174"></a>02174 <span class="comment">        */</span>
<a name="l02175"></a>02175 
<a name="l02176"></a>02176         tSetProperty operator = (Object* obj)<span class="keyword"> const</span>
<a name="l02177"></a>02177 <span class="keyword">        </span>{
<a name="l02178"></a>02178                 <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, obj);
<a name="l02179"></a>02179         }
<a name="l02180"></a>02180 
<a name="l02181"></a>02181         <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; tSetProperty operator = (tObjectTemplate&lt;T&gt; obj) <span class="keyword">const</span>;
<a name="l02182"></a>02182 
<a name="l02183"></a>02183         tSetProperty operator = (<span class="keyword">const</span> tCollectionObjectTemplate&amp; obj) <span class="keyword">const</span>;
<a name="l02184"></a>02184 
<a name="l02185"></a>02185         tSetProperty operator = (<span class="keywordtype">int</span> value)<span class="keyword"> const</span>
<a name="l02186"></a>02186 <span class="keyword">        </span>{
<a name="l02187"></a>02187                 <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(bool))
<a name="l02188"></a>02188                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, BoolObject::GetObject(value != 0));
<a name="l02189"></a>02189                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(int))
<a name="l02190"></a>02190                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, IntObject::GetObject((<span class="keywordtype">int</span>)value));
<a name="l02191"></a>02191                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(float))
<a name="l02192"></a>02192                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, FloatObject::GetObject((<span class="keywordtype">float</span>)value));
<a name="l02193"></a>02193                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(double))
<a name="l02194"></a>02194                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, DoubleObject::GetObject((<span class="keywordtype">double</span>)value));
<a name="l02195"></a>02195                 <span class="keywordflow">else</span>
<a name="l02196"></a>02196                 {
<a name="l02197"></a>02197                         ASSERT(0);
<a name="l02198"></a>02198                         <span class="keywordflow">return</span> NULL;
<a name="l02199"></a>02199                         <span class="comment">//return new SetPropertyToConst(m_dp, box_cast(value));</span>
<a name="l02200"></a>02200                 }
<a name="l02201"></a>02201         }
<a name="l02202"></a>02202 
<a name="l02203"></a>02203         tSetProperty operator = (<span class="keywordtype">float</span> value)<span class="keyword"> const</span>
<a name="l02204"></a>02204 <span class="keyword">        </span>{
<a name="l02205"></a>02205                 <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(bool))
<a name="l02206"></a>02206                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, BoolObject::GetObject(value != 0));
<a name="l02207"></a>02207                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(int))
<a name="l02208"></a>02208                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, IntObject::GetObject((<span class="keywordtype">int</span>)value));
<a name="l02209"></a>02209                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(float))
<a name="l02210"></a>02210                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, FloatObject::GetObject((<span class="keywordtype">float</span>)value));
<a name="l02211"></a>02211                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(double))
<a name="l02212"></a>02212                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, DoubleObject::GetObject((<span class="keywordtype">double</span>)value));
<a name="l02213"></a>02213                 <span class="keywordflow">else</span>
<a name="l02214"></a>02214                 {
<a name="l02215"></a>02215                         ASSERT(0);
<a name="l02216"></a>02216                         <span class="keywordflow">return</span> NULL;
<a name="l02217"></a>02217                         <span class="comment">//return new SetPropertyToConst(m_dp, box_cast(value));</span>
<a name="l02218"></a>02218                 }
<a name="l02219"></a>02219         }
<a name="l02220"></a>02220 
<a name="l02221"></a>02221         tSetProperty operator = (<span class="keywordtype">double</span> value)<span class="keyword"> const</span>
<a name="l02222"></a>02222 <span class="keyword">        </span>{
<a name="l02223"></a>02223                 <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(bool))
<a name="l02224"></a>02224                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, BoolObject::GetObject(value != 0));
<a name="l02225"></a>02225                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(int))
<a name="l02226"></a>02226                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, IntObject::GetObject((<span class="keywordtype">int</span>)value));
<a name="l02227"></a>02227                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(float))
<a name="l02228"></a>02228                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, FloatObject::GetObject((<span class="keywordtype">float</span>)value));
<a name="l02229"></a>02229                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_dp-&gt;get_Type() == <span class="keyword">typeid</span>(double))
<a name="l02230"></a>02230                         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToConst(m_dp, DoubleObject::GetObject((<span class="keywordtype">double</span>)value));
<a name="l02231"></a>02231                 <span class="keywordflow">else</span>
<a name="l02232"></a>02232                 {
<a name="l02233"></a>02233                         ASSERT(0);
<a name="l02234"></a>02234                         <span class="keywordflow">return</span> NULL;
<a name="l02235"></a>02235                         <span class="comment">//return new SetPropertyToConst(m_dp, box_cast(value));</span>
<a name="l02236"></a>02236                 }
<a name="l02237"></a>02237         }
<a name="l02238"></a>02238 
<a name="l02239"></a>02239         DependencyProperty* m_dp;
<a name="l02240"></a>02240 };
<a name="l02241"></a>02241 
<a name="l02242"></a>02242 <span class="keyword">class </span>GUIEXT tSetPropertyGroup
<a name="l02243"></a>02243 {
<a name="l02244"></a>02244 <span class="keyword">public</span>:
<a name="l02245"></a>02245 
<a name="l02246"></a>02246         CTOR tSetPropertyGroup() : m_p(NULL)
<a name="l02247"></a>02247         {
<a name="l02248"></a>02248         }
<a name="l02249"></a>02249 
<a name="l02250"></a>02250         CTOR tSetPropertyGroup(SetPropertyGroup* p) : m_p(p)
<a name="l02251"></a>02251         {
<a name="l02252"></a>02252         }
<a name="l02253"></a>02253 
<a name="l02254"></a>02254         CTOR tSetPropertyGroup(<span class="keyword">const</span> tSetProperty&amp; prop)
<a name="l02255"></a>02255         {
<a name="l02256"></a>02256                 m_p = <span class="keyword">new</span> SetPropertyGroup;
<a name="l02257"></a>02257                 m_p-&gt;m_items.push_back(prop.m_p);
<a name="l02258"></a>02258         }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02261"></a>02261 <span class="preprocessor"></span>        tSetPropertyGroup&amp; operator, (<span class="keyword">const</span> tSetProperty&amp; prop)
<a name="l02262"></a>02262         {
<a name="l02263"></a>02263                 m_p-&gt;m_items.push_back(prop.m_p);
<a name="l02264"></a>02264                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l02265"></a>02265         }
<a name="l02266"></a>02266 <span class="preprocessor">#endif</span>
<a name="l02267"></a>02267 <span class="preprocessor"></span>
<a name="l02268"></a>02268         SetPropertyGroup* m_p;
<a name="l02269"></a>02269 };
<a name="l02270"></a>02270 
<a name="l02271"></a>02271 <span class="keyword">class </span>GUIEXT Refs
<a name="l02272"></a>02272 {
<a name="l02273"></a>02273 <span class="keyword">public</span>:
<a name="l02274"></a>02274         CTOR Refs();
<a name="l02275"></a>02275 
<a name="l02276"></a>02276         pair&lt;Refs2*, pair&lt;int, ObjectTemplateBase*&gt; &gt; def(<span class="keywordtype">int</span> <span class="keywordtype">id</span>);
<a name="l02277"></a>02277 
<a name="l02278"></a>02278 <span class="preprocessor">#if 0</span>
<a name="l02279"></a>02279 <span class="preprocessor"></span>        Expressive::_Object use(<span class="keywordtype">int</span> <span class="keywordtype">id</span>);
<a name="l02280"></a>02280 
<a name="l02281"></a>02281         <span class="keyword">template</span>&lt;<span class="keyword">class</span> castTo&gt; castTo useAs(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l02282"></a>02282         {
<a name="l02283"></a>02283 
<a name="l02284"></a>02284                 Deps* obj = NULL;
<a name="l02285"></a>02285                 pair&lt;map&lt;int, ObjectTemplateBase*&gt;::iterator,<span class="keywordtype">bool</span>&gt; r = m_p-&gt;m_objects.insert(map&lt;int, ObjectTemplateBase*&gt;::value_type(<span class="keywordtype">id</span>, obj));
<a name="l02286"></a>02286 
<a name="l02287"></a>02287                 <span class="comment">/*</span>
<a name="l02288"></a>02288 <span class="comment">                if (r.first-&gt;second == NULL)</span>
<a name="l02289"></a>02289 <span class="comment">                {</span>
<a name="l02290"></a>02290 <span class="comment">                        r.first-&gt;second = new Deps;</span>
<a name="l02291"></a>02291 <span class="comment">                        r.first-&gt;second-&gt;m_exp = new Expressive::StaticObjectExpression;</span>
<a name="l02292"></a>02292 <span class="comment">                }</span>
<a name="l02293"></a>02293 <span class="comment">                */</span>
<a name="l02294"></a>02294 
<a name="l02295"></a>02295                 <span class="keywordflow">return</span> castTo(r.first-&gt;second-&gt;m_exp);
<a name="l02296"></a>02296         }
<a name="l02297"></a>02297 <span class="preprocessor">#endif</span>
<a name="l02298"></a>02298 <span class="preprocessor"></span>
<a name="l02299"></a>02299         Refs2* m_p;
<a name="l02300"></a>02300 };
<a name="l02301"></a>02301 
<a name="l02302"></a>02302 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>tObjectTemplate
<a name="l02303"></a>02303 {
<a name="l02304"></a>02304 <span class="keyword">public</span>:
<a name="l02305"></a>02305         CTOR tObjectTemplate()
<a name="l02306"></a>02306         {
<a name="l02307"></a>02307                 m_p = <span class="keyword">new</span> ObjectTemplate(<span class="keyword">typeid</span>(T));
<a name="l02308"></a>02308         }
<a name="l02309"></a>02309 
<a name="l02310"></a>02310         CTOR tObjectTemplate(pair&lt;Refs2*,pair&lt;int, ObjectTemplateBase*&gt; &gt;&amp; defid, tSetPropertyGroup&amp; properties)
<a name="l02311"></a>02311         {
<a name="l02312"></a>02312                 m_p = <span class="keyword">new</span> ObjectTemplate(<span class="keyword">typeid</span>(T), properties.m_p);
<a name="l02313"></a>02313                 defid.second.second = m_p;
<a name="l02314"></a>02314 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02315"></a>02315 <span class="preprocessor"></span>        <span class="comment">//      defidd.second-&gt;m_exp-&gt;m_pType = typeof(T*);</span>
<a name="l02316"></a>02316 <span class="preprocessor">#endif</span>
<a name="l02317"></a>02317 <span class="preprocessor"></span>        <span class="comment">//      ASSERT(defid.second.second-&gt;m_exp-&gt;m_pType);</span>
<a name="l02318"></a>02318                 defid.first-&gt;m_objects2[m_p] = defid.second.first;
<a name="l02319"></a>02319         }
<a name="l02320"></a>02320 
<a name="l02321"></a>02321         CTOR tObjectTemplate(<span class="keyword">const</span> tSetPropertyGroup&amp; properties)
<a name="l02322"></a>02322         {
<a name="l02323"></a>02323                 m_p = <span class="keyword">new</span> ObjectTemplate(<span class="keyword">typeid</span>(T), properties.m_p);
<a name="l02324"></a>02324         }
<a name="l02325"></a>02325 
<a name="l02326"></a>02326         CTOR tObjectTemplate(<span class="keyword">const</span> tSetProperty&amp; prop)
<a name="l02327"></a>02327         {
<a name="l02328"></a>02328                 SetPropertyGroup* propertyGroup = <span class="keyword">new</span> SetPropertyGroup();
<a name="l02329"></a>02329                 propertyGroup-&gt;m_items.push_back(prop.m_p);
<a name="l02330"></a>02330                 m_p = <span class="keyword">new</span> ObjectTemplate(<span class="keyword">typeid</span>(T), propertyGroup);
<a name="l02331"></a>02331         }
<a name="l02332"></a>02332 
<a name="l02333"></a>02333 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02334"></a>02334 <span class="preprocessor"></span>        <span class="keyword">template</span>&lt;<span class="keyword">class</span> T2&gt; _ObjectCollection operator,(<span class="keyword">const</span> tObjectTemplate&lt;T2&gt;&amp; other) <span class="keyword">const</span>;
<a name="l02335"></a>02335 <span class="preprocessor">#endif</span>
<a name="l02336"></a>02336 <span class="preprocessor"></span>
<a name="l02337"></a>02337         operator ObjectTemplate* ()
<a name="l02338"></a>02338         {
<a name="l02339"></a>02339                 <span class="keywordflow">return</span> m_p;
<a name="l02340"></a>02340         }
<a name="l02341"></a>02341 
<a name="l02342"></a>02342         ObjectTemplate* m_p;
<a name="l02343"></a>02343 };
<a name="l02344"></a>02344 
<a name="l02345"></a>02345 <span class="keyword">class </span>GUIEXT _ObjectCollection
<a name="l02346"></a>02346 {
<a name="l02347"></a>02347 <span class="keyword">public</span>:
<a name="l02348"></a>02348 
<a name="l02349"></a>02349         CTOR _ObjectCollection(ObjectTemplateCollection* p = NULL) : m_p(p)
<a name="l02350"></a>02350         {
<a name="l02351"></a>02351         }
<a name="l02352"></a>02352 
<a name="l02353"></a>02353         <span class="keyword">template</span>&lt;<span class="keyword">class</span> T2&gt;
<a name="l02354"></a>02354         CTOR _ObjectCollection(<span class="keyword">const</span> tObjectTemplate&lt;T2&gt;&amp; other)
<a name="l02355"></a>02355         {
<a name="l02356"></a>02356                 m_p = <span class="keyword">new</span> ObjectTemplateCollection;
<a name="l02357"></a>02357                 m_p-&gt;m_items.push_back(other.m_p);
<a name="l02358"></a>02358         }
<a name="l02359"></a>02359 
<a name="l02360"></a>02360 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02361"></a>02361 <span class="preprocessor"></span>        <span class="keyword">template</span>&lt;<span class="keyword">class</span> T2&gt;
<a name="l02362"></a>02362         _ObjectCollection&amp; operator,(<span class="keyword">const</span> tObjectTemplate&lt;T2&gt;&amp; other)<span class="keyword"> const</span>
<a name="l02363"></a>02363 <span class="keyword">        </span>{
<a name="l02364"></a>02364                 m_p-&gt;m_items.push_back(other.m_p);
<a name="l02365"></a>02365                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l02366"></a>02366         }
<a name="l02367"></a>02367 <span class="preprocessor">#endif</span>
<a name="l02368"></a>02368 <span class="preprocessor"></span>
<a name="l02369"></a>02369         operator ObjectTemplateCollection* ()<span class="keyword"> const</span>
<a name="l02370"></a>02370 <span class="keyword">        </span>{
<a name="l02371"></a>02371                 <span class="keywordflow">return</span> m_p;
<a name="l02372"></a>02372         }
<a name="l02373"></a>02373 
<a name="l02374"></a>02374         ObjectTemplateCollection* m_p;
<a name="l02375"></a>02375 };
<a name="l02376"></a>02376 
<a name="l02377"></a>02377 <span class="keyword">class </span>GUIEXT tCollectionObjectTemplate
<a name="l02378"></a>02378 {
<a name="l02379"></a>02379 <span class="keyword">public</span>:
<a name="l02380"></a>02380         CTOR tCollectionObjectTemplate(<span class="keyword">const</span> _ObjectCollection&amp; item)
<a name="l02381"></a>02381         {
<a name="l02382"></a>02382                 m_p = <span class="keyword">new</span> CollectionObjectTemplate(<span class="keyword">typeid</span>(VisualCollection), item.m_p);
<a name="l02383"></a>02383         }
<a name="l02384"></a>02384 
<a name="l02385"></a>02385         CollectionObjectTemplate* m_p;
<a name="l02386"></a>02386 };
<a name="l02387"></a>02387 
<a name="l02388"></a>02388 <span class="comment">/*</span>
<a name="l02389"></a>02389 <span class="comment">class GUIEXT _this : public object</span>
<a name="l02390"></a>02390 <span class="comment">{</span>
<a name="l02391"></a>02391 <span class="comment">public:</span>
<a name="l02392"></a>02392 <span class="comment"></span>
<a name="l02393"></a>02393 <span class="comment">        CTOR _this() : object(new ThisExpression())</span>
<a name="l02394"></a>02394 <span class="comment">        {</span>
<a name="l02395"></a>02395 <span class="comment">        }</span>
<a name="l02396"></a>02396 <span class="comment">};</span>
<a name="l02397"></a>02397 <span class="comment">*/</span>
<a name="l02398"></a>02398 
<a name="l02399"></a>02399 <span class="comment">//extern object _this;  // TODO remove</span>
<a name="l02400"></a>02400 
<a name="l02401"></a>02401 <span class="comment">/*</span>
<a name="l02402"></a>02402 <span class="comment">class GUIEXT templateOwner : public Expressive::_Object</span>
<a name="l02403"></a>02403 <span class="comment">{</span>
<a name="l02404"></a>02404 <span class="comment">public:</span>
<a name="l02405"></a>02405 <span class="comment"></span>
<a name="l02406"></a>02406 <span class="comment">        CTOR templateOwner() : Expressive::_Object(&amp;TemplateOwnerExpression::only)</span>
<a name="l02407"></a>02407 <span class="comment">        {</span>
<a name="l02408"></a>02408 <span class="comment">        }</span>
<a name="l02409"></a>02409 <span class="comment">};</span>
<a name="l02410"></a>02410 <span class="comment">*/</span>
<a name="l02411"></a>02411 
<a name="l02412"></a>02412 <span class="comment">/*</span>
<a name="l02413"></a>02413 <span class="comment">class idref : public object</span>
<a name="l02414"></a>02414 <span class="comment">{</span>
<a name="l02415"></a>02415 <span class="comment">public:</span>
<a name="l02416"></a>02416 <span class="comment"></span>
<a name="l02417"></a>02417 <span class="comment">        CTOR idref(int id) : object(IDRefExpression::GetIDREF(id))</span>
<a name="l02418"></a>02418 <span class="comment">        {</span>
<a name="l02419"></a>02419 <span class="comment">        }</span>
<a name="l02420"></a>02420 <span class="comment">};</span>
<a name="l02421"></a>02421 <span class="comment">*/</span>
<a name="l02422"></a>02422 
<a name="l02423"></a>02423 <span class="keyword">class </span>GUIEXT tTemplate
<a name="l02424"></a>02424 {
<a name="l02425"></a>02425 <span class="keyword">public</span>:
<a name="l02426"></a>02426 
<a name="l02427"></a>02427         CTOR tTemplate(Template* p)
<a name="l02428"></a>02428         {
<a name="l02429"></a>02429                 m_p = p;
<a name="l02430"></a>02430         }
<a name="l02431"></a>02431 
<a name="l02432"></a>02432         CTOR tTemplate(Refs&amp; refs, ObjectTemplate* obj)
<a name="l02433"></a>02433         {
<a name="l02434"></a>02434                 m_p = <span class="keyword">new</span> Template;
<a name="l02435"></a>02435                 m_p-&gt;m_refs = refs.m_p;
<a name="l02436"></a>02436                 m_p-&gt;m_object = obj;
<a name="l02437"></a>02437         }
<a name="l02438"></a>02438 
<a name="l02439"></a>02439         operator Template* ()
<a name="l02440"></a>02440         {
<a name="l02441"></a>02441                 <span class="keywordflow">return</span> m_p;
<a name="l02442"></a>02442         }
<a name="l02443"></a>02443 
<a name="l02444"></a>02444         Template* m_p;
<a name="l02445"></a>02445 };
<a name="l02446"></a>02446 
<a name="l02447"></a>02447 <span class="keyword">class </span>GUIEXT xmlDocument
<a name="l02448"></a>02448 {
<a name="l02449"></a>02449 <span class="keyword">public</span>:
<a name="l02450"></a>02450         CTOR xmlDocument(<span class="keyword">const</span> WCHAR* str);
<a name="l02451"></a>02451         CTOR xmlDocument(Expressive::expression&amp; exp);
<a name="l02452"></a>02452 
<a name="l02453"></a>02453         XmlData::Document* m_p;
<a name="l02454"></a>02454 };
<a name="l02455"></a>02455 
<a name="l02456"></a>02456 <span class="comment">/*</span>
<a name="l02457"></a>02457 <span class="comment">class GUIEXT xmlFragment</span>
<a name="l02458"></a>02458 <span class="comment">{</span>
<a name="l02459"></a>02459 <span class="comment">public:</span>
<a name="l02460"></a>02460 <span class="comment">        CTOR xmlFragment(const WCHAR* str);</span>
<a name="l02461"></a>02461 <span class="comment">        CTOR xmlFragment(expression&amp; exp);</span>
<a name="l02462"></a>02462 <span class="comment"></span>
<a name="l02463"></a>02463 <span class="comment">        XmlData::Fragment* m_p;</span>
<a name="l02464"></a>02464 <span class="comment">};</span>
<a name="l02465"></a>02465 <span class="comment">*/</span>
<a name="l02466"></a>02466 
<a name="l02467"></a>02467 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; tSetProperty tProperty::operator = (tObjectTemplate&lt;T&gt; obj)<span class="keyword"> const</span>
<a name="l02468"></a>02468 <span class="keyword"></span>{
<a name="l02469"></a>02469         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToObjectTemplate(m_dp, obj.m_p);
<a name="l02470"></a>02470 }
<a name="l02471"></a>02471 
<a name="l02472"></a>02472 <span class="keyword">inline</span> tSetProperty tProperty::operator = (<span class="keyword">const</span> tCollectionObjectTemplate&amp; obj)<span class="keyword"> const</span>
<a name="l02473"></a>02473 <span class="keyword"></span>{
<a name="l02474"></a>02474         <span class="keywordflow">return</span> <span class="keyword">new</span> SetPropertyToObjectTemplate(m_dp, obj.m_p);
<a name="l02475"></a>02475 }
<a name="l02476"></a>02476 
<a name="l02477"></a>02477 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02478"></a>02478 <span class="preprocessor"></span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">template</span>&lt;<span class="keyword">class</span> T2&gt;
<a name="l02479"></a>02479 _ObjectCollection tObjectTemplate&lt;T&gt;::operator,(<span class="keyword">const</span> tObjectTemplate&lt;T2&gt;&amp; other)<span class="keyword"> const</span>
<a name="l02480"></a>02480 <span class="keyword"></span>{
<a name="l02481"></a>02481         ObjectTemplateCollection* p = <span class="keyword">new</span> ObjectTemplateCollection;
<a name="l02482"></a>02482         p-&gt;m_items.push_back(m_p);
<a name="l02483"></a>02483         p-&gt;m_items.push_back(other.m_p);
<a name="l02484"></a>02484         <span class="keywordflow">return</span> _ObjectCollection(p);
<a name="l02485"></a>02485 }
<a name="l02486"></a>02486 <span class="preprocessor">#endif</span>
<a name="l02487"></a>02487 <span class="preprocessor"></span>
<a name="l02488"></a>02488 <span class="preprocessor">#endif</span>
<a name="l02489"></a>02489 <span class="preprocessor"></span>
<a name="l02490"></a>02490 
<a name="l02491"></a>02491 <span class="comment">/*</span>
<a name="l02492"></a>02492 <span class="comment">inline expression operator + (expression&amp; exp, int value)</span>
<a name="l02493"></a>02493 <span class="comment">{</span>
<a name="l02494"></a>02494 <span class="comment">        return new PlusBinaryExpression(exp.m_p, new ConstExpression&lt;int&gt;(value));</span>
<a name="l02495"></a>02495 <span class="comment">}</span>
<a name="l02496"></a>02496 <span class="comment"></span>
<a name="l02497"></a>02497 <span class="comment">inline expression operator + (expression&amp; exp, float value)</span>
<a name="l02498"></a>02498 <span class="comment">{</span>
<a name="l02499"></a>02499 <span class="comment">        return new PlusBinaryExpression(exp.m_p, new ConstExpression&lt;float&gt;(value));</span>
<a name="l02500"></a>02500 <span class="comment">}</span>
<a name="l02501"></a>02501 <span class="comment"></span>
<a name="l02502"></a>02502 <span class="comment">inline expression operator + (expression&amp; exp, double value)</span>
<a name="l02503"></a>02503 <span class="comment">{</span>
<a name="l02504"></a>02504 <span class="comment">        return new PlusBinaryExpression(exp.m_p, new ConstExpression&lt;double&gt;(value));</span>
<a name="l02505"></a>02505 <span class="comment">}</span>
<a name="l02506"></a>02506 <span class="comment">*/</span>
<a name="l02507"></a>02507 
<a name="l02508"></a>02508 <span class="comment">/*</span>
<a name="l02509"></a>02509 <span class="comment">inline expression operator + (tProperty&amp; left, tProperty&amp; right)</span>
<a name="l02510"></a>02510 <span class="comment">{</span>
<a name="l02511"></a>02511 <span class="comment">        return new PlusBinaryExpression(prop.m_p, new ConstExpression&lt;double&gt;(value));</span>
<a name="l02512"></a>02512 <span class="comment">}</span>
<a name="l02513"></a>02513 <span class="comment">*/</span>
<a name="l02514"></a>02514 
<a name="l02515"></a>02515 <span class="comment">/*</span>
<a name="l02516"></a>02516 <span class="comment">DependencyProperty::operator expression () const</span>
<a name="l02517"></a>02517 <span class="comment">{</span>
<a name="l02518"></a>02518 <span class="comment">        return new WithGetPropertyExpression(this);</span>
<a name="l02519"></a>02519 <span class="comment">}</span>
<a name="l02520"></a>02520 <span class="comment"></span>
<a name="l02521"></a>02521 <span class="comment">template&lt;class T&gt; expression DependencyProperty::operator + (T right) const</span>
<a name="l02522"></a>02522 <span class="comment">{</span>
<a name="l02523"></a>02523 <span class="comment">        return new PlusBinaryExpression(new WithGetPropertyExpression(this), right);</span>
<a name="l02524"></a>02524 <span class="comment">}</span>
<a name="l02525"></a>02525 <span class="comment">*/</span>
<a name="l02526"></a>02526 
<a name="l02527"></a>02527 <span class="comment">/*</span>
<a name="l02528"></a>02528 <span class="comment">inline function::function(const expression&amp; exp) : m_p(new ExpressionFunctionT1&lt;float, DependencyObject*&gt;(exp.m_p))</span>
<a name="l02529"></a>02529 <span class="comment">{</span>
<a name="l02530"></a>02530 <span class="comment">}</span>
<a name="l02531"></a>02531 <span class="comment">*/</span>
<a name="l02532"></a>02532 
<a name="l02533"></a>02533 }
<a name="l02534"></a>02534 }
<a name="l02535"></a>02535 
<a name="l02536"></a>02536 <span class="preprocessor">#include &quot;DependencyObject.h&quot;</span>
<a name="l02537"></a>02537 <span class="preprocessor">#include &quot;GeneralTransform.h&quot;</span>
<a name="l02538"></a>02538 <span class="preprocessor">#include &quot;Animation.h&quot;</span>
<a name="l02539"></a>02539 
<a name="l02540"></a>02540 <span class="keyword">namespace </span>System
<a name="l02541"></a>02541 {
<a name="l02542"></a>02542 <span class="keyword">namespace </span>Gui
<a name="l02543"></a>02543 {
<a name="l02544"></a>02544 
<a name="l02545"></a>02545 <span class="keyword">class </span>GUIEXT Link : <span class="keyword">public</span> DependencyObject
<a name="l02546"></a>02546 {
<a name="l02547"></a>02547 <span class="keyword">public</span>:
<a name="l02548"></a>02548 
<a name="l02549"></a>02549         String m_name;
<a name="l02550"></a>02550 };
<a name="l02551"></a>02551 
<a name="l02552"></a>02552 <span class="keyword">class </span>GUIEXT LinkResolver
<a name="l02553"></a>02553 {
<a name="l02554"></a>02554 <span class="keyword">public</span>:
<a name="l02555"></a>02555 
<a name="l02556"></a>02556         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Resolve(Link* link) <span class="keyword">abstract</span>;
<a name="l02557"></a>02557 };
<a name="l02558"></a>02558 
<a name="l02559"></a>02559 <span class="keyword">class </span>PSDLayerLink : <span class="keyword">public</span> LinkResolver
<a name="l02560"></a>02560 {
<a name="l02561"></a>02561 <span class="keyword">public</span>:
<a name="l02562"></a>02562 
<a name="l02563"></a>02563         <span class="keywordtype">void</span> Resolve(Link* link)
<a name="l02564"></a>02564         {
<a name="l02565"></a>02565         }
<a name="l02566"></a>02566 
<a name="l02567"></a>02567         <span class="keyword">const</span> <a class="code" href="classstd_1_1type__info.html" title="Part of RTTI.">Type_Info</a>&amp; GetTypeInfo()
<a name="l02568"></a>02568         {
<a name="l02569"></a>02569                 <span class="keywordflow">return</span> <span class="keyword">typeid</span>(Graphics::Bitmap);
<a name="l02570"></a>02570         }
<a name="l02571"></a>02571 
<a name="l02572"></a>02572         Object* GetData();
<a name="l02573"></a>02573 };
<a name="l02574"></a>02574 
<a name="l02575"></a>02575 <span class="keyword">class </span>GUIEXT BitmapSource : <span class="keyword">public</span> DependencyObject, <span class="keyword">public</span> IBitmapSource
<a name="l02576"></a>02576 {
<a name="l02577"></a>02577 <span class="keyword">public</span>:
<a name="l02578"></a>02578 
<a name="l02579"></a>02579         CTOR BitmapSource();
<a name="l02580"></a>02580         CTOR BitmapSource(Graphics::Bitmap* bitmap);
<a name="l02581"></a>02581 
<a name="l02582"></a>02582         <span class="keyword">virtual</span> Graphics::Bitmap* GetBitmap()<span class="keyword"> override</span>
<a name="l02583"></a>02583 <span class="keyword">        </span>{
<a name="l02584"></a>02584                 <span class="keywordflow">return</span> m_bitmap;
<a name="l02585"></a>02585         }
<a name="l02586"></a>02586 
<a name="l02587"></a>02587         DEPENDENCY_CLASS(BitmapSource, DependencyObject)
<a name="l02588"></a>02588 
<a name="l02589"></a>02589         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, Width)
<a name="l02590"></a>02590         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, Height)
<a name="l02591"></a>02591 
<a name="l02592"></a>02592         Graphics::Bitmap* m_bitmap;
<a name="l02593"></a>02593 };
<a name="l02594"></a>02594 
<a name="l02595"></a>02595 class GUIEXT TextFormat : public Object
<a name="l02596"></a>02596 {
<a name="l02597"></a>02597 <span class="keyword">public</span>:
<a name="l02598"></a>02598 
<a name="l02599"></a>02599         CTOR TextFormat(StringIn fontFamily, <span class="keywordtype">float</span> fontSize, <span class="keywordtype">int</span> fontWeight = 400);
<a name="l02600"></a>02600 
<a name="l02601"></a>02601         String m_fontFamily;
<a name="l02602"></a>02602         <span class="keywordtype">float</span> m_fontSize;
<a name="l02603"></a>02603         <span class="keywordtype">int</span> m_fontWeight;
<a name="l02604"></a>02604 
<a name="l02605"></a>02605         IDWriteTextFormat* m_pDWriteTextFormat;
<a name="l02606"></a>02606 };
<a name="l02607"></a>02607 
<a name="l02608"></a>02608 }       <span class="comment">// Gui</span>
<a name="l02609"></a>02609 }       <span class="comment">// System</span>
<a name="l02610"></a>02610 
<a name="l02611"></a>02611 <span class="preprocessor">#include &quot;RenderContext.h&quot;</span>
<a name="l02612"></a>02612 <span class="preprocessor">#include &quot;ImmediateRenderContext.h&quot;</span>
<a name="l02613"></a>02613 <span class="preprocessor">#include &quot;RetainedRenderContext.h&quot;</span>
<a name="l02614"></a>02614 <span class="preprocessor">#include &quot;ManagedRenderContext.h&quot;</span>
<a name="l02615"></a>02615 <span class="preprocessor">#include &quot;ManagedRetainedRenderContext.h&quot;</span>
<a name="l02616"></a>02616 
<a name="l02617"></a>02617 <span class="keyword">namespace </span>System
<a name="l02618"></a>02618 {
<a name="l02619"></a>02619 <span class="keyword">namespace </span>Gui
<a name="l02620"></a>02620 {
<a name="l02621"></a>02621 
<a name="l02622"></a>02622 <span class="keyword">class </span>GUIEXT FloatRadians
<a name="l02623"></a>02623 {
<a name="l02624"></a>02624 <span class="keyword">public</span>:
<a name="l02625"></a>02625 
<a name="l02626"></a>02626         CTOR FloatRadians(<span class="keywordtype">float</span> value) : m_value(value)
<a name="l02627"></a>02627         {
<a name="l02628"></a>02628         }
<a name="l02629"></a>02629 
<a name="l02630"></a>02630         operator float ()<span class="keyword"> const</span>
<a name="l02631"></a>02631 <span class="keyword">        </span>{
<a name="l02632"></a>02632                 <span class="keywordflow">return</span> m_value;
<a name="l02633"></a>02633         }
<a name="l02634"></a>02634 
<a name="l02635"></a>02635         <span class="keywordtype">float</span> m_value;
<a name="l02636"></a>02636 };
<a name="l02637"></a>02637 
<a name="l02638"></a>02638 }
<a name="l02639"></a>02639 }
<a name="l02640"></a>02640 
<a name="l02641"></a>02641 <span class="preprocessor">#include &quot;Transform.h&quot;</span>
<a name="l02642"></a>02642 <span class="preprocessor">#include &quot;TranslateTransform.h&quot;</span>
<a name="l02643"></a>02643 <span class="preprocessor">#include &quot;RotateTransform.h&quot;</span>
<a name="l02644"></a>02644 <span class="preprocessor">#include &quot;ScaleTransform.h&quot;</span>
<a name="l02645"></a>02645 <span class="preprocessor">#include &quot;MatrixTransform.h&quot;</span>
<a name="l02646"></a>02646 <span class="preprocessor">#include &quot;Color.h&quot;</span>
<a name="l02647"></a>02647 
<a name="l02648"></a>02648 <span class="keyword">namespace </span>System
<a name="l02649"></a>02649 {
<a name="l02650"></a>02650 <span class="keyword">namespace </span>Gui
<a name="l02651"></a>02651 {
<a name="l02652"></a>02652 
<a name="l02653"></a>02653 <span class="comment">/*</span>
<a name="l02654"></a>02654 <span class="comment">class GUIEXT SkewXTransform : public Transform</span>
<a name="l02655"></a>02655 <span class="comment">{</span>
<a name="l02656"></a>02656 <span class="comment">public:</span>
<a name="l02657"></a>02657 <span class="comment">};</span>
<a name="l02658"></a>02658 <span class="comment"></span>
<a name="l02659"></a>02659 <span class="comment">class GUIEXT SkewYTransform : public Transform</span>
<a name="l02660"></a>02660 <span class="comment">{</span>
<a name="l02661"></a>02661 <span class="comment">public:</span>
<a name="l02662"></a>02662 <span class="comment">};</span>
<a name="l02663"></a>02663 <span class="comment">*/</span>
<a name="l02664"></a>02664 
<a name="l02665"></a>02665 <span class="comment">/*</span>
<a name="l02666"></a>02666 <span class="comment">class GUIEXT PropertyBinding : public Binding</span>
<a name="l02667"></a>02667 <span class="comment">{</span>
<a name="l02668"></a>02668 <span class="comment">public:</span>
<a name="l02669"></a>02669 <span class="comment"></span>
<a name="l02670"></a>02670 <span class="comment">        CTOR PropertyBinding(PropertyValue* depProperty);</span>
<a name="l02671"></a>02671 <span class="comment"></span>
<a name="l02672"></a>02672 <span class="comment">        virtual Object* get(PropertyValue* target)</span>
<a name="l02673"></a>02673 <span class="comment">        {</span>
<a name="l02674"></a>02674 <span class="comment">                return m_upStreamProperty-&gt;GetComputedObjectValue();</span>
<a name="l02675"></a>02675 <span class="comment">        }</span>
<a name="l02676"></a>02676 <span class="comment"></span>
<a name="l02677"></a>02677 <span class="comment">        virtual void set(Object* value)</span>
<a name="l02678"></a>02678 <span class="comment">        {</span>
<a name="l02679"></a>02679 <span class="comment">                ASSERT(0);</span>
<a name="l02680"></a>02680 <span class="comment">                //m_pProperty-&gt;SetObjectValue(value);</span>
<a name="l02681"></a>02681 <span class="comment">        }</span>
<a name="l02682"></a>02682 <span class="comment"></span>
<a name="l02683"></a>02683 <span class="comment">        virtual void setUpstream(Object* value);</span>
<a name="l02684"></a>02684 <span class="comment"></span>
<a name="l02685"></a>02685 <span class="comment">        PropertyValue* m_upStreamProperty;</span>
<a name="l02686"></a>02686 <span class="comment">};</span>
<a name="l02687"></a>02687 <span class="comment">*/</span>
<a name="l02688"></a>02688 
<a name="l02689"></a>02689 <span class="preprocessor">#if 0</span>
<a name="l02690"></a>02690 <span class="preprocessor"></span><span class="keyword">template</span>&lt;<span class="keyword">class</span> TYPE&gt; <span class="keyword">class </span>ComputedProperty
<a name="l02691"></a>02691 {
<a name="l02692"></a>02692 <span class="keyword">public</span>:
<a name="l02693"></a>02693 
<a name="l02694"></a>02694 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02695"></a>02695 <span class="preprocessor"></span>        CTOR ComputedProperty(<span class="keyword">const</span> DependencyObject* <span class="keywordtype">object</span>, <span class="keyword">const</span> DependencyProperty* dp) :
<a name="l02696"></a>02696                 m_object(object), m_dp(dp)
<a name="l02697"></a>02697         {
<a name="l02698"></a>02698         }
<a name="l02699"></a>02699 <span class="preprocessor">#endif</span>
<a name="l02700"></a>02700 <span class="preprocessor"></span>
<a name="l02701"></a>02701         operator TYPE ()<span class="keyword"> const</span>
<a name="l02702"></a>02702 <span class="keyword">        </span>{
<a name="l02703"></a>02703 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l02704"></a>02704 <span class="preprocessor"></span>                TYPE result = <span class="keyword">dynamic_cast&lt;</span>IFunction2T&lt;TYPE, DependencyObject*&gt;(m_dp-<span class="keyword">&gt;</span>m_function)-&gt;call(m_object);
<a name="l02705"></a>02705                 <span class="keywordflow">return</span> result;
<a name="l02706"></a>02706 <span class="preprocessor">#endif</span>
<a name="l02707"></a>02707 <span class="preprocessor"></span>        }
<a name="l02708"></a>02708 
<a name="l02709"></a>02709         <span class="keyword">const</span> DependencyObject* m_object;
<a name="l02710"></a>02710         <span class="keyword">const</span> DependencyProperty* m_dp;
<a name="l02711"></a>02711 };
<a name="l02712"></a>02712 <span class="preprocessor">#endif</span>
<a name="l02713"></a>02713 <span class="preprocessor"></span>
<a name="l02714"></a>02714 <span class="keyword">class </span>GUIEXT ColorRGBA : <span class="keyword">public</span> Color
<a name="l02715"></a>02715 {
<a name="l02716"></a>02716 <span class="keyword">public</span>:
<a name="l02717"></a>02717 
<a name="l02718"></a>02718 <span class="comment">//      DEPENDENCY_PROPERTY(float, Red)</span>
<a name="l02719"></a>02719 <span class="comment">//      DEPENDENCY_PROPERTY(float, Green)</span>
<a name="l02720"></a>02720 <span class="comment">//      DEPENDENCY_PROPERTY(float, Blue)</span>
<a name="l02721"></a>02721         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Alpha)
<a name="l02722"></a>02722 <span class="comment">/*</span>
<a name="l02723"></a>02723 <span class="comment">        // Computed</span>
<a name="l02724"></a>02724 <span class="comment">        TypedDependencyProperty&lt;float&gt; HueProperty;</span>
<a name="l02725"></a>02725 <span class="comment">        TypedDependencyProperty&lt;float&gt; LuminanceProperty;</span>
<a name="l02726"></a>02726 <span class="comment">        TypedDependencyProperty&lt;float&gt; SaturationProperty;</span>
<a name="l02727"></a>02727 <span class="comment">        */</span>
<a name="l02728"></a>02728 };
<a name="l02729"></a>02729 
<a name="l02730"></a>02730 }
<a name="l02731"></a>02731 }
<a name="l02732"></a>02732 
<a name="l02733"></a>02733 <span class="preprocessor">#include &quot;GradientStopCollection.h&quot;</span>
<a name="l02734"></a>02734 
<a name="l02735"></a>02735 <span class="preprocessor">#include &quot;Brush.h&quot;</span>
<a name="l02736"></a>02736 <span class="preprocessor">#include &quot;SolidColorBrush.h&quot;</span>
<a name="l02737"></a>02737 <span class="preprocessor">#include &quot;GradientBrush.h&quot;</span>
<a name="l02738"></a>02738 <span class="preprocessor">#include &quot;LinearGradientBrush.h&quot;</span>
<a name="l02739"></a>02739 <span class="preprocessor">#include &quot;RadialGradientBrush.h&quot;</span>
<a name="l02740"></a>02740 
<a name="l02741"></a>02741 <span class="keyword">namespace </span>System
<a name="l02742"></a>02742 {
<a name="l02743"></a>02743 <span class="keyword">namespace </span>Gui
<a name="l02744"></a>02744 {
<a name="l02745"></a>02745 
<a name="l02746"></a>02746 <span class="keyword">class </span>GUIEXT VisualBrush : <span class="keyword">public</span> Brush
<a name="l02747"></a>02747 {
<a name="l02748"></a>02748 <span class="keyword">public</span>:
<a name="l02749"></a>02749 };
<a name="l02750"></a>02750 
<a name="l02751"></a>02751 <span class="keyword">class </span>GUIEXT Pen : <span class="keyword">public</span> Object
<a name="l02752"></a>02752 {
<a name="l02753"></a>02753 <span class="keyword">public</span>:
<a name="l02754"></a>02754         CTOR Pen(Brush* brush, <span class="keywordtype">float</span> width = 1.0f);
<a name="l02755"></a>02755 
<a name="l02756"></a>02756         Brush* m_brush;
<a name="l02757"></a>02757         <span class="keywordtype">float</span> m_width;
<a name="l02758"></a>02758 };
<a name="l02759"></a>02759 
<a name="l02760"></a>02760 }
<a name="l02761"></a>02761 }
<a name="l02762"></a>02762 
<a name="l02763"></a>02763 <span class="comment">/*</span>
<a name="l02764"></a>02764 <span class="comment">class GUIEXT SubPath : public DependencyObject</span>
<a name="l02765"></a>02765 <span class="comment">{</span>
<a name="l02766"></a>02766 <span class="comment">public:</span>
<a name="l02767"></a>02767 <span class="comment">};</span>
<a name="l02768"></a>02768 <span class="comment">*/</span>
<a name="l02769"></a>02769 
<a name="l02770"></a>02770 <span class="preprocessor">#include &quot;PathSegment.h&quot;</span>
<a name="l02771"></a>02771 <span class="preprocessor">#include &quot;PathFigure.h&quot;</span>
<a name="l02772"></a>02772 <span class="preprocessor">#include &quot;LineToPathSegment.h&quot;</span>
<a name="l02773"></a>02773 <span class="preprocessor">#include &quot;CubicBezierToPathSegment.h&quot;</span>
<a name="l02774"></a>02774 
<a name="l02775"></a>02775 <span class="keyword">namespace </span>System
<a name="l02776"></a>02776 {
<a name="l02777"></a>02777 <span class="keyword">namespace </span>Gui
<a name="l02778"></a>02778 {
<a name="l02779"></a>02779 
<a name="l02780"></a>02780 <span class="keyword">class </span>GUIEXT PathData : <span class="keyword">public</span> Object
<a name="l02781"></a>02781 {
<a name="l02782"></a>02782 <span class="keyword">public</span>:
<a name="l02783"></a>02783         vector&lt;PathSegment*&gt; m_segments;
<a name="l02784"></a>02784         ID2D1PathGeometry* m_pGeometry;
<a name="l02785"></a>02785         <span class="keywordtype">bool</span> m_closed;
<a name="l02786"></a>02786 };
<a name="l02787"></a>02787 
<a name="l02788"></a>02788 <span class="preprocessor">#ifdef __LERSTAD__</span>
<a name="l02789"></a>02789 <span class="preprocessor"></span>
<a name="l02790"></a>02790 <span class="keyword">enum</span> D2D1_COMBINE_MODE
<a name="l02791"></a>02791 {
<a name="l02792"></a>02792         D2D1_COMBINE_MODE_UNION       = 0,
<a name="l02793"></a>02793         D2D1_COMBINE_MODE_INTERSECT   = 1,
<a name="l02794"></a>02794         D2D1_COMBINE_MODE_XOR         = 2,
<a name="l02795"></a>02795         D2D1_COMBINE_MODE_EXCLUDE     = 3,
<a name="l02796"></a>02796 };
<a name="l02797"></a>02797 
<a name="l02798"></a>02798 <span class="keyword">enum</span> D2D1_GEOMETRY_RELATION
<a name="l02799"></a>02799 {
<a name="l02800"></a>02800         D2D1_GEOMETRY_RELATION_UNKNOWN        = 0,
<a name="l02801"></a>02801         D2D1_GEOMETRY_RELATION_DISJOINT       = 1,
<a name="l02802"></a>02802         D2D1_GEOMETRY_RELATION_IS_CONTAINED   = 2,
<a name="l02803"></a>02803         D2D1_GEOMETRY_RELATION_CONTAINS       = 3,
<a name="l02804"></a>02804         D2D1_GEOMETRY_RELATION_OVERLAP        = 4 
<a name="l02805"></a>02805 };
<a name="l02806"></a>02806 
<a name="l02807"></a>02807 <span class="preprocessor">#endif</span>
<a name="l02808"></a>02808 <span class="preprocessor"></span>
<a name="l02809"></a>02809 }
<a name="l02810"></a>02810 }
<a name="l02811"></a>02811 
<a name="l02812"></a>02812 <span class="preprocessor">#include &quot;Geometry.h&quot;</span>
<a name="l02813"></a>02813 <span class="preprocessor">#include &quot;RectangleGeometry.h&quot;</span>
<a name="l02814"></a>02814 <span class="preprocessor">#include &quot;RoundedRectangleGeometry.h&quot;</span>
<a name="l02815"></a>02815 
<a name="l02816"></a>02816 <span class="keyword">namespace </span>System
<a name="l02817"></a>02817 {
<a name="l02818"></a>02818 <span class="keyword">namespace </span>Gui
<a name="l02819"></a>02819 {
<a name="l02820"></a>02820 
<a name="l02821"></a>02821 <span class="keyword">enum</span> FillMode
<a name="l02822"></a>02822 {
<a name="l02823"></a>02823         FillMode_Alternate,
<a name="l02824"></a>02824         FillMode_Winding,
<a name="l02825"></a>02825 };
<a name="l02826"></a>02826 
<a name="l02827"></a>02827 <span class="keyword">class </span>GUIEXT PolygonGeometry : <span class="keyword">public</span> Geometry
<a name="l02828"></a>02828 {
<a name="l02829"></a>02829 <span class="keyword">public</span>:
<a name="l02830"></a>02830         CTOR PolygonGeometry();
<a name="l02831"></a>02831         CTOR PolygonGeometry(<span class="keywordtype">float</span> cx, <span class="keywordtype">float</span> cy, <span class="keywordtype">float</span> rx, <span class="keywordtype">float</span> ry);
<a name="l02832"></a>02832 
<a name="l02833"></a>02833         <span class="keyword">virtual</span> ID2D1PathGeometry* GetD2DGeometry() <span class="keyword">override</span>;
<a name="l02834"></a>02834         <span class="keyword">virtual</span> HRGN CreateHRGN() <span class="keyword">override</span>;
<a name="l02835"></a>02835 
<a name="l02836"></a>02836         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnComputedPropertyValueChanged(PropertyValue* pPropertyVal, <span class="keywordtype">bool</span> handled) <span class="keyword">override</span>;
<a name="l02837"></a>02837 
<a name="l02838"></a>02838 <span class="comment">//      DEPENDENCY_CLASS(PolygonGeometry, Geometry)</span>
<a name="l02839"></a>02839 
<a name="l02840"></a>02840         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l02841"></a>02841         <span class="keyword">static</span> DependencyClass* pClass;
<a name="l02842"></a>02842 
<a name="l02843"></a>02843         vector&lt;gm::PointF&gt; m_points;    <span class="comment">// TODO</span>
<a name="l02844"></a>02844 
<a name="l02845"></a>02845         DEPENDENCY_PROPERTY(FillMode, FillMode)
<a name="l02846"></a>02846 
<a name="l02847"></a>02847 protected:
<a name="l02848"></a>02848 
<a name="l02849"></a>02849         ID2D1PathGeometry* m_D2DGeometry;
<a name="l02850"></a>02850 };
<a name="l02851"></a>02851 
<a name="l02852"></a>02852 }
<a name="l02853"></a>02853 }
<a name="l02854"></a>02854 
<a name="l02855"></a>02855 <span class="preprocessor">#include &quot;EllipseGeometry.h&quot;</span>
<a name="l02856"></a>02856 <span class="preprocessor"></span><span class="preprocessor">#include &quot;PathGeometry.h&quot;</span>
<a name="l02857"></a>02857 <span class="preprocessor">#include &quot;CompoundGeometry.h&quot;</span>
<a name="l02858"></a>02858 
<a name="l02859"></a>02859 <span class="keyword">namespace </span>System
<a name="l02860"></a>02860 {
<a name="l02861"></a>02861 <span class="keyword">namespace </span>Gui
<a name="l02862"></a>02862 {
<a name="l02863"></a>02863 
<a name="l02864"></a>02864 <span class="keyword">class </span>GUIEXT StyleSheet : <span class="keyword">public</span> Object, <span class="keyword">public</span> Style::IStyleSheet
<a name="l02865"></a>02865 {
<a name="l02866"></a>02866 <span class="keyword">public</span>:
<a name="l02867"></a>02867 
<a name="l02868"></a>02868         <span class="keyword">virtual</span> Style::IStyleDeclaration* CreateDeclaration() <span class="keyword">override</span>;
<a name="l02869"></a>02869         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddRules(Style::SelectorList* selectors, Style::IStyleDeclaration* declaration) <span class="keyword">override</span>;
<a name="l02870"></a>02870 
<a name="l02871"></a>02871         <span class="comment">/*</span>
<a name="l02872"></a>02872 <span class="comment">        virtual void MatchElement(Style::CSSElementMatches* matches, Style::ICSSElementResolver* element)</span>
<a name="l02873"></a>02873 <span class="comment">        {</span>
<a name="l02874"></a>02874 <span class="comment">        }</span>
<a name="l02875"></a>02875 <span class="comment"></span>
<a name="l02876"></a>02876 <span class="comment">        virtual void GetStyleSheetMatches(Style::CSSElementMatches* matches, Style::ICSSElementResolver* pPElement)</span>
<a name="l02877"></a>02877 <span class="comment">        {</span>
<a name="l02878"></a>02878 <span class="comment">        }</span>
<a name="l02879"></a>02879 <span class="comment">*/</span>
<a name="l02880"></a>02880 
<a name="l02881"></a>02881         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetRuleCount()<span class="keyword"> override</span>
<a name="l02882"></a>02882 <span class="keyword">        </span>{
<a name="l02883"></a>02883                 <span class="keywordflow">return</span> m_rules.size();
<a name="l02884"></a>02884         }
<a name="l02885"></a>02885 
<a name="l02886"></a>02886         <span class="keyword">virtual</span> Style::ICSSRule* GetRule(<span class="keywordtype">size_t</span> index)<span class="keyword"> override</span>
<a name="l02887"></a>02887 <span class="keyword">        </span>{
<a name="l02888"></a>02888                 <span class="keywordflow">return</span> m_rules[index];
<a name="l02889"></a>02889         }
<a name="l02890"></a>02890 
<a name="l02891"></a>02891         vector&lt;Style::ICSSRule*&gt; m_rules;
<a name="l02892"></a>02892 };
<a name="l02893"></a>02893 
<a name="l02894"></a>02894 <span class="keyword">class </span>GUIEXT CSSStyleRule : <span class="keyword">public</span> Object, <span class="keyword">public</span> Style::ICSSStyleRule
<a name="l02895"></a>02895 {
<a name="l02896"></a>02896 <span class="keyword">public</span>:
<a name="l02897"></a>02897 
<a name="l02898"></a>02898         CTOR CSSStyleRule(Style::SelectorList* selectors, Style::IStyleDeclaration* declaration) :
<a name="l02899"></a>02899                 m_selectors(selectors),
<a name="l02900"></a>02900                 m_declaration(declaration)
<a name="l02901"></a>02901         {
<a name="l02902"></a>02902         }
<a name="l02903"></a>02903 
<a name="l02904"></a>02904         Style::CSSType get_type()<span class="keyword"> override</span>
<a name="l02905"></a>02905 <span class="keyword">        </span>{
<a name="l02906"></a>02906                 <span class="keywordflow">return</span> Style::STYLE_RULE;
<a name="l02907"></a>02907         }
<a name="l02908"></a>02908 
<a name="l02909"></a>02909         Style::SelectorList* get_selectorList()
<a name="l02910"></a>02910         {
<a name="l02911"></a>02911                 <span class="keywordflow">return</span> m_selectors;
<a name="l02912"></a>02912         }
<a name="l02913"></a>02913 
<a name="l02914"></a>02914         Style::IStyleDeclaration* get_declaration()<span class="keyword"> override</span>
<a name="l02915"></a>02915 <span class="keyword">        </span>{
<a name="l02916"></a>02916                 <span class="keywordflow">return</span> m_declaration;
<a name="l02917"></a>02917         }
<a name="l02918"></a>02918 
<a name="l02919"></a>02919         Style::SelectorList* m_selectors;
<a name="l02920"></a>02920         Style::IStyleDeclaration* m_declaration;
<a name="l02921"></a>02921 };
<a name="l02922"></a>02922 
<a name="l02923"></a>02923 <span class="keyword">class </span>PropertyValuePair
<a name="l02924"></a>02924 {
<a name="l02925"></a>02925 <span class="keyword">public</span>:
<a name="l02926"></a>02926         DependencyProperty* m_dp;
<a name="l02927"></a>02927         Object* m_value;
<a name="l02928"></a>02928 };
<a name="l02929"></a>02929 
<a name="l02930"></a>02930 <span class="keyword">class </span>GUIEXT CSSDeclaration : <span class="keyword">public</span> Object, <span class="keyword">public</span> Style::IStyleDeclaration
<a name="l02931"></a>02931 {
<a name="l02932"></a>02932 <span class="keyword">public</span>:
<a name="l02933"></a>02933 
<a name="l02934"></a>02934         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetProperty(StringIn prefix, StringIn name, StringIn strvalue) <span class="keyword">override</span>;   <span class="comment">// IStyleDeclaration</span>
<a name="l02935"></a>02935         <span class="keyword">virtual</span> Object* GetPropertyValue(Object* pProperty) <span class="keyword">override</span>    <span class="comment">// IStyleDeclaration</span>
<a name="l02936"></a>02936         {
<a name="l02937"></a>02937                 <span class="keywordflow">return</span> GetPropertyValue((DependencyProperty*)pProperty);
<a name="l02938"></a>02938         }
<a name="l02939"></a>02939         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> HasProperty(Object* dp) <span class="keyword">override</span>;
<a name="l02940"></a>02940 
<a name="l02941"></a>02941         Object* GetPropertyValue(DependencyProperty* dp);
<a name="l02942"></a>02942 
<a name="l02943"></a>02943         vector&lt;PropertyValuePair&gt; m_props;
<a name="l02944"></a>02944 };
<a name="l02945"></a>02945 
<a name="l02946"></a>02946 <span class="keyword">class </span>GUIEXT ObjectBinding : <span class="keyword">public</span> Object
<a name="l02947"></a>02947 {
<a name="l02948"></a>02948 <span class="keyword">public</span>:
<a name="l02949"></a>02949         <span class="keyword">virtual</span> Object* GetPropertyValue(DependencyProperty* dp) = 0;
<a name="l02950"></a>02950         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> HasProperty(DependencyProperty* dp) = 0;
<a name="l02951"></a>02951 };
<a name="l02952"></a>02952 
<a name="l02953"></a>02953 <span class="keyword">class </span>GUIEXT CSSObjectBinding : <span class="keyword">public</span> ObjectBinding
<a name="l02954"></a>02954 {
<a name="l02955"></a>02955 <span class="keyword">public</span>:
<a name="l02956"></a>02956 
<a name="l02957"></a>02957         <span class="keyword">virtual</span> Object* GetPropertyValue(DependencyProperty* dp) <span class="keyword">override</span>;
<a name="l02958"></a>02958         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> HasProperty(DependencyProperty* dp) <span class="keyword">override</span>;
<a name="l02959"></a>02959 
<a name="l02960"></a>02960         Style::CSSElementMatches* m_ruleMatches;
<a name="l02961"></a>02961 };
<a name="l02962"></a>02962 
<a name="l02963"></a>02963 <span class="keyword">interface </span>ITreeViewController;
<a name="l02964"></a>02964 
<a name="l02965"></a>02965 <span class="keyword">class </span>GUIEXT TreeItem
<a name="l02966"></a>02966 {
<a name="l02967"></a>02967 <span class="keyword">public</span>:
<a name="l02968"></a>02968         CTOR TreeItem(ITreeViewController* _controller, Object* _data0)  :
<a name="l02969"></a>02969                 controller(_controller), data0(_data0), data1(0)
<a name="l02970"></a>02970         {
<a name="l02971"></a>02971         }
<a name="l02972"></a>02972 
<a name="l02973"></a>02973         CTOR TreeItem() : controller(nullptr), data0(nullptr), data1(0)
<a name="l02974"></a>02974         {
<a name="l02975"></a>02975         }
<a name="l02976"></a>02976 
<a name="l02977"></a>02977         ITreeViewController* controller;
<a name="l02978"></a>02978         Object* data0;
<a name="l02979"></a>02979         <span class="keywordtype">int</span> data1;
<a name="l02980"></a>02980 };
<a name="l02981"></a>02981 
<a name="l02982"></a>02982 <span class="keyword">interface </span>ITreeViewController
<a name="l02983"></a>02983 {
<a name="l02984"></a>02984         <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetItemHeight(TreeItem item) = 0;
<a name="l02985"></a>02985         <span class="keyword">virtual</span> <span class="keywordtype">int</span> GetItemState(TreeItem item) = 0;
<a name="l02986"></a>02986         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderItem(TreeItem item, ManagedRenderContext renderContext, gm::RectF bounds) = 0;
<a name="l02987"></a>02987         <span class="keyword">virtual</span> <span class="keywordtype">int</span> ClickItem(TreeItem item, gm::RectF bounds, gm::PointF pos) = 0;
<a name="l02988"></a>02988         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetChildrenCount(TreeItem item) = 0;
<a name="l02989"></a>02989         <span class="keyword">virtual</span> TreeItem GetRoot() = 0;
<a name="l02990"></a>02990         <span class="keyword">virtual</span> TreeItem GetChild(TreeItem item, <span class="keywordtype">size_t</span> index) = 0;
<a name="l02991"></a>02991 };
<a name="l02992"></a>02992 
<a name="l02993"></a>02993 <span class="preprocessor">#if 0</span>
<a name="l02994"></a>02994 <span class="preprocessor"></span><span class="keyword">class </span>GUIEXT UIStyle : <span class="keyword">public</span> DependencyObject
<a name="l02995"></a>02995 {
<a name="l02996"></a>02996 <span class="keyword">public</span>:
<a name="l02997"></a>02997 <span class="comment">//      virtual Visual* CreateVisual(UIElement* element);</span>
<a name="l02998"></a>02998 
<a name="l02999"></a>02999         <span class="keyword">virtual</span> GetPropertyValue(DependencyObject* depobj, DependencyProperty* dp) = 0;
<a name="l03000"></a>03000 };
<a name="l03001"></a>03001 <span class="preprocessor">#endif</span>
<a name="l03002"></a>03002 <span class="preprocessor"></span>
<a name="l03003"></a>03003 <span class="keyword">class </span>ElementVisuals;
<a name="l03004"></a>03004 
<a name="l03005"></a>03005 <span class="keyword">class </span>GUIEXT Element : <span class="keyword">public</span> DependencyObject, <span class="keyword">protected</span> Style::ICSSElementResolver
<a name="l03006"></a>03006 {
<a name="l03007"></a>03007 <span class="keyword">protected</span>:
<a name="l03008"></a>03008 
<a name="l03009"></a>03009         CTOR Element(DependencyClass* depClass);
<a name="l03010"></a>03010 
<a name="l03011"></a>03011 <span class="keyword">public</span>:
<a name="l03012"></a>03012 
<a name="l03013"></a>03013 <span class="comment">//      virtual Element* GetParent();</span>
<a name="l03014"></a>03014 
<a name="l03015"></a>03015         IRootVisual* GetRoot()
<a name="l03016"></a>03016         {
<a name="l03017"></a>03017                 <span class="keywordflow">return</span> m_root;
<a name="l03018"></a>03018         }
<a name="l03019"></a>03019 
<a name="l03020"></a>03020         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetRoot(IRootVisual* root);
<a name="l03021"></a>03021 
<a name="l03022"></a>03022 <span class="comment">//</span>
<a name="l03023"></a>03023 
<a name="l03024"></a>03024         <span class="keyword">virtual</span> String get_typeName() <span class="keyword">override</span>;
<a name="l03025"></a>03025         <span class="keyword">virtual</span> String get_namespaceURI() <span class="keyword">override</span>;
<a name="l03026"></a>03026         <span class="keyword">virtual</span> String get_id() <span class="keyword">override</span>;
<a name="l03027"></a>03027         <span class="keyword">virtual</span> String get_pseudoElementName() <span class="keyword">override</span>;        <span class="comment">// ??</span>
<a name="l03028"></a>03028         <span class="keyword">virtual</span> String getAttribute(StringIn name) <span class="keyword">override</span>;
<a name="l03029"></a>03029         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> hasAttribute(StringIn name) <span class="keyword">override</span>;
<a name="l03030"></a>03030         <span class="keyword">virtual</span> Style::ICSSElementResolver* get_rparent() <span class="keyword">override</span>;
<a name="l03031"></a>03031         <span class="keyword">virtual</span> Style::ICSSElementResolver* get_prevSibling() <span class="keyword">override</span>;
<a name="l03032"></a>03032         <span class="keyword">virtual</span> Style::ICSSElementResolver* get_nextSibling() <span class="keyword">override</span>;
<a name="l03033"></a>03033         <span class="keyword">virtual</span> Style::IStyleDeclaration* get_inlineStyle(uint index) <span class="keyword">override</span>;
<a name="l03034"></a>03034 
<a name="l03035"></a>03035         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsInherited(Object* pProperty) <span class="keyword">override</span>;
<a name="l03036"></a>03036         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValueInherit(Object* value) <span class="keyword">override</span>;
<a name="l03037"></a>03037 <span class="comment">//</span>
<a name="l03038"></a>03038 
<a name="l03039"></a>03039         DEPENDENCY_CLASS_ABSTRACT(Element, DependencyObject)
<a name="l03040"></a>03040         <span class="comment">//static DependencyClass* get_Class();</span>
<a name="l03041"></a>03041 
<a name="l03042"></a>03042         DEFINE_THIS(_Element)
<a name="l03043"></a>03043 
<a name="l03044"></a>03044         DEPENDENCY_PROPERTY(String, ID)
<a name="l03045"></a>03045 
<a name="l03046"></a>03046 protected:
<a name="l03047"></a>03047 
<a name="l03048"></a>03048 <span class="comment">//      virtual Visual* CreateVisual(); // Called only once</span>
<a name="l03049"></a>03049 <span class="comment">//      virtual void RenderVisual();    // Called when to update contents of m_visual</span>
<a name="l03050"></a>03050 
<a name="l03051"></a>03051         virtual <span class="keywordtype">void</span> OnSetRoot(IRootVisual* root)
<a name="l03052"></a>03052         {
<a name="l03053"></a>03053         }
<a name="l03054"></a>03054 
<a name="l03055"></a>03055         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderRetained(ManagedRetainedRenderContext renderContext);
<a name="l03056"></a>03056 
<a name="l03057"></a>03057 <span class="comment">//private:</span>
<a name="l03058"></a>03058 <span class="keyword">public</span>:
<a name="l03059"></a>03059 
<a name="l03060"></a>03060         IRootVisual* m_root;
<a name="l03061"></a>03061 };
<a name="l03062"></a>03062 
<a name="l03063"></a>03063 <span class="keyword">class </span>GUIEXT _Element : <span class="keyword">public</span> _DependencyObject
<a name="l03064"></a>03064 {
<a name="l03065"></a>03065 <span class="keyword">public</span>:
<a name="l03066"></a>03066 
<a name="l03067"></a>03067         CTOR _Element(<span class="keyword">const</span> Expressive::expression&amp; exp) : _DependencyObject(exp)
<a name="l03068"></a>03068         {
<a name="l03069"></a>03069         }
<a name="l03070"></a>03070 
<a name="l03071"></a>03071         <span class="comment">/*</span>
<a name="l03072"></a>03072 <span class="comment">        Expressive::typed_expression&lt;float&gt; getOpacity() const</span>
<a name="l03073"></a>03073 <span class="comment">        {</span>
<a name="l03074"></a>03074 <span class="comment">                return getProperty(Element::OpacityProperty);</span>
<a name="l03075"></a>03075 <span class="comment">        }</span>
<a name="l03076"></a>03076 <span class="comment"></span>
<a name="l03077"></a>03077 <span class="comment">        Expressive::typed_expression&lt;Geometry*&gt; getClip() const</span>
<a name="l03078"></a>03078 <span class="comment">        {</span>
<a name="l03079"></a>03079 <span class="comment">                return getProperty(Element::ClipProperty);</span>
<a name="l03080"></a>03080 <span class="comment">        }</span>
<a name="l03081"></a>03081 <span class="comment">        */</span>
<a name="l03082"></a>03082 
<a name="l03083"></a>03083 <span class="comment">//      _UIElement getTemplatedOwner() const;</span>
<a name="l03084"></a>03084 
<a name="l03085"></a>03085         _Window getOwnerWindow() <span class="keyword">const</span>;
<a name="l03086"></a>03086 };
<a name="l03087"></a>03087 
<a name="l03088"></a>03088 <span class="preprocessor">#if 0</span>
<a name="l03089"></a>03089 <span class="preprocessor"></span><span class="keyword">class </span>GUIEXT HIconVisual : <span class="keyword">public</span> Visual
<a name="l03090"></a>03090 {
<a name="l03091"></a>03091 <span class="keyword">public</span>:
<a name="l03092"></a>03092 
<a name="l03093"></a>03093         CTOR HIconVisual();
<a name="l03094"></a>03094 
<a name="l03095"></a>03095         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext);
<a name="l03096"></a>03096 
<a name="l03097"></a>03097         DEFINE_CLASS()
<a name="l03098"></a>03098 
<a name="l03099"></a>03099         HICON m_hIcon;
<a name="l03100"></a>03100         <span class="comment">//ID2D1Bitmap* m_D2DBitmap;</span>
<a name="l03101"></a>03101         LDraw::Bitmap* m_bitmap;
<a name="l03102"></a>03102 };
<a name="l03103"></a>03103 <span class="preprocessor">#endif</span>
<a name="l03104"></a>03104 <span class="preprocessor"></span>
<a name="l03105"></a>03105 }
<a name="l03106"></a>03106 }
<a name="l03107"></a>03107 
<a name="l03108"></a>03108 <span class="preprocessor">#include &quot;Visual.h&quot;</span>
<a name="l03109"></a>03109 <span class="preprocessor">#include &quot;VisualTreeController.h&quot;</span>
<a name="l03110"></a>03110 
<a name="l03111"></a>03111 <span class="keyword">namespace </span>System
<a name="l03112"></a>03112 {
<a name="l03113"></a>03113 <span class="keyword">namespace </span>Gui
<a name="l03114"></a>03114 {
<a name="l03115"></a>03115 
<a name="l03116"></a>03116 <span class="preprocessor">#if 0</span>
<a name="l03117"></a>03117 <span class="preprocessor"></span><span class="keyword">class </span>_TransformVisual;
<a name="l03118"></a>03118 
<a name="l03119"></a>03119 
<a name="l03120"></a>03120 <span class="keyword">class </span>GUIEXT DecoratorTransformVisual : <span class="keyword">public</span> UIElement
<a name="l03121"></a>03121 {
<a name="l03122"></a>03122 <span class="keyword">public</span>:
<a name="l03123"></a>03123 
<a name="l03124"></a>03124         CTOR TransformVisual();
<a name="l03125"></a>03125 
<a name="l03126"></a>03126         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l03127"></a>03127 <span class="comment">//      virtual UIElement* HitTest(LDraw::PointF point) override;</span>
<a name="l03128"></a>03128 
<a name="l03129"></a>03129         DEFINE_THIS(_TransformVisual)
<a name="l03130"></a>03130 
<a name="l03131"></a>03131 <span class="comment">//      DEPENDENCY_CLASS(TransformVisual, Visual)</span>
<a name="l03132"></a>03132         static DependencyClass* get_Class();
<a name="l03133"></a>03133         static DependencyClass* baseClass;
<a name="l03134"></a>03134         typedef UIElement baseClass;
<a name="l03135"></a>03135 
<a name="l03136"></a>03136         DEPENDENCY_PROPERTY(Visual*, Child)
<a name="l03137"></a>03137 <span class="comment">//      DEPENDENCY_PROPERTY(Transform*, Transform)</span>
<a name="l03138"></a>03138 };
<a name="l03139"></a>03139 
<a name="l03140"></a>03140 class GUIEXT _TransformVisual : public _Visual
<a name="l03141"></a>03141 {
<a name="l03142"></a>03142 <span class="keyword">public</span>:
<a name="l03143"></a>03143 
<a name="l03144"></a>03144         <span class="comment">/*</span>
<a name="l03145"></a>03145 <span class="comment">        Expressive::typed_expression&lt;Visual*&gt; getChild() const</span>
<a name="l03146"></a>03146 <span class="comment">        {</span>
<a name="l03147"></a>03147 <span class="comment">                return getProperty(ChildProperty);</span>
<a name="l03148"></a>03148 <span class="comment">        }</span>
<a name="l03149"></a>03149 <span class="comment">        */</span>
<a name="l03150"></a>03150 
<a name="l03151"></a>03151         Expressive::typed_expression&lt;Transform*&gt; getTransform()<span class="keyword"> const</span>
<a name="l03152"></a>03152 <span class="keyword">        </span>{
<a name="l03153"></a>03153                 <span class="keywordflow">return</span> getProperty(TransformVisual::get_TransformProperty());
<a name="l03154"></a>03154         }
<a name="l03155"></a>03155 };
<a name="l03156"></a>03156 <span class="preprocessor">#endif</span>
<a name="l03157"></a>03157 <span class="preprocessor"></span>
<a name="l03158"></a>03158 <span class="comment">/*</span>
<a name="l03159"></a>03159 <span class="comment">class GUIEXT Mesh : public Object</span>
<a name="l03160"></a>03160 <span class="comment">{</span>
<a name="l03161"></a>03161 <span class="comment">public:</span>
<a name="l03162"></a>03162 <span class="comment">        ID3DX10Mesh* m_d3d10_mesh;</span>
<a name="l03163"></a>03163 <span class="comment">};</span>
<a name="l03164"></a>03164 <span class="comment">*/</span>
<a name="l03165"></a>03165 
<a name="l03166"></a>03166 <span class="comment">/*</span>
<a name="l03167"></a>03167 <span class="comment">class GUIEXT TriangleStrip : public Visual</span>
<a name="l03168"></a>03168 <span class="comment">{</span>
<a name="l03169"></a>03169 <span class="comment">public:</span>
<a name="l03170"></a>03170 <span class="comment"></span>
<a name="l03171"></a>03171 <span class="comment">        virtual void Render(RenderTarget* rt);</span>
<a name="l03172"></a>03172 <span class="comment"></span>
<a name="l03173"></a>03173 <span class="comment">        vector&lt;float3&gt; m_vertices;</span>
<a name="l03174"></a>03174 <span class="comment">};</span>
<a name="l03175"></a>03175 <span class="comment"></span>
<a name="l03176"></a>03176 <span class="comment">class GUIEXT IndexedFaceSet : public Visual</span>
<a name="l03177"></a>03177 <span class="comment">{</span>
<a name="l03178"></a>03178 <span class="comment">public:</span>
<a name="l03179"></a>03179 <span class="comment"></span>
<a name="l03180"></a>03180 <span class="comment">        virtual void Render(RenderTarget* rt);</span>
<a name="l03181"></a>03181 <span class="comment"></span>
<a name="l03182"></a>03182 <span class="comment">        vector&lt;float3&gt; m_vertices;</span>
<a name="l03183"></a>03183 <span class="comment">        vector&lt;int&gt; m_indices;</span>
<a name="l03184"></a>03184 <span class="comment">};</span>
<a name="l03185"></a>03185 <span class="comment">*/</span>
<a name="l03186"></a>03186 
<a name="l03187"></a>03187 <span class="keyword">class </span>GUIEXT VisualInstance : <span class="keyword">public</span> Visual
<a name="l03188"></a>03188 {
<a name="l03189"></a>03189 <span class="keyword">public</span>:
<a name="l03190"></a>03190 
<a name="l03191"></a>03191         CTOR VisualInstance() : Visual(get_Class())
<a name="l03192"></a>03192         {
<a name="l03193"></a>03193         }
<a name="l03194"></a>03194 
<a name="l03195"></a>03195         CTOR VisualInstance(Visual* visual) : Visual(get_Class()), m_visual(visual)
<a name="l03196"></a>03196         {
<a name="l03197"></a>03197         }
<a name="l03198"></a>03198 
<a name="l03199"></a>03199         DEPENDENCY_CLASS(VisualInstance, Visual)
<a name="l03200"></a>03200 
<a name="l03201"></a>03201         virtual <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) override;
<a name="l03202"></a>03202 
<a name="l03203"></a>03203         Visual* m_visual;
<a name="l03204"></a>03204 };
<a name="l03205"></a>03205 
<a name="l03206"></a>03206 class Visuals;
<a name="l03207"></a>03207 
<a name="l03208"></a>03208 <span class="comment">/*</span>
<a name="l03209"></a>03209 <span class="comment">class GUIEXT ElementVisuals : public Visuals</span>
<a name="l03210"></a>03210 <span class="comment">{</span>
<a name="l03211"></a>03211 <span class="comment">public:</span>
<a name="l03212"></a>03212 <span class="comment">        CTOR ElementVisuals();</span>
<a name="l03213"></a>03213 <span class="comment"></span>
<a name="l03214"></a>03214 <span class="comment">//      virtual void Add(Visual* visual);</span>
<a name="l03215"></a>03215 <span class="comment"></span>
<a name="l03216"></a>03216 <span class="comment">        virtual void Render(ManagedRenderContext renderContext) override;</span>
<a name="l03217"></a>03217 <span class="comment">        virtual UIElement* HitTest(LDraw::PointF point) override;</span>
<a name="l03218"></a>03218 <span class="comment"></span>
<a name="l03219"></a>03219 <span class="comment">        Element* m_element;</span>
<a name="l03220"></a>03220 <span class="comment"></span>
<a name="l03221"></a>03221 <span class="comment">        static DependencyClass* get_Class();</span>
<a name="l03222"></a>03222 <span class="comment">        static DependencyClass* pClass;</span>
<a name="l03223"></a>03223 <span class="comment"></span>
<a name="l03224"></a>03224 <span class="comment">//      DEPENDENCY_CLASS(ElementVisuals, Visuals)</span>
<a name="l03225"></a>03225 <span class="comment">};</span>
<a name="l03226"></a>03226 <span class="comment">*/</span>
<a name="l03227"></a>03227 
<a name="l03228"></a>03228 }
<a name="l03229"></a>03229 }
<a name="l03230"></a>03230 
<a name="l03231"></a>03231 <span class="preprocessor">#include &quot;VisualCollection.h&quot;</span>
<a name="l03232"></a>03232 <span class="preprocessor"></span>
<a name="l03233"></a>03233 <span class="keyword">namespace </span>System
<a name="l03234"></a>03234 {
<a name="l03235"></a>03235 <span class="keyword">namespace </span>Gui
<a name="l03236"></a>03236 {
<a name="l03237"></a>03237 
<a name="l03238"></a>03238         <span class="comment">/*</span>
<a name="l03239"></a>03239 <span class="comment">class GUIEXT FontFamily : public DependencyObject</span>
<a name="l03240"></a>03240 <span class="comment">{</span>
<a name="l03241"></a>03241 <span class="comment">public:</span>
<a name="l03242"></a>03242 <span class="comment"></span>
<a name="l03243"></a>03243 <span class="comment">        CTOR FontFamily();</span>
<a name="l03244"></a>03244 <span class="comment">        CTOR FontFamily(StringIn name);</span>
<a name="l03245"></a>03245 <span class="comment"></span>
<a name="l03246"></a>03246 <span class="comment">        static DependencyClass* get_Class();</span>
<a name="l03247"></a>03247 <span class="comment">        static DependencyClass* pClass;</span>
<a name="l03248"></a>03248 <span class="comment"></span>
<a name="l03249"></a>03249 <span class="comment">        DEPENDENCY_PROPERTY(String, Name)</span>
<a name="l03250"></a>03250 <span class="comment">};</span>
<a name="l03251"></a>03251 <span class="comment">*/</span>
<a name="l03252"></a>03252 
<a name="l03253"></a>03253 GUIEXT <span class="keywordtype">void</span> Edit(TextDocument* td);
<a name="l03254"></a>03254 
<a name="l03255"></a>03255 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l03256"></a>03256 <span class="keyword">class </span>Vector2 : <span class="keyword">public</span> DependencyObject
<a name="l03257"></a>03257 {
<a name="l03258"></a>03258 <span class="keyword">public</span>:
<a name="l03259"></a>03259 
<a name="l03260"></a>03260         CTOR Vector2() : DependencyObject(get_Class())
<a name="l03261"></a>03261         {
<a name="l03262"></a>03262         }
<a name="l03263"></a>03263 
<a name="l03264"></a>03264         CTOR Vector2(typed&lt;float&gt; x, typed&lt;float&gt; y) : DependencyObject(get_Class())
<a name="l03265"></a>03265         {
<a name="l03266"></a>03266                 SetBinding(<span class="keyword">this</span>, get_XProperty(), x);
<a name="l03267"></a>03267                 SetBinding(<span class="keyword">this</span>, get_YProperty(), y);
<a name="l03268"></a>03268         }
<a name="l03269"></a>03269 
<a name="l03270"></a>03270 <span class="comment">//      DEPENDENCY_CLASS(Vector2&lt;T&gt;, DependencyObject)</span>
<a name="l03271"></a>03271 
<a name="l03272"></a>03272         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l03273"></a>03273         <span class="keyword">typedef</span> DependencyObject baseClass;
<a name="l03274"></a>03274         <span class="keyword">typedef</span> Vector2&lt;T&gt; thisClass;
<a name="l03275"></a>03275 
<a name="l03276"></a>03276         DEPENDENCY_PROPERTY(T, X)
<a name="l03277"></a>03277         DEPENDENCY_PROPERTY(T, Y)
<a name="l03278"></a>03278 
<a name="l03279"></a>03279 private:
<a name="l03280"></a>03280 
<a name="l03281"></a>03281         static DependencyClass* pClass;
<a name="l03282"></a>03282 };
<a name="l03283"></a>03283 
<a name="l03284"></a>03284 <span class="preprocessor">#ifndef GUI_EXPORTS</span>
<a name="l03285"></a>03285 <span class="preprocessor"></span><span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l03286"></a>03286 <span class="preprocessor"></span>
<a name="l03287"></a>03287 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector2&lt;unsigned char&gt;;
<a name="l03288"></a>03288 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector2&lt;int&gt;;
<a name="l03289"></a>03289 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector2&lt;float&gt;;
<a name="l03290"></a>03290 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector2&lt;double&gt;;
<a name="l03291"></a>03291 
<a name="l03292"></a>03292 <span class="preprocessor">#endif</span>
<a name="l03293"></a>03293 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l03294"></a>03294 <span class="preprocessor"></span>
<a name="l03295"></a>03295 <span class="keyword">typedef</span> Vector2&lt;unsigned char&gt; Vector2_B;
<a name="l03296"></a>03296 <span class="keyword">typedef</span> Vector2&lt;int&gt; Vector2_I;
<a name="l03297"></a>03297 <span class="keyword">typedef</span> Vector2&lt;long long&gt; Vector2_L;
<a name="l03298"></a>03298 <span class="keyword">typedef</span> Vector2&lt;float&gt; Vector2_F;
<a name="l03299"></a>03299 <span class="keyword">typedef</span> Vector2&lt;double&gt; Vector2_D;
<a name="l03300"></a>03300 
<a name="l03301"></a>03301 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l03302"></a>03302 <span class="keyword">class </span>Vector3 : <span class="keyword">public</span> DependencyObject
<a name="l03303"></a>03303 {
<a name="l03304"></a>03304 <span class="keyword">public</span>:
<a name="l03305"></a>03305 
<a name="l03306"></a>03306         CTOR Vector3() : DependencyObject(get_Class())
<a name="l03307"></a>03307         {
<a name="l03308"></a>03308         }
<a name="l03309"></a>03309 
<a name="l03310"></a>03310         CTOR Vector3(gm::vector3&lt;T&gt; v) : DependencyObject(get_Class())
<a name="l03311"></a>03311         {
<a name="l03312"></a>03312                 set_X(v[0]);
<a name="l03313"></a>03313                 set_Y(v[1]);
<a name="l03314"></a>03314                 set_Z(v[2]);
<a name="l03315"></a>03315         }
<a name="l03316"></a>03316 
<a name="l03317"></a>03317         CTOR Vector3(typed&lt;float&gt; x, typed&lt;float&gt; y, typed&lt;float&gt; z) : DependencyObject(get_Class())
<a name="l03318"></a>03318         {
<a name="l03319"></a>03319                 SetBinding(<span class="keyword">this</span>, get_XProperty(), x);
<a name="l03320"></a>03320                 SetBinding(<span class="keyword">this</span>, get_YProperty(), y);
<a name="l03321"></a>03321                 SetBinding(<span class="keyword">this</span>, get_ZProperty(), z);
<a name="l03322"></a>03322         }
<a name="l03323"></a>03323 
<a name="l03324"></a>03324         gm::vector3&lt;T&gt; get_XYZ()
<a name="l03325"></a>03325         {
<a name="l03326"></a>03326                 <span class="keywordflow">return</span> gm::vector3&lt;T&gt;(get_X(), get_Y(), get_Z());
<a name="l03327"></a>03327         }
<a name="l03328"></a>03328 
<a name="l03329"></a>03329 <span class="comment">//      DEPENDENCY_CLASS(Vector3&lt;T&gt;, DependencyObject)</span>
<a name="l03330"></a>03330         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l03331"></a>03331         <span class="keyword">static</span> DependencyClass* pClass;
<a name="l03332"></a>03332         <span class="keyword">typedef</span> Vector3&lt;T&gt; thisClass;
<a name="l03333"></a>03333         <span class="keyword">typedef</span> DependencyObject baseClass;
<a name="l03334"></a>03334 
<a name="l03335"></a>03335         DEPENDENCY_PROPERTY(T, X)
<a name="l03336"></a>03336         DEPENDENCY_PROPERTY(T, Y)
<a name="l03337"></a>03337         DEPENDENCY_PROPERTY(T, Z)
<a name="l03338"></a>03338 };
<a name="l03339"></a>03339 
<a name="l03340"></a>03340 typedef Vector3&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt; Vector3_B;
<a name="l03341"></a>03341 typedef Vector3&lt;<span class="keywordtype">int</span>&gt; Vector3_I;
<a name="l03342"></a>03342 typedef Vector3&lt;<span class="keywordtype">long</span> <span class="keywordtype">long</span>&gt; Vector3_L;
<a name="l03343"></a>03343 typedef Vector3&lt;<span class="keywordtype">float</span>&gt; Vector3_F;
<a name="l03344"></a>03344 typedef Vector3&lt;<span class="keywordtype">double</span>&gt; Vector3_D;
<a name="l03345"></a>03345 
<a name="l03346"></a>03346 <span class="preprocessor">#ifndef GUI_EXPORTS</span>
<a name="l03347"></a>03347 <span class="preprocessor"></span><span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l03348"></a>03348 <span class="preprocessor"></span>
<a name="l03349"></a>03349 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector3&lt;unsigned char&gt;;
<a name="l03350"></a>03350 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector3&lt;int&gt;;
<a name="l03351"></a>03351 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector3&lt;float&gt;;
<a name="l03352"></a>03352 <span class="keyword">template</span> <span class="keyword">class </span>DECLSPEC_DLLIMPORT Vector3&lt;double&gt;;
<a name="l03353"></a>03353 
<a name="l03354"></a>03354 <span class="preprocessor">#endif</span>
<a name="l03355"></a>03355 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l03356"></a>03356 <span class="preprocessor"></span>
<a name="l03357"></a>03357 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l03358"></a>03358 <span class="keyword">class </span>Vector4 : <span class="keyword">public</span> DependencyObject
<a name="l03359"></a>03359 {
<a name="l03360"></a>03360 <span class="keyword">public</span>:
<a name="l03361"></a>03361 
<a name="l03362"></a>03362         CTOR Vector4() : DependencyObject(get_Class())
<a name="l03363"></a>03363         {
<a name="l03364"></a>03364         }
<a name="l03365"></a>03365 
<a name="l03366"></a>03366 <span class="comment">//      DEPENDENCY_CLASS(Vector4&lt;T&gt;, DependencyObject)</span>
<a name="l03367"></a>03367 
<a name="l03368"></a>03368         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l03369"></a>03369         <span class="keyword">static</span> DependencyClass* pClass;
<a name="l03370"></a>03370         <span class="keyword">typedef</span> Vector4&lt;T&gt; thisClass;
<a name="l03371"></a>03371         <span class="keyword">typedef</span> DependencyObject baseClass;
<a name="l03372"></a>03372 
<a name="l03373"></a>03373         DEPENDENCY_PROPERTY(T, X)
<a name="l03374"></a>03374         DEPENDENCY_PROPERTY(T, Y)
<a name="l03375"></a>03375         DEPENDENCY_PROPERTY(T, Z)
<a name="l03376"></a>03376         DEPENDENCY_PROPERTY(T, W)
<a name="l03377"></a>03377 };
<a name="l03378"></a>03378 
<a name="l03379"></a>03379 typedef Vector4&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt; Vector4_B;
<a name="l03380"></a>03380 typedef Vector4&lt;<span class="keywordtype">int</span>&gt; Vector4_I;
<a name="l03381"></a>03381 typedef Vector4&lt;<span class="keywordtype">long</span> <span class="keywordtype">long</span>&gt; Vector4_L;
<a name="l03382"></a>03382 typedef Vector4&lt;<span class="keywordtype">float</span>&gt; Vector4_F;
<a name="l03383"></a>03383 typedef Vector4&lt;<span class="keywordtype">double</span>&gt; Vector4_D;
<a name="l03384"></a>03384 
<a name="l03385"></a>03385 }
<a name="l03386"></a>03386 }
<a name="l03387"></a>03387 
<a name="l03388"></a>03388 <span class="preprocessor">#include &quot;Cursor.h&quot;</span>
<a name="l03389"></a>03389 <span class="preprocessor"></span><span class="preprocessor">#include &quot;SystemColors.h&quot;</span>
<a name="l03390"></a>03390 
<a name="l03391"></a>03391 <span class="keyword">namespace </span>System
<a name="l03392"></a>03392 {
<a name="l03393"></a>03393 <span class="keyword">namespace </span>Gui
<a name="l03394"></a>03394 {
<a name="l03395"></a>03395 
<a name="l03396"></a>03396 <span class="comment">/*</span>
<a name="l03397"></a>03397 <span class="comment">class GUIEXT PolygonVisual : public ShapeVisual</span>
<a name="l03398"></a>03398 <span class="comment">{</span>
<a name="l03399"></a>03399 <span class="comment">public:</span>
<a name="l03400"></a>03400 <span class="comment"></span>
<a name="l03401"></a>03401 <span class="comment">        virtual void Render(RenderContext* renderContext);</span>
<a name="l03402"></a>03402 <span class="comment"></span>
<a name="l03403"></a>03403 <span class="comment">        vector&lt;LDraw::PointF&gt; m_points;</span>
<a name="l03404"></a>03404 <span class="comment">};</span>
<a name="l03405"></a>03405 <span class="comment"></span>
<a name="l03406"></a>03406 <span class="comment">class GUIEXT PathVisual : public ShapeVisual</span>
<a name="l03407"></a>03407 <span class="comment">{</span>
<a name="l03408"></a>03408 <span class="comment">public:</span>
<a name="l03409"></a>03409 <span class="comment">        CTOR PathVisual();</span>
<a name="l03410"></a>03410 <span class="comment"></span>
<a name="l03411"></a>03411 <span class="comment">        virtual void Render(RenderContext* renderContext);</span>
<a name="l03412"></a>03412 <span class="comment"></span>
<a name="l03413"></a>03413 <span class="comment">        PathData* m_pathData;</span>
<a name="l03414"></a>03414 <span class="comment"></span>
<a name="l03415"></a>03415 <span class="comment">        class InitClass</span>
<a name="l03416"></a>03416 <span class="comment">        {</span>
<a name="l03417"></a>03417 <span class="comment">        public:</span>
<a name="l03418"></a>03418 <span class="comment">                CTOR InitClass();</span>
<a name="l03419"></a>03419 <span class="comment">        };</span>
<a name="l03420"></a>03420 <span class="comment"></span>
<a name="l03421"></a>03421 <span class="comment">        static InitClass s_initClass;</span>
<a name="l03422"></a>03422 <span class="comment">};</span>
<a name="l03423"></a>03423 <span class="comment">*/</span>
<a name="l03424"></a>03424 
<a name="l03425"></a>03425 <span class="keyword">class </span>GUIEXT SystemBrushes
<a name="l03426"></a>03426 {
<a name="l03427"></a>03427 <span class="keyword">private</span>:
<a name="l03428"></a>03428 
<a name="l03429"></a>03429         CTOR SystemBrushes();
<a name="l03430"></a>03430 };
<a name="l03431"></a>03431 
<a name="l03432"></a>03432 <span class="keyword">class </span>SystemFonts
<a name="l03433"></a>03433 {
<a name="l03434"></a>03434 <span class="keyword">private</span>:
<a name="l03435"></a>03435 
<a name="l03436"></a>03436         CTOR SystemFonts();
<a name="l03437"></a>03437 };
<a name="l03438"></a>03438 
<a name="l03439"></a>03439 <span class="comment">/*</span>
<a name="l03440"></a>03440 <span class="comment">template&lt;class ContainerClass, class TYPE&gt; class LocalPropertyT</span>
<a name="l03441"></a>03441 <span class="comment">{</span>
<a name="l03442"></a>03442 <span class="comment">public:</span>
<a name="l03443"></a>03443 <span class="comment"></span>
<a name="l03444"></a>03444 <span class="comment">        void SetLocal(TYPE value)</span>
<a name="l03445"></a>03445 <span class="comment">        {</span>
<a name="l03446"></a>03446 <span class="comment">        }</span>
<a name="l03447"></a>03447 <span class="comment"></span>
<a name="l03448"></a>03448 <span class="comment">        TYPE GetLocal()</span>
<a name="l03449"></a>03449 <span class="comment">        {</span>
<a name="l03450"></a>03450 <span class="comment">        }</span>
<a name="l03451"></a>03451 <span class="comment"></span>
<a name="l03452"></a>03452 <span class="comment">        TYPE Get()</span>
<a name="l03453"></a>03453 <span class="comment">        {</span>
<a name="l03454"></a>03454 <span class="comment">        }</span>
<a name="l03455"></a>03455 <span class="comment"></span>
<a name="l03456"></a>03456 <span class="comment">        void ClearLocal()</span>
<a name="l03457"></a>03457 <span class="comment">        {</span>
<a name="l03458"></a>03458 <span class="comment">        }</span>
<a name="l03459"></a>03459 <span class="comment"></span>
<a name="l03460"></a>03460 <span class="comment">        //property_t&amp; operator = (TYPE</span>
<a name="l03461"></a>03461 <span class="comment">};</span>
<a name="l03462"></a>03462 <span class="comment">*/</span>
<a name="l03463"></a>03463 
<a name="l03464"></a>03464 <span class="preprocessor">#if 0</span>
<a name="l03465"></a>03465 <span class="preprocessor"></span><span class="keyword">class </span>GUIEXT RectangleVisual : <span class="keyword">public</span> ShapeVisual
<a name="l03466"></a>03466 {
<a name="l03467"></a>03467 <span class="keyword">public</span>:
<a name="l03468"></a>03468 
<a name="l03469"></a>03469         CTOR RectangleVisual();
<a name="l03470"></a>03470 
<a name="l03471"></a>03471         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(RenderContext* renderContext);
<a name="l03472"></a>03472 
<a name="l03473"></a>03473         <span class="keywordtype">float</span> get_X();
<a name="l03474"></a>03474         <span class="keywordtype">void</span> set_X(<span class="keywordtype">float</span> x);
<a name="l03475"></a>03475 
<a name="l03476"></a>03476         <span class="keywordtype">float</span> get_Y();
<a name="l03477"></a>03477         <span class="keywordtype">void</span> set_Y(<span class="keywordtype">float</span> y);
<a name="l03478"></a>03478 
<a name="l03479"></a>03479         <span class="keywordtype">float</span> get_Width();
<a name="l03480"></a>03480         <span class="keywordtype">void</span> set_Width(<span class="keywordtype">float</span> width);
<a name="l03481"></a>03481 
<a name="l03482"></a>03482         <span class="keywordtype">float</span> get_Height();
<a name="l03483"></a>03483         <span class="keywordtype">void</span> set_Height(<span class="keywordtype">float</span> height);
<a name="l03484"></a>03484 
<a name="l03485"></a>03485         <span class="keywordtype">float</span> get_RadiusX();
<a name="l03486"></a>03486         <span class="keywordtype">void</span> set_RadiusX(<span class="keywordtype">float</span> radiusX);
<a name="l03487"></a>03487 
<a name="l03488"></a>03488         <span class="keywordtype">float</span> get_RadiusY();
<a name="l03489"></a>03489         <span class="keywordtype">void</span> set_RadiusY(<span class="keywordtype">float</span> radiusY);
<a name="l03490"></a>03490 
<a name="l03491"></a>03491         <span class="comment">/*</span>
<a name="l03492"></a>03492 <span class="comment">        PropertyValueTBase&lt;float&gt;* get_XProperty()</span>
<a name="l03493"></a>03493 <span class="comment">        {</span>
<a name="l03494"></a>03494 <span class="comment">                return static_cast&lt;PropertyValueT&lt;RectangleVisual, float, 0&gt;*&gt;(this);</span>
<a name="l03495"></a>03495 <span class="comment">        }</span>
<a name="l03496"></a>03496 <span class="comment"></span>
<a name="l03497"></a>03497 <span class="comment">        PropertyValueTBase&lt;float&gt;* get_YProperty()</span>
<a name="l03498"></a>03498 <span class="comment">        {</span>
<a name="l03499"></a>03499 <span class="comment">                return static_cast&lt;PropertyValueT&lt;RectangleVisual, float, 1&gt;*&gt;(this);</span>
<a name="l03500"></a>03500 <span class="comment">        }</span>
<a name="l03501"></a>03501 <span class="comment"></span>
<a name="l03502"></a>03502 <span class="comment">        PropertyValueTBase&lt;float&gt;* get_WidthProperty()</span>
<a name="l03503"></a>03503 <span class="comment">        {</span>
<a name="l03504"></a>03504 <span class="comment">                return static_cast&lt;PropertyValueT&lt;RectangleVisual, float, 2&gt;*&gt;(this);</span>
<a name="l03505"></a>03505 <span class="comment">        }</span>
<a name="l03506"></a>03506 <span class="comment"></span>
<a name="l03507"></a>03507 <span class="comment">        PropertyValueTBase&lt;float&gt;* get_HeightProperty()</span>
<a name="l03508"></a>03508 <span class="comment">        {</span>
<a name="l03509"></a>03509 <span class="comment">                return static_cast&lt;PropertyValueT&lt;RectangleVisual, float, 3&gt;*&gt;(this);</span>
<a name="l03510"></a>03510 <span class="comment">        }</span>
<a name="l03511"></a>03511 <span class="comment">        */</span>
<a name="l03512"></a>03512 
<a name="l03513"></a>03513         DEFINE_CLASS()
<a name="l03514"></a>03514 
<a name="l03515"></a>03515         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; XProperty;
<a name="l03516"></a>03516         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; YProperty;
<a name="l03517"></a>03517         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; WidthProperty;
<a name="l03518"></a>03518         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; HeightProperty;
<a name="l03519"></a>03519         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; XRadiusProperty;
<a name="l03520"></a>03520         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; YRadiusProperty;
<a name="l03521"></a>03521 
<a name="l03522"></a>03522         <span class="comment">// Overriden</span>
<a name="l03523"></a>03523         static TypedDependencyProperty&lt;Geometry*&gt; GeometryProperty;
<a name="l03524"></a>03524 
<a name="l03525"></a>03525 private:
<a name="l03526"></a>03526 
<a name="l03527"></a>03527         LDraw::RectF m_rect;
<a name="l03528"></a>03528         LDraw::PointF m_radius;
<a name="l03529"></a>03529 };
<a name="l03530"></a>03530 <span class="preprocessor">#endif</span>
<a name="l03531"></a>03531 <span class="preprocessor"></span>
<a name="l03532"></a>03532 <span class="keyword">class </span>GUIEXT FillEllipseVisual : <span class="keyword">public</span> Visual
<a name="l03533"></a>03533 {
<a name="l03534"></a>03534 <span class="keyword">public</span>:
<a name="l03535"></a>03535 
<a name="l03536"></a>03536         CTOR FillEllipseVisual();
<a name="l03537"></a>03537 
<a name="l03538"></a>03538         CTOR FillEllipseVisual(
<a name="l03539"></a>03539                 typed&lt;float&gt; cx,
<a name="l03540"></a>03540                 typed&lt;float&gt; cy,
<a name="l03541"></a>03541                 typed&lt;float&gt; rx,
<a name="l03542"></a>03542                 typed&lt;float&gt; ry,
<a name="l03543"></a>03543                 typed&lt;Brush*&gt; brush);
<a name="l03544"></a>03544 
<a name="l03545"></a>03545         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l03546"></a>03546 
<a name="l03547"></a>03547         DEPENDENCY_CLASS(FillEllipseVisual, Visual)
<a name="l03548"></a>03548 
<a name="l03549"></a>03549         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Cx)
<a name="l03550"></a>03550         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Cy)
<a name="l03551"></a>03551         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Rx)
<a name="l03552"></a>03552         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Ry)
<a name="l03553"></a>03553         DEPENDENCY_PROPERTY(Brush*, Brush)
<a name="l03554"></a>03554 };
<a name="l03555"></a>03555 
<a name="l03556"></a>03556 }       <span class="comment">// Gui</span>
<a name="l03557"></a>03557 }       <span class="comment">// System</span>
<a name="l03558"></a>03558 
<a name="l03559"></a>03559 namespace System
<a name="l03560"></a>03560 {
<a name="l03561"></a>03561 <span class="keyword">namespace </span>Gui
<a name="l03562"></a>03562 {
<a name="l03563"></a>03563 
<a name="l03564"></a>03564 <span class="keyword">class </span>Symbol : <span class="keyword">public</span> Object
<a name="l03565"></a>03565 {
<a name="l03566"></a>03566 <span class="keyword">public</span>:
<a name="l03567"></a>03567 };
<a name="l03568"></a>03568 
<a name="l03569"></a>03569 <span class="keyword">class </span>GUIEXT VisualSymbol : <span class="keyword">public</span> Symbol
<a name="l03570"></a>03570 {
<a name="l03571"></a>03571 <span class="keyword">public</span>:
<a name="l03572"></a>03572         String m_name;
<a name="l03573"></a>03573         Visual* m_root;
<a name="l03574"></a>03574 };
<a name="l03575"></a>03575 
<a name="l03576"></a>03576 <span class="keyword">class </span>GUIEXT InstanceVisual : <span class="keyword">public</span> Visual
<a name="l03577"></a>03577 {
<a name="l03578"></a>03578 <span class="keyword">public</span>:
<a name="l03579"></a>03579         CTOR InstanceVisual();
<a name="l03580"></a>03580         CTOR InstanceVisual(VisualSymbol* symbol, gm::RectF rect);
<a name="l03581"></a>03581 
<a name="l03582"></a>03582         VisualSymbol* m_symbol;
<a name="l03583"></a>03583         gm::RectF m_rect;
<a name="l03584"></a>03584 };
<a name="l03585"></a>03585 
<a name="l03586"></a>03586 <span class="comment">/*</span>
<a name="l03587"></a>03587 <span class="comment">// ?? possible to implement directly on UIElement ??, probably not</span>
<a name="l03588"></a>03588 <span class="comment">interface ILayout</span>
<a name="l03589"></a>03589 <span class="comment">{</span>
<a name="l03590"></a>03590 <span class="comment">        virtual Layout* GetParent() = 0;</span>
<a name="l03591"></a>03591 <span class="comment">        virtual unsigned int GetChildrenCount() = 0;</span>
<a name="l03592"></a>03592 <span class="comment">        virtual Layout* GetChild(unsigned int index) = 0;</span>
<a name="l03593"></a>03593 <span class="comment">        virtual void AddChild(Layout* child) = 0;</span>
<a name="l03594"></a>03594 <span class="comment">};</span>
<a name="l03595"></a>03595 <span class="comment">*/</span>
<a name="l03596"></a>03596 
<a name="l03597"></a>03597 <span class="keyword">class </span>GUIEXT Layout : <span class="keyword">public</span> DependencyObject
<a name="l03598"></a>03598 {
<a name="l03599"></a>03599 <span class="keyword">public</span>:
<a name="l03600"></a>03600 
<a name="l03601"></a>03601         CTOR Layout(UIElement* element);
<a name="l03602"></a>03602 
<a name="l03603"></a>03603         <span class="keyword">virtual</span> gm::SizeF PreLayout(gm::SizeD availSize) = 0;
<a name="l03604"></a>03604         <span class="keyword">virtual</span> gm::SizeF LayOut(gm::RectF layoutRect) = 0;
<a name="l03605"></a>03605 
<a name="l03606"></a>03606         gm::SizeF get_DesiredSize();
<a name="l03607"></a>03607 
<a name="l03608"></a>03608         Layout* GetParent();
<a name="l03609"></a>03609         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetChildrenCount();
<a name="l03610"></a>03610         <span class="keyword">virtual</span> Layout* GetChild(<span class="keywordtype">size_t</span> index);
<a name="l03611"></a>03611         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddChild(Layout* child);
<a name="l03612"></a>03612 
<a name="l03613"></a>03613         Layout* m_parent;
<a name="l03614"></a>03614 
<a name="l03615"></a>03615         DEPENDENCY_CLASS_ABSTRACT(Layout, DependencyObject)
<a name="l03616"></a>03616 
<a name="l03617"></a>03617         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, DesiredWidth)
<a name="l03618"></a>03618         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, DesiredHeight)
<a name="l03619"></a>03619         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, ActualWidth)
<a name="l03620"></a>03620         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, ActualHeight)
<a name="l03621"></a>03621 
<a name="l03622"></a>03622         UIElement* m_element;
<a name="l03623"></a>03623 };
<a name="l03624"></a>03624 
<a name="l03625"></a>03625 class GUIEXT BorderLayout : public Layout
<a name="l03626"></a>03626 {
<a name="l03627"></a>03627 <span class="keyword">public</span>:
<a name="l03628"></a>03628 
<a name="l03629"></a>03629 };
<a name="l03630"></a>03630 
<a name="l03631"></a>03631 <span class="keyword">class </span>GUIEXT PanelLayout : <span class="keyword">public</span> Layout
<a name="l03632"></a>03632 {
<a name="l03633"></a>03633 <span class="keyword">public</span>:
<a name="l03634"></a>03634 
<a name="l03635"></a>03635         CTOR PanelLayout(UIElement* element) : Layout(element)
<a name="l03636"></a>03636         {
<a name="l03637"></a>03637         }
<a name="l03638"></a>03638 
<a name="l03639"></a>03639         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetChildrenCount() <span class="keyword">override</span>;
<a name="l03640"></a>03640         <span class="keyword">virtual</span> Layout* GetChild(<span class="keywordtype">size_t</span> index) <span class="keyword">override</span>;
<a name="l03641"></a>03641         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddChild(Layout* child) <span class="keyword">override</span>;
<a name="l03642"></a>03642 
<a name="l03643"></a>03643 <span class="keyword">private</span>:
<a name="l03644"></a>03644 
<a name="l03645"></a>03645         vector&lt;Layout*&gt; m_children;
<a name="l03646"></a>03646 };
<a name="l03647"></a>03647 
<a name="l03648"></a>03648 <span class="keyword">class </span>GUIEXT StackLayout : <span class="keyword">public</span> PanelLayout
<a name="l03649"></a>03649 {
<a name="l03650"></a>03650 <span class="keyword">public</span>:
<a name="l03651"></a>03651 
<a name="l03652"></a>03652         CTOR StackLayout(UIElement* element);
<a name="l03653"></a>03653 
<a name="l03654"></a>03654         <span class="keyword">enum</span> Direction
<a name="l03655"></a>03655         {
<a name="l03656"></a>03656                 Direction_Horizontal,
<a name="l03657"></a>03657                 Direction_Vertical,
<a name="l03658"></a>03658         };
<a name="l03659"></a>03659 
<a name="l03660"></a>03660         <span class="keyword">virtual</span> gm::SizeF PreLayOut(gm::RectF availRect);
<a name="l03661"></a>03661         <span class="keyword">virtual</span> gm::SizeF LayOut(gm::RectF layoutRect);
<a name="l03662"></a>03662 
<a name="l03663"></a>03663         Direction m_direction;
<a name="l03664"></a>03664 };
<a name="l03665"></a>03665 
<a name="l03666"></a>03666 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l03667"></a>03667 <span class="keyword">class </span>Channel
<a name="l03668"></a>03668 {
<a name="l03669"></a>03669 <span class="keyword">public</span>:
<a name="l03670"></a>03670 
<a name="l03671"></a>03671         Channel&amp; operator = (T value)
<a name="l03672"></a>03672         {
<a name="l03673"></a>03673                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l03674"></a>03674         }
<a name="l03675"></a>03675 
<a name="l03676"></a>03676         operator T ()
<a name="l03677"></a>03677         {
<a name="l03678"></a>03678                 DWORD result = WaitForSingleObject(m_handle, INFINITE);
<a name="l03679"></a>03679                 ASSERT(result == WAIT_OBJECT_0);
<a name="l03680"></a>03680         }
<a name="l03681"></a>03681 
<a name="l03682"></a>03682         HANDLE m_handle;
<a name="l03683"></a>03683         T m_value;
<a name="l03684"></a>03684 };
<a name="l03685"></a>03685 
<a name="l03686"></a>03686 <span class="keyword">interface </span>IViewable
<a name="l03687"></a>03687 {
<a name="l03688"></a>03688         <span class="keyword">virtual</span> uint get_ViewCount() abstract;
<a name="l03689"></a>03689         virtual Object* getView(uint index) abstract;
<a name="l03690"></a>03690         virtual <span class="keywordtype">void</span> addView(Object* view) abstract;
<a name="l03691"></a>03691 };
<a name="l03692"></a>03692 
<a name="l03693"></a>03693 enum CapStyle
<a name="l03694"></a>03694 {
<a name="l03695"></a>03695         CapStyle_Flat       = 0,
<a name="l03696"></a>03696         CapStyle_Square     = 1,
<a name="l03697"></a>03697         CapStyle_Round      = 2,
<a name="l03698"></a>03698         CapStyle_Triangle   = 3 
<a name="l03699"></a>03699 };
<a name="l03700"></a>03700 
<a name="l03701"></a>03701 <span class="keyword">enum</span> LineJoinStyle
<a name="l03702"></a>03702 {
<a name="l03703"></a>03703         LineJoinStyle_Miter     = 0,
<a name="l03704"></a>03704         LineJoinStyle_Bevel     = 1,
<a name="l03705"></a>03705         LineJoinStyle_Round     = 2,
<a name="l03706"></a>03706         LineJoinStyle_MiterOrBevel      = 3
<a name="l03707"></a>03707 };
<a name="l03708"></a>03708 
<a name="l03709"></a>03709 <span class="keyword">enum</span> DashStyle
<a name="l03710"></a>03710 {
<a name="l03711"></a>03711         DashStyle_solid = 0,
<a name="l03712"></a>03712         DashStyle_dash = 1,
<a name="l03713"></a>03713         DashStyle_dot = 2,
<a name="l03714"></a>03714         DashStyle_dash_dot = 3,
<a name="l03715"></a>03715         DashStyle_dash_dot_dot = 4,
<a name="l03716"></a>03716 <span class="comment">//      DashStyle_STYLE_CUSTOM = 5,</span>
<a name="l03717"></a>03717 };
<a name="l03718"></a>03718 
<a name="l03719"></a>03719 }
<a name="l03720"></a>03720 
<a name="l03721"></a>03721 }       <span class="comment">// System</span>
<a name="l03722"></a>03722 
<a name="l03723"></a>03723 <span class="preprocessor">#include &quot;StrokeStyle.h&quot;</span>
<a name="l03724"></a>03724 <span class="preprocessor">#include &quot;UIElement.h&quot;</span>
<a name="l03725"></a>03725 <span class="preprocessor">#include &quot;ImageVisual.h&quot;</span>
<a name="l03726"></a>03726 <span class="preprocessor">#include &quot;VideoElement.h&quot;</span>
<a name="l03727"></a>03727 <span class="preprocessor">#include &quot;LineVisual.h&quot;</span>
<a name="l03728"></a>03728 <span class="preprocessor">#include &quot;Group.h&quot;</span>
<a name="l03729"></a>03729 <span class="preprocessor">#include &quot;WindowThumbnailVisual.h&quot;</span>
<a name="l03730"></a>03730 
<a name="l03731"></a>03731 <span class="keyword">namespace </span>System
<a name="l03732"></a>03732 {
<a name="l03733"></a>03733 <span class="keyword">namespace </span>Gui
<a name="l03734"></a>03734 {
<a name="l03735"></a>03735 
<a name="l03736"></a>03736 <span class="keyword">class </span>GUIEXT Visuals : <span class="keyword">public</span> UIElement
<a name="l03737"></a>03737 {
<a name="l03738"></a>03738 <span class="keyword">public</span>:
<a name="l03739"></a>03739         CTOR Visuals();
<a name="l03740"></a>03740 <span class="comment">//      CTOR Visuals(DependencyClass* depClass);</span>
<a name="l03741"></a>03741 
<a name="l03742"></a>03742         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetChildrenCount() <span class="keyword">override</span>;
<a name="l03743"></a>03743         <span class="keyword">virtual</span> Visual* GetChild(<span class="keywordtype">size_t</span> index) <span class="keyword">override</span>;
<a name="l03744"></a>03744 
<a name="l03745"></a>03745         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddChild(Visual* child) <span class="keyword">override</span>;
<a name="l03746"></a>03746 
<a name="l03747"></a>03747         <span class="keywordtype">void</span> Add(Visual* visual)
<a name="l03748"></a>03748         {
<a name="l03749"></a>03749                 AddChild(visual);
<a name="l03750"></a>03750         }
<a name="l03751"></a>03751 
<a name="l03752"></a>03752         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l03753"></a>03753 <span class="comment">//      virtual UIElement* HitTest(LDraw::PointF point) override;</span>
<a name="l03754"></a>03754 
<a name="l03755"></a>03755         Element* m_element;
<a name="l03756"></a>03756 
<a name="l03757"></a>03757         vector&lt;Visual*&gt; m_items;
<a name="l03758"></a>03758 
<a name="l03759"></a>03759 <span class="comment">//      DEPENDENCY_CLASS(Visuals, Visual)</span>
<a name="l03760"></a>03760         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l03761"></a>03761         <span class="keyword">static</span> DependencyClass* pClass;
<a name="l03762"></a>03762 };
<a name="l03763"></a>03763 
<a name="l03764"></a>03764 }       <span class="comment">// Gui</span>
<a name="l03765"></a>03765 }       <span class="comment">// System</span>
<a name="l03766"></a>03766 
<a name="l03767"></a>03767 <span class="preprocessor">#include &quot;RenderGeometryVisual.h&quot;</span>
<a name="l03768"></a>03768 <span class="preprocessor">#include &quot;FillGeometryVisual.h&quot;</span>
<a name="l03769"></a>03769 <span class="preprocessor">#include &quot;StrokeGeometryVisual.h&quot;</span>
<a name="l03770"></a>03770 <span class="preprocessor">#include &quot;TextVisual.h&quot;</span>
<a name="l03771"></a>03771 
<a name="l03772"></a>03772 <span class="keyword">namespace </span>System
<a name="l03773"></a>03773 {
<a name="l03774"></a>03774 <span class="keyword">namespace </span>Gui
<a name="l03775"></a>03775 {
<a name="l03776"></a>03776 
<a name="l03777"></a>03777 <span class="keyword">class </span>GUIEXT FrameworkElement : <span class="keyword">public</span> UIElement
<a name="l03778"></a>03778 {
<a name="l03779"></a>03779 <span class="keyword">protected</span>:
<a name="l03780"></a>03780         CTOR FrameworkElement(DependencyClass* depClass);
<a name="l03781"></a>03781         CTOR FrameworkElement(DependencyClass* depClass, gm::SizeF size);
<a name="l03782"></a>03782 
<a name="l03783"></a>03783 <span class="keyword">public</span>:
<a name="l03784"></a>03784 
<a name="l03785"></a>03785         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> HasComputedPropertyValue(DependencyProperty* dp) <span class="keyword">override</span>;
<a name="l03786"></a>03786         <span class="keyword">virtual</span> Variant GetComputedPropertyObjectValue2(DependencyProperty* dp) <span class="keyword">override</span>;
<a name="l03787"></a>03787 
<a name="l03788"></a>03788         DEFINE_THIS(_FrameworkElement)
<a name="l03789"></a>03789 
<a name="l03790"></a>03790         DEPENDENCY_CLASS(FrameworkElement, UIElement)
<a name="l03791"></a>03791 
<a name="l03792"></a>03792         DEPENDENCY_PROPERTY(ObjectBinding*, Binding)
<a name="l03793"></a>03793 };
<a name="l03794"></a>03794 
<a name="l03795"></a>03795 class GUIEXT _FrameworkElement : public _UIElement
<a name="l03796"></a>03796 {
<a name="l03797"></a>03797 <span class="keyword">public</span>:
<a name="l03798"></a>03798         CTOR _FrameworkElement(<span class="keyword">const</span> Expressive::expression&amp; exp) : _UIElement(exp)
<a name="l03799"></a>03799         {
<a name="l03800"></a>03800         }
<a name="l03801"></a>03801 };
<a name="l03802"></a>03802 
<a name="l03803"></a>03803 }
<a name="l03804"></a>03804 }
<a name="l03805"></a>03805 
<a name="l03806"></a>03806 <span class="preprocessor">#include &quot;Panel.h&quot;</span>
<a name="l03807"></a>03807 <span class="preprocessor">#include &quot;ContentElement.h&quot;</span>
<a name="l03808"></a>03808 
<a name="l03809"></a>03809 <span class="keyword">namespace </span>System
<a name="l03810"></a>03810 {
<a name="l03811"></a>03811 <span class="keyword">namespace </span>Gui
<a name="l03812"></a>03812 {
<a name="l03813"></a>03813 
<a name="l03814"></a>03814 <span class="keyword">template</span>&lt;<span class="keyword">class</span> value_type&gt; <span class="keyword">class </span>ValueBinding : <span class="keyword">public</span> OneToManyOutputsBinding
<a name="l03815"></a>03815 {
<a name="l03816"></a>03816 <span class="keyword">public</span>:
<a name="l03817"></a>03817 
<a name="l03818"></a>03818         CTOR ValueBinding()
<a name="l03819"></a>03819         {
<a name="l03820"></a>03820         }
<a name="l03821"></a>03821 
<a name="l03822"></a>03822         CTOR ValueBinding(value_type value) : m_value(value)
<a name="l03823"></a>03823         {
<a name="l03824"></a>03824         }
<a name="l03825"></a>03825 
<a name="l03826"></a>03826         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnSetValue(value_type value)
<a name="l03827"></a>03827         {
<a name="l03828"></a>03828         }
<a name="l03829"></a>03829 
<a name="l03830"></a>03830         <span class="keyword">virtual</span> Variant GetValue()
<a name="l03831"></a>03831         {
<a name="l03832"></a>03832                 <span class="comment">/*</span>
<a name="l03833"></a>03833 <span class="comment">                if (m_objectValue == NULL)</span>
<a name="l03834"></a>03834 <span class="comment">                {</span>
<a name="l03835"></a>03835 <span class="comment">                        m_objectValue = box_cast(m_value);</span>
<a name="l03836"></a>03836 <span class="comment">                }</span>
<a name="l03837"></a>03837 <span class="comment">                */</span>
<a name="l03838"></a>03838 
<a name="l03839"></a>03839                 <span class="keywordflow">return</span> m_value;
<a name="l03840"></a>03840         }
<a name="l03841"></a>03841 
<a name="l03842"></a>03842         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetValue(value_type value)
<a name="l03843"></a>03843         {
<a name="l03844"></a>03844         <span class="comment">//      m_objectValue = NULL;</span>
<a name="l03845"></a>03845                 m_value = value;
<a name="l03846"></a>03846                 OnSetValue(value);
<a name="l03847"></a>03847 
<a name="l03848"></a>03848                 <span class="keywordflow">if</span> (!m_outBindings.empty())
<a name="l03849"></a>03849                 {
<a name="l03850"></a>03850                         OutputValue(GetValue());
<a name="l03851"></a>03851                 }
<a name="l03852"></a>03852         }
<a name="l03853"></a>03853 
<a name="l03854"></a>03854         <span class="comment">/*</span>
<a name="l03855"></a>03855 <span class="comment">        virtual void OnObjectChanged(Object*) override</span>
<a name="l03856"></a>03856 <span class="comment">        {</span>
<a name="l03857"></a>03857 <span class="comment">                if (!m_outBindings.empty())</span>
<a name="l03858"></a>03858 <span class="comment">                {</span>
<a name="l03859"></a>03859 <span class="comment">                        OutputValue(GetValue());</span>
<a name="l03860"></a>03860 <span class="comment">                }</span>
<a name="l03861"></a>03861 <span class="comment">        }</span>
<a name="l03862"></a>03862 <span class="comment">        */</span>
<a name="l03863"></a>03863 
<a name="l03864"></a>03864         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetValue(<span class="keyword">const</span> Variant&amp; value)<span class="keyword"> override</span>
<a name="l03865"></a>03865 <span class="keyword">        </span>{
<a name="l03866"></a>03866                 m_value = value;
<a name="l03867"></a>03867                 OnSetValue(m_value);
<a name="l03868"></a>03868 
<a name="l03869"></a>03869                 <span class="keywordflow">if</span> (!m_outBindings.empty())
<a name="l03870"></a>03870                 {
<a name="l03871"></a>03871                         OutputValue(m_value);
<a name="l03872"></a>03872                 }
<a name="l03873"></a>03873         }
<a name="l03874"></a>03874 
<a name="l03875"></a>03875         <span class="keyword">virtual</span> ValueBinding&lt;value_type&gt;&amp; operator = (value_type value)
<a name="l03876"></a>03876         {
<a name="l03877"></a>03877                 SetValue(value);
<a name="l03878"></a>03878                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l03879"></a>03879         }
<a name="l03880"></a>03880 
<a name="l03881"></a>03881         <span class="keyword">virtual</span> operator value_type ()
<a name="l03882"></a>03882         {
<a name="l03883"></a>03883                 <span class="keywordflow">return</span> m_value;
<a name="l03884"></a>03884         }
<a name="l03885"></a>03885 
<a name="l03886"></a>03886         <span class="keyword">virtual</span> Type* GetOutputType()<span class="keyword"> override</span>
<a name="l03887"></a>03887 <span class="keyword">        </span>{
<a name="l03888"></a>03888                 <span class="keywordflow">return</span> <span class="keyword">typeid</span>(value_type);
<a name="l03889"></a>03889         }
<a name="l03890"></a>03890 
<a name="l03891"></a>03891         value_type m_value;
<a name="l03892"></a>03892 };
<a name="l03893"></a>03893 
<a name="l03894"></a>03894 <span class="keyword">template</span>&lt;<span class="keyword">class</span> to_t, <span class="keyword">class</span> from_t&gt; to_t convert_(from_t value)
<a name="l03895"></a>03895 {
<a name="l03896"></a>03896         <span class="keywordflow">return</span> value;
<a name="l03897"></a>03897 }
<a name="l03898"></a>03898 
<a name="l03899"></a>03899 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l03900"></a>03900 <span class="preprocessor"></span><span class="keyword">template</span>&lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">bool</span> convert_&lt;bool&gt;(BOOL value)
<a name="l03901"></a>03901 {
<a name="l03902"></a>03902         <span class="keywordflow">return</span> value? <span class="keyword">true</span>: <span class="keyword">false</span>;
<a name="l03903"></a>03903 }
<a name="l03904"></a>03904 <span class="preprocessor">#endif</span>
<a name="l03905"></a>03905 <span class="preprocessor"></span>
<a name="l03906"></a>03906 <span class="keyword">template</span>&lt;<span class="keyword">class</span> value_type, <span class="keyword">class</span> spvalue_type&gt;
<a name="l03907"></a>03907 <span class="keyword">class </span>SystemParameter : <span class="keyword">public</span> ValueBinding&lt;value_type&gt;
<a name="l03908"></a>03908 {
<a name="l03909"></a>03909 <span class="keyword">public</span>:
<a name="l03910"></a>03910 
<a name="l03911"></a>03911         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnSetValue(value_type value)<span class="keyword"> override</span>
<a name="l03912"></a>03912 <span class="keyword">        </span>{
<a name="l03913"></a>03913                 <span class="keywordflow">if</span> (!m_set)
<a name="l03914"></a>03914                 {
<a name="l03915"></a>03915                         m_set = <span class="keyword">true</span>;
<a name="l03916"></a>03916 
<a name="l03917"></a>03917                         spvalue_type spvalue = value;
<a name="l03918"></a>03918                         SystemParametersInfo(m_set_sp, spvalue, NULL, 0);
<a name="l03919"></a>03919 
<a name="l03920"></a>03920                         m_set = <span class="keyword">false</span>;
<a name="l03921"></a>03921                 }
<a name="l03922"></a>03922         }
<a name="l03923"></a>03923 
<a name="l03924"></a>03924         CTOR SystemParameter(uint get_sp, uint set_sp) : m_get_sp(get_sp), m_set_sp(set_sp), m_set(false)
<a name="l03925"></a>03925         {
<a name="l03926"></a>03926                 spvalue_type spvalue;
<a name="l03927"></a>03927                 SystemParametersInfo(m_get_sp, 0, &amp;spvalue, 0);
<a name="l03928"></a>03928 
<a name="l03929"></a>03929                 m_set = <span class="keyword">true</span>;
<a name="l03930"></a>03930 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l03931"></a>03931 <span class="preprocessor"></span>                SetValue(convert_&lt;value_type&gt;(spvalue));
<a name="l03932"></a>03932 <span class="preprocessor">#endif</span>
<a name="l03933"></a>03933 <span class="preprocessor"></span>                m_set = <span class="keyword">false</span>;
<a name="l03934"></a>03934         }
<a name="l03935"></a>03935 
<a name="l03936"></a>03936         uint m_get_sp;
<a name="l03937"></a>03937         uint m_set_sp;
<a name="l03938"></a>03938         <span class="keywordtype">bool</span> m_set;
<a name="l03939"></a>03939 };
<a name="l03940"></a>03940 
<a name="l03941"></a>03941 <span class="keyword">class </span>GUIEXT SystemInformation
<a name="l03942"></a>03942 {
<a name="l03943"></a>03943 <span class="keyword">public</span>:
<a name="l03944"></a>03944 
<a name="l03945"></a>03945 <span class="preprocessor">#if defined(SPI_GETDROPSHADOW)</span>
<a name="l03946"></a>03946 <span class="preprocessor"></span>
<a name="l03947"></a>03947         <span class="keyword">static</span> SystemParameter&lt;bool, BOOL&gt;&amp; get_IsDropShadowEnabled()
<a name="l03948"></a>03948         {
<a name="l03949"></a>03949 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l03950"></a>03950 <span class="preprocessor"></span>                <span class="keyword">static</span> SystemParameter&lt;bool, BOOL&gt; s(SPI_GETDROPSHADOW, SPI_SETDROPSHADOW);
<a name="l03951"></a>03951 <span class="preprocessor">#endif</span>
<a name="l03952"></a>03952 <span class="preprocessor"></span>                <span class="keywordflow">return</span> s;
<a name="l03953"></a>03953         }
<a name="l03954"></a>03954 
<a name="l03955"></a>03955 <span class="preprocessor">#endif</span>
<a name="l03956"></a>03956 <span class="preprocessor"></span>
<a name="l03957"></a>03957 <span class="preprocessor">#if defined(SPI_GETFLATMENU)</span>
<a name="l03958"></a>03958 <span class="preprocessor"></span>        <span class="keyword">static</span> SystemParameter&lt;bool, BOOL&gt;&amp; get_IsFlatMenuEnabled()
<a name="l03959"></a>03959         {
<a name="l03960"></a>03960 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l03961"></a>03961 <span class="preprocessor"></span>                <span class="keyword">static</span> SystemParameter&lt;bool, BOOL&gt; s(SPI_GETFLATMENU, SPI_SETFLATMENU);
<a name="l03962"></a>03962 <span class="preprocessor">#endif</span>
<a name="l03963"></a>03963 <span class="preprocessor"></span>                <span class="keywordflow">return</span> s;
<a name="l03964"></a>03964         }
<a name="l03965"></a>03965 
<a name="l03966"></a>03966 <span class="preprocessor">#endif</span>
<a name="l03967"></a>03967 <span class="preprocessor"></span>
<a name="l03968"></a>03968 <span class="comment">//      static bool get_IsListBoxSmoothScrollingEnabled();</span>
<a name="l03969"></a>03969 };
<a name="l03970"></a>03970 
<a name="l03971"></a>03971 }       <span class="comment">// Gui</span>
<a name="l03972"></a>03972 }       <span class="comment">// System</span>
<a name="l03973"></a>03973 
<a name="l03974"></a>03974 <span class="preprocessor">#include &quot;DockPanel.h&quot;</span>
<a name="l03975"></a>03975 
<a name="l03976"></a>03976 <span class="preprocessor">#include &quot;Mouse.h&quot;</span>
<a name="l03977"></a>03977 
<a name="l03978"></a>03978 <span class="keyword">namespace </span>System
<a name="l03979"></a>03979 {
<a name="l03980"></a>03980 <span class="keyword">namespace </span>Gui
<a name="l03981"></a>03981 {
<a name="l03982"></a>03982 
<a name="l03983"></a>03983 <span class="keyword">class </span>GUIEXT Stylus
<a name="l03984"></a>03984 {
<a name="l03985"></a>03985 <span class="keyword">public</span>:
<a name="l03986"></a>03986 
<a name="l03987"></a>03987 <span class="comment">//      static ValueBinding&lt;float&gt; s_ScreenXBinding;</span>
<a name="l03988"></a>03988 <span class="comment">//      static ValueBinding&lt;float&gt; s_ScreenYBinding;</span>
<a name="l03989"></a>03989         <span class="keyword">static</span> ValueBinding&lt;float&gt; s_PressureBinding;
<a name="l03990"></a>03990 <span class="comment">//      static ValueBinding&lt;bool&gt; s_DownBinding;</span>
<a name="l03991"></a>03991 
<a name="l03992"></a>03992 <span class="keyword">private</span>:
<a name="l03993"></a>03993         CTOR Stylus();
<a name="l03994"></a>03994 };
<a name="l03995"></a>03995 
<a name="l03996"></a>03996 <span class="keyword">class </span>GUIEXT _Stylus
<a name="l03997"></a>03997 {
<a name="l03998"></a>03998 <span class="keyword">public</span>:
<a name="l03999"></a>03999         <span class="keyword">static</span> Expressive::typed_expression&lt;float&gt; Pressure();
<a name="l04000"></a>04000 };
<a name="l04001"></a>04001 
<a name="l04002"></a>04002 <span class="keyword">class </span>GUIEXT Date : <span class="keyword">public</span> DependencyObject
<a name="l04003"></a>04003 {
<a name="l04004"></a>04004 <span class="keyword">public</span>:
<a name="l04005"></a>04005         CTOR Date();
<a name="l04006"></a>04006 
<a name="l04007"></a>04007         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, Year)
<a name="l04008"></a>04008         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, TimeOfDay)
<a name="l04009"></a>04009         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, DayOfWeek)
<a name="l04010"></a>04010         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, DayOfMonth)
<a name="l04011"></a>04011         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, HourOfDay)
<a name="l04012"></a>04012         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, Second)
<a name="l04013"></a>04013         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, Minute)
<a name="l04014"></a>04014         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, Milliseconds)
<a name="l04015"></a>04015 
<a name="l04016"></a>04016         DEPENDENCY_CLASS(Date, DependencyObject)
<a name="l04017"></a>04017 
<a name="l04018"></a>04018         static Date* get_CurrentDate();
<a name="l04019"></a>04019 };
<a name="l04020"></a>04020 
<a name="l04021"></a>04021 class GUIEXT Screen
<a name="l04022"></a>04022 {
<a name="l04023"></a>04023 <span class="keyword">public</span>:
<a name="l04024"></a>04024 
<a name="l04025"></a>04025         <span class="keyword">static</span> Expressive::Expression* get_Width();
<a name="l04026"></a>04026         <span class="keyword">static</span> Expressive::Expression* get_Height();
<a name="l04027"></a>04027 
<a name="l04028"></a>04028 <span class="keyword">private</span>:
<a name="l04029"></a>04029 
<a name="l04030"></a>04030         CTOR Screen();
<a name="l04031"></a>04031 };
<a name="l04032"></a>04032 
<a name="l04033"></a>04033 <span class="keyword">typedef</span> SystemParameter&lt;bool, BOOL&gt; _CursorShadow;
<a name="l04034"></a>04034 <span class="keyword">typedef</span> SystemParameter&lt;int, int&gt; _MouseTrails;
<a name="l04035"></a>04035 
<a name="l04036"></a>04036 <span class="keyword">class </span>GUIEXT SystemParameters : <span class="keyword">public</span> DependencyObject
<a name="l04037"></a>04037 {
<a name="l04038"></a>04038 <span class="keyword">public</span>:
<a name="l04039"></a>04039 
<a name="l04040"></a>04040 <span class="comment">//      static ValueBinding&lt;bool&gt;* get_ClientAreaAnimation();</span>
<a name="l04041"></a>04041 <span class="comment">//      static ValueBinding&lt;bool&gt;* get_DisableOverlappedContent();</span>
<a name="l04042"></a>04042 
<a name="l04043"></a>04043         <span class="keyword">static</span> ValueBinding&lt;bool&gt;* get_CursorShadow();
<a name="l04044"></a>04044         <span class="keyword">static</span> ValueBinding&lt;int&gt;* get_MouseTrails();
<a name="l04045"></a>04045 
<a name="l04046"></a>04046 <span class="keyword">private</span>:
<a name="l04047"></a>04047 
<a name="l04048"></a>04048         CTOR SystemParameters();
<a name="l04049"></a>04049 };
<a name="l04050"></a>04050 
<a name="l04051"></a>04051 <span class="keyword">class </span>GUIEXT VisualElement : <span class="keyword">public</span> UIElement
<a name="l04052"></a>04052 {
<a name="l04053"></a>04053 <span class="keyword">public</span>:
<a name="l04054"></a>04054 
<a name="l04055"></a>04055         CTOR VisualElement();
<a name="l04056"></a>04056         CTOR VisualElement(Visual* visual);
<a name="l04057"></a>04057 
<a name="l04058"></a>04058         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnComputedPropertyValueChanged(PropertyValue* pPropertyVal, <span class="keywordtype">bool</span> handled) <span class="keyword">override</span>;
<a name="l04059"></a>04059 
<a name="l04060"></a>04060         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l04061"></a>04061 
<a name="l04062"></a>04062         DEPENDENCY_PROPERTY(Visual*, Visual)
<a name="l04063"></a>04063 
<a name="l04064"></a>04064 protected:
<a name="l04065"></a>04065 
<a name="l04066"></a>04066         virtual Visual* CreateVisual();
<a name="l04067"></a>04067 };
<a name="l04068"></a>04068 
<a name="l04069"></a>04069 }       <span class="comment">// Gui</span>
<a name="l04070"></a>04070 }       <span class="comment">// System</span>
<a name="l04071"></a>04071 
<a name="l04072"></a>04072 <span class="comment">//#include &quot;TextElement.h&quot;</span>
<a name="l04073"></a>04073 <span class="preprocessor">#include &quot;Control.hpp&quot;</span>
<a name="l04074"></a>04074 <span class="preprocessor"></span>
<a name="l04075"></a>04075 <span class="keyword">namespace </span>System
<a name="l04076"></a>04076 {
<a name="l04077"></a>04077 <span class="keyword">namespace </span>Gui
<a name="l04078"></a>04078 {
<a name="l04079"></a>04079 
<a name="l04080"></a>04080 <span class="keyword">class </span>GUIEXT ContentControl : <span class="keyword">public</span> Control
<a name="l04081"></a>04081 {
<a name="l04082"></a>04082 <span class="keyword">protected</span>:
<a name="l04083"></a>04083 
<a name="l04084"></a>04084         CTOR ContentControl(DependencyClass* depClass);
<a name="l04085"></a>04085         CTOR ContentControl(DependencyClass* depClass, Object* content);
<a name="l04086"></a>04086         CTOR ContentControl(DependencyClass* depClass, Object* content, gm::SizeF size);
<a name="l04087"></a>04087 
<a name="l04088"></a>04088 <span class="keyword">public</span>:
<a name="l04089"></a>04089 
<a name="l04090"></a>04090         Template* get_ContentTemplate();
<a name="l04091"></a>04091         <span class="keywordtype">void</span> set_ContentTemplate(Template* pTemplate);
<a name="l04092"></a>04092 
<a name="l04093"></a>04093 <span class="comment">//      virtual void OnComputedPropertyValueChanged(PropertyValue* pPropertyVal) override;</span>
<a name="l04094"></a>04094 
<a name="l04095"></a>04095         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetLogicalChildrenCount() <span class="keyword">override</span>;
<a name="l04096"></a>04096         <span class="keyword">virtual</span> Object* GetLogicalChild(<span class="keywordtype">size_t</span> position) <span class="keyword">override</span>;
<a name="l04097"></a>04097         <span class="keyword">virtual</span> Object* ReplaceChild(<span class="keywordtype">size_t</span> position, Object* newChild) <span class="keyword">override</span>;
<a name="l04098"></a>04098 
<a name="l04099"></a>04099         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnComputedPropertyValueChanged(PropertyValue* pPropertyVal, <span class="keywordtype">bool</span> handled) <span class="keyword">override</span>;
<a name="l04100"></a>04100 
<a name="l04101"></a>04101         DEFINE_THIS(_ContentControl)
<a name="l04102"></a>04102 
<a name="l04103"></a>04103         DEPENDENCY_CLASS_ABSTRACT(ContentControl, Control)
<a name="l04104"></a>04104 
<a name="l04105"></a>04105         DEPENDENCY_PROPERTY(Object*, Content)
<a name="l04106"></a>04106         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, ContentWidth)
<a name="l04107"></a>04107         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, ContentHeight)
<a name="l04108"></a>04108         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, MinContentWidth)
<a name="l04109"></a>04109         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, MinContentHeight)
<a name="l04110"></a>04110         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, MaxContentWidth)
<a name="l04111"></a>04111         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, MaxContentHeight)
<a name="l04112"></a>04112 };
<a name="l04113"></a>04113 
<a name="l04114"></a>04114 class _ContentControl : public _Control
<a name="l04115"></a>04115 {
<a name="l04116"></a>04116 <span class="keyword">public</span>:
<a name="l04117"></a>04117         CTOR _ContentControl(<span class="keyword">const</span> Expressive::expression&amp; exp) : _Control(exp)
<a name="l04118"></a>04118         {
<a name="l04119"></a>04119         }
<a name="l04120"></a>04120 
<a name="l04121"></a>04121         Expressive::typed_expression&lt;Object*&gt; getContent()<span class="keyword"> const</span>
<a name="l04122"></a>04122 <span class="keyword">        </span>{
<a name="l04123"></a>04123                 <span class="keywordflow">return</span> getProperty(ContentControl::get_ContentProperty());
<a name="l04124"></a>04124         }
<a name="l04125"></a>04125 
<a name="l04126"></a>04126         Expressive::typed_expression&lt;float&gt; getContentWidth()<span class="keyword"> const</span>
<a name="l04127"></a>04127 <span class="keyword">        </span>{
<a name="l04128"></a>04128                 <span class="keywordflow">return</span> getProperty(ContentControl::get_ContentWidthProperty());
<a name="l04129"></a>04129         }
<a name="l04130"></a>04130 
<a name="l04131"></a>04131         Expressive::typed_expression&lt;float&gt; getContentHeight()<span class="keyword"> const</span>
<a name="l04132"></a>04132 <span class="keyword">        </span>{
<a name="l04133"></a>04133                 <span class="keywordflow">return</span> getProperty(ContentControl::get_ContentHeightProperty());
<a name="l04134"></a>04134         }
<a name="l04135"></a>04135 };
<a name="l04136"></a>04136 
<a name="l04137"></a>04137 <span class="keyword">class </span>GUIEXT Decorator : <span class="keyword">public</span> FrameworkElement
<a name="l04138"></a>04138 {
<a name="l04139"></a>04139 <span class="keyword">public</span>:
<a name="l04140"></a>04140 
<a name="l04141"></a>04141         CTOR Decorator(DependencyClass* depClass);
<a name="l04142"></a>04142 
<a name="l04143"></a>04143         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetChildrenCount();
<a name="l04144"></a>04144         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddChild(UIElement* element);
<a name="l04145"></a>04145         <span class="keyword">virtual</span> UIElement* GetChild(<span class="keywordtype">size_t</span> index);
<a name="l04146"></a>04146 
<a name="l04147"></a>04147         DEPENDENCY_PROPERTY(UIElement*, Child)
<a name="l04148"></a>04148 
<a name="l04149"></a>04149         static DependencyClass* get_Class();
<a name="l04150"></a>04150 };
<a name="l04151"></a>04151 
<a name="l04152"></a>04152 class GUIEXT Border : public Decorator
<a name="l04153"></a>04153 {
<a name="l04154"></a>04154 <span class="keyword">public</span>:
<a name="l04155"></a>04155 
<a name="l04156"></a>04156         CTOR Border();
<a name="l04157"></a>04157 
<a name="l04158"></a>04158         DEPENDENCY_CLASS(Border, Decorator)
<a name="l04159"></a>04159 <span class="comment">//      static DependencyClass* get_Class();</span>
<a name="l04160"></a>04160 <span class="comment">//      static DependencyClass* pClass;</span>
<a name="l04161"></a>04161 };
<a name="l04162"></a>04162 
<a name="l04163"></a>04163 }       <span class="comment">// Gui</span>
<a name="l04164"></a>04164 }       <span class="comment">// System</span>
<a name="l04165"></a>04165 
<a name="l04166"></a>04166 <span class="keyword">namespace </span>MS
<a name="l04167"></a>04167 {
<a name="l04168"></a>04168 <span class="keyword">namespace </span>Windows
<a name="l04169"></a>04169 {
<a name="l04170"></a>04170 <span class="keyword">namespace </span>Shell
<a name="l04171"></a>04171 {
<a name="l04172"></a>04172 
<a name="l04173"></a>04173 <span class="keyword">class </span>Private
<a name="l04174"></a>04174 {
<a name="l04175"></a>04175 <span class="keyword">public</span>:
<a name="l04176"></a>04176         <span class="keyword">static</span> ITaskbarList* pTaskbarList;
<a name="l04177"></a>04177         <span class="keyword">static</span> ITaskbarList3* pTaskbarList3;
<a name="l04178"></a>04178 };
<a name="l04179"></a>04179 
<a name="l04180"></a>04180 <span class="keyword">enum</span> TaskbarItemProgressState
<a name="l04181"></a>04181 {
<a name="l04182"></a>04182         TaskbarItemProgressState_None, <span class="comment">// No progress indicator is displayed in the taskbar button. </span>
<a name="l04183"></a>04183         TaskbarItemProgressState_Indeterminate, <span class="comment">// A pulsing green indicator is displayed in the taskbar button. </span>
<a name="l04184"></a>04184         TaskbarItemProgressState_Normal, <span class="comment">// A green progress indicator is displayed in the taskbar button. </span>
<a name="l04185"></a>04185         TaskbarItemProgressState_Error, <span class="comment">// A red progress indicator is displayed in the taskbar button. </span>
<a name="l04186"></a>04186         TaskbarItemProgressState_Paused, <span class="comment">//  </span>
<a name="l04187"></a>04187 };
<a name="l04188"></a>04188 
<a name="l04189"></a>04189 <span class="keyword">class </span>GUIEXT TaskbarItemInfo : <span class="keyword">public</span> System::Gui::DependencyObject
<a name="l04190"></a>04190 {
<a name="l04191"></a>04191 <span class="keyword">public</span>:
<a name="l04192"></a>04192         CTOR TaskbarItemInfo();
<a name="l04193"></a>04193 
<a name="l04194"></a>04194         DEPENDENCY_PROPERTY(TaskbarItemProgressState, ProgressState)
<a name="l04195"></a>04195         DEPENDENCY_PROPERTY(<span class="keywordtype">double</span>, ProgressValue)
<a name="l04196"></a>04196 
<a name="l04197"></a>04197         DEPENDENCY_CLASS(TaskbarItemInfo, System::Gui::DependencyObject)
<a name="l04198"></a>04198 };
<a name="l04199"></a>04199 
<a name="l04200"></a>04200 }       <span class="comment">// Shell</span>
<a name="l04201"></a>04201 }       <span class="comment">// Windows</span>
<a name="l04202"></a>04202 }       <span class="comment">// MS</span>
<a name="l04203"></a>04203 
<a name="l04204"></a>04204 <span class="preprocessor">#include &quot;Cursors.h&quot;</span>
<a name="l04205"></a>04205 <span class="preprocessor"></span><span class="preprocessor">#include &quot;Button.h&quot;</span>
<a name="l04206"></a>04206 <span class="preprocessor">#include &quot;WindowVisual.h&quot;</span>
<a name="l04207"></a>04207 <span class="preprocessor">#include &quot;PlatformWindow.h&quot;</span>
<a name="l04208"></a>04208 <span class="preprocessor">#include &quot;Window.h&quot;</span>
<a name="l04209"></a>04209 <span class="preprocessor">#include &quot;ActiveXHostVisual.h&quot;</span>
<a name="l04210"></a>04210 <span class="preprocessor">#include &quot;Thumb.h&quot;</span>
<a name="l04211"></a>04211 <span class="preprocessor">#include &quot;Track.h&quot;</span>
<a name="l04212"></a>04212 <span class="preprocessor">#include &quot;Scrollbar.h&quot;</span>
<a name="l04213"></a>04213 <span class="preprocessor">#include &quot;Slider.h&quot;</span>
<a name="l04214"></a>04214 <span class="preprocessor">#include &quot;ScrollViewer.h&quot;</span>
<a name="l04215"></a>04215 <span class="preprocessor">#include &quot;Viewport.h&quot;</span>
<a name="l04216"></a>04216 
<a name="l04217"></a>04217 <span class="keyword">namespace </span>System
<a name="l04218"></a>04218 {
<a name="l04219"></a>04219 <span class="keyword">namespace </span>Gui
<a name="l04220"></a>04220 {
<a name="l04221"></a>04221 
<a name="l04222"></a>04222 <span class="keyword">class </span>GUIEXT PrimitiveShape : <span class="keyword">public</span> Object
<a name="l04223"></a>04223 {
<a name="l04224"></a>04224 <span class="keyword">public</span>:
<a name="l04225"></a>04225         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">abstract</span>;
<a name="l04226"></a>04226         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">abstract</span>;
<a name="l04227"></a>04227         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Destroy()
<a name="l04228"></a>04228         {
<a name="l04229"></a>04229         }
<a name="l04230"></a>04230 };
<a name="l04231"></a>04231 
<a name="l04232"></a>04232 <span class="keyword">class </span>GUIEXT BitmapShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04233"></a>04233 {
<a name="l04234"></a>04234 <span class="keyword">public</span>:
<a name="l04235"></a>04235 
<a name="l04236"></a>04236         CTOR BitmapShape();
<a name="l04237"></a>04237 
<a name="l04238"></a>04238         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04239"></a>04239         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04240"></a>04240 
<a name="l04241"></a>04241         <span class="keywordtype">void</span> Create(Graphics::RenderTarget* rt, Graphics::Bitmap* bitmap, gm::RectF dstRect, gm::RectF srcRect);
<a name="l04242"></a>04242 
<a name="l04243"></a>04243         ID3D10Buffer* m_d3d10_VertexBuffer;     <span class="comment">// TODO, remove</span>
<a name="l04244"></a>04244         Graphics::VertexDeclaration m_vertexDeclaration;
<a name="l04245"></a>04245         Graphics::VertexBuffer m_vertexBuffer;
<a name="l04246"></a>04246 
<a name="l04247"></a>04247         Graphics::Bitmap* m_bitmap;
<a name="l04248"></a>04248 };
<a name="l04249"></a>04249 
<a name="l04250"></a>04250 <span class="comment">/*</span>
<a name="l04251"></a>04251 <span class="comment">class GUIEXT Texture2D : public Object</span>
<a name="l04252"></a>04252 <span class="comment">{</span>
<a name="l04253"></a>04253 <span class="comment">public:</span>
<a name="l04254"></a>04254 <span class="comment">};</span>
<a name="l04255"></a>04255 <span class="comment">*/</span>
<a name="l04256"></a>04256 
<a name="l04257"></a>04257 <span class="comment">/*</span>
<a name="l04258"></a>04258 <span class="comment">class GUIEXT BlendState : public Object</span>
<a name="l04259"></a>04259 <span class="comment">{</span>
<a name="l04260"></a>04260 <span class="comment">public:</span>
<a name="l04261"></a>04261 <span class="comment">};</span>
<a name="l04262"></a>04262 <span class="comment">*/</span>
<a name="l04263"></a>04263 
<a name="l04264"></a>04264 <span class="keyword">class </span>GUIEXT EffectBase : <span class="keyword">public</span> DependencyObject
<a name="l04265"></a>04265 {
<a name="l04266"></a>04266 <span class="keyword">public</span>:
<a name="l04267"></a>04267 };
<a name="l04268"></a>04268 
<a name="l04269"></a>04269 <span class="keyword">class </span>GUIEXT EffectTechniqueBase : <span class="keyword">public</span> DependencyObject
<a name="l04270"></a>04270 {
<a name="l04271"></a>04271 <span class="keyword">public</span>:
<a name="l04272"></a>04272 };
<a name="l04273"></a>04273 
<a name="l04274"></a>04274 <span class="keyword">class </span>GUIEXT DXEffect : <span class="keyword">public</span> Object
<a name="l04275"></a>04275 {
<a name="l04276"></a>04276 <span class="keyword">public</span>:
<a name="l04277"></a>04277 
<a name="l04278"></a>04278         CTOR DXEffect();
<a name="l04279"></a>04279         CTOR DXEffect(StringIn filename);
<a name="l04280"></a>04280 
<a name="l04281"></a>04281         <span class="keywordtype">bool</span> Load(StringIn filename);
<a name="l04282"></a>04282 
<a name="l04283"></a>04283         ClassType* GenerateClass(StringIn name);
<a name="l04284"></a>04284 
<a name="l04285"></a>04285         ID3DX10Effect* m_effect;
<a name="l04286"></a>04286         D3DX10_EFFECT_DESC m_desc;
<a name="l04287"></a>04287 };
<a name="l04288"></a>04288 
<a name="l04289"></a>04289 }
<a name="l04290"></a>04290 }
<a name="l04291"></a>04291 
<a name="l04292"></a>04292 <span class="preprocessor">#include &quot;TreeView.h&quot;</span>
<a name="l04293"></a>04293 
<a name="l04294"></a>04294 <span class="keyword">namespace </span>System
<a name="l04295"></a>04295 {
<a name="l04296"></a>04296 <span class="keyword">namespace </span>Gui
<a name="l04297"></a>04297 {
<a name="l04298"></a>04298 <span class="keyword">namespace </span>Media3D
<a name="l04299"></a>04299 {
<a name="l04300"></a>04300 
<a name="l04301"></a>04301 <span class="keyword">class </span>Document3D;
<a name="l04302"></a>04302 
<a name="l04303"></a>04303 <span class="keyword">class </span>GUIEXT BoxShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04304"></a>04304 {
<a name="l04305"></a>04305 <span class="keyword">public</span>:
<a name="l04306"></a>04306 
<a name="l04307"></a>04307         CTOR BoxShape()
<a name="l04308"></a>04308         {
<a name="l04309"></a>04309                 m_d3d10_VertexBuffer[0] = NULL;
<a name="l04310"></a>04310                 m_d3d10_VertexBuffer[1] = NULL;
<a name="l04311"></a>04311                 m_d3d10_IndexBuffer = NULL;
<a name="l04312"></a>04312         }
<a name="l04313"></a>04313 
<a name="l04314"></a>04314         <span class="keyword">virtual</span> ~BoxShape();
<a name="l04315"></a>04315 
<a name="l04316"></a>04316         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04317"></a>04317         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04318"></a>04318         <span class="keywordtype">void</span> Create(RenderContext* renderContext, gm::vector3f size);
<a name="l04319"></a>04319 
<a name="l04320"></a>04320         ID3D10Buffer* m_d3d10_VertexBuffer[2];
<a name="l04321"></a>04321         ID3D10Buffer* m_d3d10_IndexBuffer;
<a name="l04322"></a>04322 
<a name="l04323"></a>04323         Graphics::VertexDeclaration m_vertexDeclaration;
<a name="l04324"></a>04324         Graphics::VertexBuffer m_vertexBuffer;
<a name="l04325"></a>04325         Graphics::IndexBuffer m_indexBuffer;
<a name="l04326"></a>04326 };
<a name="l04327"></a>04327 
<a name="l04328"></a>04328 <span class="keyword">class </span>GUIEXT SphereShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04329"></a>04329 {
<a name="l04330"></a>04330 <span class="keyword">public</span>:
<a name="l04331"></a>04331 
<a name="l04332"></a>04332         CTOR SphereShape();
<a name="l04333"></a>04333         <span class="keyword">virtual</span> ~SphereShape();
<a name="l04334"></a>04334 
<a name="l04335"></a>04335         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04336"></a>04336         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04337"></a>04337         <span class="keywordtype">void</span> Create(RenderContext* renderContext, <span class="keywordtype">double</span> radius, <span class="keywordtype">int</span> slices, <span class="keywordtype">int</span> stacks);
<a name="l04338"></a>04338 
<a name="l04339"></a>04339         ID3D10Buffer* m_d3d10_VertexBuffer[2];
<a name="l04340"></a>04340         uint m_slices;
<a name="l04341"></a>04341         uint m_stacks;
<a name="l04342"></a>04342 };
<a name="l04343"></a>04343 
<a name="l04344"></a>04344 }       <span class="comment">// Media3D</span>
<a name="l04345"></a>04345 }       <span class="comment">// Gui</span>
<a name="l04346"></a>04346 }       <span class="comment">// System</span>
<a name="l04347"></a>04347 
<a name="l04348"></a>04348 <span class="preprocessor">#include &quot;Object3D.h&quot;</span>
<a name="l04349"></a>04349 <span class="preprocessor">#include &quot;Visual3D.h&quot;</span>
<a name="l04350"></a>04350 <span class="preprocessor">#include &quot;Geometry3D.h&quot;</span>
<a name="l04351"></a>04351 <span class="preprocessor">#include &quot;Material.h&quot;</span>
<a name="l04352"></a>04352 
<a name="l04353"></a>04353 <span class="keyword">namespace </span>System
<a name="l04354"></a>04354 {
<a name="l04355"></a>04355 <span class="keyword">namespace </span>Gui
<a name="l04356"></a>04356 {
<a name="l04357"></a>04357 <span class="keyword">namespace </span>Media3D
<a name="l04358"></a>04358 {
<a name="l04359"></a>04359 
<a name="l04360"></a>04360 <span class="keyword">class </span>GUIEXT Mesh : <span class="keyword">public</span> Geometry3D
<a name="l04361"></a>04361 {
<a name="l04362"></a>04362 <span class="keyword">public</span>:
<a name="l04363"></a>04363 
<a name="l04364"></a>04364         CTOR Mesh() : Geometry3D(get_Class())
<a name="l04365"></a>04365         {
<a name="l04366"></a>04366         }
<a name="l04367"></a>04367 
<a name="l04368"></a>04368         <span class="keywordtype">void</span> SetIndexData(<span class="keyword">const</span> <span class="keywordtype">void</span>* data, uint count)
<a name="l04369"></a>04369         {
<a name="l04370"></a>04370                 m_pMesh-&gt;SetIndexData(data, count);
<a name="l04371"></a>04371         }
<a name="l04372"></a>04372         <span class="keywordtype">void</span> SetVertexData(uint iBuffer, <span class="keyword">const</span> <span class="keywordtype">void</span>* data)
<a name="l04373"></a>04373         {
<a name="l04374"></a>04374                 m_pMesh-&gt;SetVertexData(iBuffer, data);
<a name="l04375"></a>04375         }
<a name="l04376"></a>04376 
<a name="l04377"></a>04377         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l04378"></a>04378 
<a name="l04379"></a>04379 <span class="comment">//      static void Init();</span>
<a name="l04380"></a>04380 
<a name="l04381"></a>04381         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l04382"></a>04382 <span class="comment">//      DEPENDENCY_CLASS(Mesh, Geometry3D)</span>
<a name="l04383"></a>04383 
<a name="l04384"></a>04384         vector&lt;Material*&gt; m_subsetMaterial;
<a name="l04385"></a>04385         ID3DX10Mesh* m_pMesh;
<a name="l04386"></a>04386 };
<a name="l04387"></a>04387 
<a name="l04388"></a>04388 }       <span class="comment">// Media3D</span>
<a name="l04389"></a>04389 }       <span class="comment">// Gui</span>
<a name="l04390"></a>04390 }       <span class="comment">// System</span>
<a name="l04391"></a>04391 
<a name="l04392"></a>04392 <span class="preprocessor">#include &quot;Box.h&quot;</span>
<a name="l04393"></a>04393 <span class="preprocessor">#include &quot;Sphere.h&quot;</span>
<a name="l04394"></a>04394 
<a name="l04395"></a>04395 <span class="keyword">namespace </span>System
<a name="l04396"></a>04396 {
<a name="l04397"></a>04397 <span class="keyword">namespace </span>Gui
<a name="l04398"></a>04398 {
<a name="l04399"></a>04399 <span class="keyword">namespace </span>Media3D
<a name="l04400"></a>04400 {
<a name="l04401"></a>04401 
<a name="l04402"></a>04402 <span class="keyword">class </span>GUIEXT Cylinder : <span class="keyword">public</span> Geometry3D
<a name="l04403"></a>04403 {
<a name="l04404"></a>04404 <span class="keyword">public</span>:
<a name="l04405"></a>04405 
<a name="l04406"></a>04406         CTOR Cylinder();
<a name="l04407"></a>04407 
<a name="l04408"></a>04408         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l04409"></a>04409 
<a name="l04410"></a>04410         DEPENDENCY_CLASS(Cylinder, Geometry3D)
<a name="l04411"></a>04411 
<a name="l04412"></a>04412         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; TopRadiusProperty;
<a name="l04413"></a>04413         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; BottomRadiusProperty;
<a name="l04414"></a>04414         static TypedDependencyProperty&lt;<span class="keywordtype">float</span>&gt; HeightProperty;
<a name="l04415"></a>04415 };
<a name="l04416"></a>04416 
<a name="l04417"></a>04417 class GUIEXT Torus : public Geometry3D
<a name="l04418"></a>04418 {
<a name="l04419"></a>04419 <span class="keyword">public</span>:
<a name="l04420"></a>04420 };
<a name="l04421"></a>04421 
<a name="l04422"></a>04422 <span class="keyword">class </span>GUIEXT HeightMap : <span class="keyword">public</span> Geometry3D
<a name="l04423"></a>04423 {
<a name="l04424"></a>04424 <span class="keyword">public</span>:
<a name="l04425"></a>04425         CTOR HeightMap() : Geometry3D(get_Class())
<a name="l04426"></a>04426         {
<a name="l04427"></a>04427         }
<a name="l04428"></a>04428 
<a name="l04429"></a>04429         <span class="keywordtype">void</span> set_Bitmap(Graphics::Bitmap* bitmap)
<a name="l04430"></a>04430         {
<a name="l04431"></a>04431                 m_bitmap = bitmap;
<a name="l04432"></a>04432         }
<a name="l04433"></a>04433 
<a name="l04434"></a>04434         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l04435"></a>04435 
<a name="l04436"></a>04436         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddShapeDesc(NxScene* scene, NxActorDesc* actorDesc);
<a name="l04437"></a>04437 
<a name="l04438"></a>04438         Graphics::Bitmap* m_bitmap;
<a name="l04439"></a>04439 
<a name="l04440"></a>04440         ID3D10InputLayout* m_inputLayout;
<a name="l04441"></a>04441         ID3D10Buffer* m_d3d10_VertexBuffer;
<a name="l04442"></a>04442         ID3D10Buffer* m_d3d10_IndexBuffer;
<a name="l04443"></a>04443 
<a name="l04444"></a>04444 <span class="comment">//      DEPENDENCY_CLASS(HeightMap, Geometry3D)</span>
<a name="l04445"></a>04445 
<a name="l04446"></a>04446         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l04447"></a>04447         <span class="keyword">static</span> DependencyClass* pClass;
<a name="l04448"></a>04448         <span class="keyword">typedef</span> Geometry3D baseClass;
<a name="l04449"></a>04449 };
<a name="l04450"></a>04450 
<a name="l04451"></a>04451 <span class="keyword">class </span>GUIEXT Light : <span class="keyword">public</span> Visual3D
<a name="l04452"></a>04452 {
<a name="l04453"></a>04453 <span class="keyword">protected</span>:
<a name="l04454"></a>04454         CTOR Light(DependencyClass* depClass);
<a name="l04455"></a>04455 
<a name="l04456"></a>04456 <span class="keyword">public</span>:
<a name="l04457"></a>04457 
<a name="l04458"></a>04458         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext)<span class="keyword"> override</span>
<a name="l04459"></a>04459 <span class="keyword">        </span>{
<a name="l04460"></a>04460         }
<a name="l04461"></a>04461 
<a name="l04462"></a>04462         DEPENDENCY_PROPERTY(Color*, Color)
<a name="l04463"></a>04463         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Intensity)
<a name="l04464"></a>04464         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, AmbientIntensity)
<a name="l04465"></a>04465 
<a name="l04466"></a>04466         DEPENDENCY_CLASS_ABSTRACT(Light, Visual3D)
<a name="l04467"></a>04467 };
<a name="l04468"></a>04468 
<a name="l04469"></a>04469 class GUIEXT DirectionalLight : public Light
<a name="l04470"></a>04470 {
<a name="l04471"></a>04471 <span class="keyword">public</span>:
<a name="l04472"></a>04472 
<a name="l04473"></a>04473 };
<a name="l04474"></a>04474 
<a name="l04475"></a>04475 }       <span class="comment">// Media3D</span>
<a name="l04476"></a>04476 }       <span class="comment">// Gui</span>
<a name="l04477"></a>04477 }       <span class="comment">// System</span>
<a name="l04478"></a>04478 
<a name="l04479"></a>04479 <span class="preprocessor">#include &quot;PointLight.h&quot;</span>
<a name="l04480"></a>04480 
<a name="l04481"></a>04481 <span class="keyword">namespace </span>System
<a name="l04482"></a>04482 {
<a name="l04483"></a>04483 <span class="keyword">namespace </span>Gui
<a name="l04484"></a>04484 {
<a name="l04485"></a>04485 <span class="keyword">namespace </span>Media3D
<a name="l04486"></a>04486 {
<a name="l04487"></a>04487 
<a name="l04488"></a>04488 <span class="keyword">class </span>GUIEXT Visual2D : <span class="keyword">public</span> Visual3D
<a name="l04489"></a>04489 {
<a name="l04490"></a>04490 <span class="keyword">public</span>:
<a name="l04491"></a>04491 };
<a name="l04492"></a>04492 
<a name="l04493"></a>04493 <span class="keyword">class </span>GUIEXT Particles : <span class="keyword">public</span> Visual3D
<a name="l04494"></a>04494 {
<a name="l04495"></a>04495 <span class="keyword">public</span>:
<a name="l04496"></a>04496 };
<a name="l04497"></a>04497 
<a name="l04498"></a>04498 <span class="keyword">class </span>ForceField : <span class="keyword">public</span> Visual3D
<a name="l04499"></a>04499 {
<a name="l04500"></a>04500 <span class="keyword">public</span>:
<a name="l04501"></a>04501 };
<a name="l04502"></a>04502 
<a name="l04503"></a>04503 <span class="preprocessor">#if 0</span>
<a name="l04504"></a>04504 <span class="preprocessor"></span><span class="keyword">struct </span>D3DXMESHCONTAINER_DERIVED : <span class="keyword">public</span> D3DXMESHCONTAINER
<a name="l04505"></a>04505 {
<a name="l04506"></a>04506     LPDIRECT3DTEXTURE9* ppTextures;       <span class="comment">// array of textures, entries are NULL if no texture specified    </span>
<a name="l04507"></a>04507 
<a name="l04508"></a>04508     <span class="comment">// SkinMesh info             </span>
<a name="l04509"></a>04509     LPD3DXMESH pOrigMesh;
<a name="l04510"></a>04510     LPD3DXATTRIBUTERANGE pAttributeTable;
<a name="l04511"></a>04511     DWORD NumAttributeGroups;
<a name="l04512"></a>04512     DWORD NumInfl;
<a name="l04513"></a>04513     LPD3DXBUFFER pBoneCombinationBuf;
<a name="l04514"></a>04514     D3DXMATRIX** ppBoneMatrixPtrs;
<a name="l04515"></a>04515     D3DXMATRIX* pBoneOffsetMatrices;
<a name="l04516"></a>04516     DWORD NumPaletteEntries;
<a name="l04517"></a>04517     <span class="keywordtype">bool</span> UseSoftwareVP;
<a name="l04518"></a>04518     DWORD iAttributeSW;     <span class="comment">// used to denote the split between SW and HW if necessary for non-indexed skinning</span>
<a name="l04519"></a>04519 };
<a name="l04520"></a>04520 <span class="preprocessor">#endif</span>
<a name="l04521"></a>04521 <span class="preprocessor"></span>
<a name="l04522"></a>04522 <span class="keyword">class </span>GUIEXT MeshContainer : <span class="keyword">public</span> Visual3D
<a name="l04523"></a>04523 {
<a name="l04524"></a>04524 <span class="keyword">public</span>:
<a name="l04525"></a>04525 
<a name="l04526"></a>04526         CTOR MeshContainer() : Visual3D(get_Class())
<a name="l04527"></a>04527         {
<a name="l04528"></a>04528         }
<a name="l04529"></a>04529 
<a name="l04530"></a>04530         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l04531"></a>04531 
<a name="l04532"></a>04532 <span class="comment">//      Mesh* m_mesh;</span>
<a name="l04533"></a>04533 
<a name="l04534"></a>04534         LPSTR Name;
<a name="l04535"></a>04535 
<a name="l04536"></a>04536         Mesh* m_mesh;
<a name="l04537"></a>04537 
<a name="l04538"></a>04538         ID3DX10Mesh* MeshData;
<a name="l04539"></a>04539 <span class="comment">//      D3DXMESHDATA            MeshData;</span>
<a name="l04540"></a>04540 
<a name="l04541"></a>04541         <span class="comment">/*</span>
<a name="l04542"></a>04542 <span class="comment">        LPD3DX10MATERIAL          pMaterials;</span>
<a name="l04543"></a>04543 <span class="comment">        LPD3DX10EFFECTINSTANCE    pEffects;</span>
<a name="l04544"></a>04544 <span class="comment">        DWORD                   NumMaterials;</span>
<a name="l04545"></a>04545 <span class="comment">        DWORD                  *pAdjacency;</span>
<a name="l04546"></a>04546 <span class="comment">*/</span>
<a name="l04547"></a>04547         ID3DX10SkinInfo* pSkinInfo;
<a name="l04548"></a>04548 
<a name="l04549"></a>04549 <span class="comment">//      struct _D3DXMESHCONTAINER *pNextMeshContainer;</span>
<a name="l04550"></a>04550 
<a name="l04552"></a>04552 
<a name="l04553"></a>04553         <span class="comment">// SkinMesh info             </span>
<a name="l04554"></a>04554         ID3DX10Mesh* pOrigMesh;
<a name="l04555"></a>04555 <span class="comment">//      D3DX10_ATTRIBUTE_RANGE* pAttributeTable;</span>
<a name="l04556"></a>04556         DWORD NumAttributeGroups;
<a name="l04557"></a>04557         DWORD NumInfl;
<a name="l04558"></a>04558 <span class="comment">//      ID3DX10Buffer* pBoneCombinationBuf;</span>
<a name="l04559"></a>04559         D3DXMATRIX** ppBoneMatrixPtrs;
<a name="l04560"></a>04560         D3DXMATRIX* pBoneOffsetMatrices;
<a name="l04561"></a>04561         DWORD NumPaletteEntries;
<a name="l04562"></a>04562         <span class="keywordtype">bool</span> UseSoftwareVP;
<a name="l04563"></a>04563         DWORD iAttributeSW;     <span class="comment">// used to denote the split between SW and HW if necessary for non-indexed skinning</span>
<a name="l04564"></a>04564 
<a name="l04565"></a>04565 <span class="comment">//      DEPENDENCY_CLASS(MeshContainer, Visual3D)</span>
<a name="l04566"></a>04566 };
<a name="l04567"></a>04567 
<a name="l04568"></a>04568 <span class="keyword">class </span>GUIEXT Shape3D : <span class="keyword">public</span> Visual3D
<a name="l04569"></a>04569 {
<a name="l04570"></a>04570 <span class="keyword">public</span>:
<a name="l04571"></a>04571         CTOR Shape3D();
<a name="l04572"></a>04572 
<a name="l04573"></a>04573         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l04574"></a>04574 
<a name="l04575"></a>04575         DEPENDENCY_PROPERTY(Geometry3D*, Geometry)
<a name="l04576"></a>04576         DEPENDENCY_PROPERTY(Material*, Material)
<a name="l04577"></a>04577 
<a name="l04578"></a>04578         DEPENDENCY_CLASS(Shape3D, Visual3D)
<a name="l04579"></a>04579 };
<a name="l04580"></a>04580 
<a name="l04581"></a>04581 }       <span class="comment">// Media3D</span>
<a name="l04582"></a>04582 }       <span class="comment">// Gui</span>
<a name="l04583"></a>04583 }       <span class="comment">// System</span>
<a name="l04584"></a>04584 
<a name="l04585"></a>04585 <span class="preprocessor">#include &quot;GeneralTransform3D.h&quot;</span>
<a name="l04586"></a>04586 <span class="preprocessor"></span><span class="preprocessor">#include &quot;Transform3D.h&quot;</span>
<a name="l04587"></a>04587 <span class="preprocessor">#include &quot;TranslateTransform3D.h&quot;</span>
<a name="l04588"></a>04588 <span class="preprocessor">#include &quot;ScaleTransform3D.h&quot;</span>
<a name="l04589"></a>04589 
<a name="l04590"></a>04590 <span class="keyword">namespace </span>System
<a name="l04591"></a>04591 {
<a name="l04592"></a>04592 <span class="keyword">namespace </span>Gui
<a name="l04593"></a>04593 {
<a name="l04594"></a>04594 <span class="keyword">namespace </span>Media3D
<a name="l04595"></a>04595 {
<a name="l04596"></a>04596 
<a name="l04597"></a>04597 <span class="comment">/*</span>
<a name="l04598"></a>04598 <span class="comment">class GUIEXT RotateTransform3D : public Transform3D</span>
<a name="l04599"></a>04599 <span class="comment">{</span>
<a name="l04600"></a>04600 <span class="comment">public:</span>
<a name="l04601"></a>04601 <span class="comment"></span>
<a name="l04602"></a>04602 <span class="comment">        CTOR RotateTransform3D();</span>
<a name="l04603"></a>04603 <span class="comment"></span>
<a name="l04604"></a>04604 <span class="comment">        virtual D3DXMATRIX GetMatrix() override;</span>
<a name="l04605"></a>04605 <span class="comment"></span>
<a name="l04606"></a>04606 <span class="comment">        static DependencyClass s_Class;</span>
<a name="l04607"></a>04607 <span class="comment"></span>
<a name="l04608"></a>04608 <span class="comment">        static TypedDependencyProperty&lt;float&gt; AxisXProperty;</span>
<a name="l04609"></a>04609 <span class="comment">        static TypedDependencyProperty&lt;float&gt; AxisYProperty;</span>
<a name="l04610"></a>04610 <span class="comment">        static TypedDependencyProperty&lt;float&gt; AxisZProperty;</span>
<a name="l04611"></a>04611 <span class="comment">        static TypedDependencyProperty&lt;float&gt; AngleProperty;</span>
<a name="l04612"></a>04612 <span class="comment">};</span>
<a name="l04613"></a>04613 <span class="comment">*/</span>
<a name="l04614"></a>04614 
<a name="l04615"></a>04615 <span class="keyword">class </span>GUIEXT MatrixTransform3D : <span class="keyword">public</span> Transform3D
<a name="l04616"></a>04616 {
<a name="l04617"></a>04617 <span class="keyword">public</span>:
<a name="l04618"></a>04618         CTOR MatrixTransform3D();
<a name="l04619"></a>04619 
<a name="l04620"></a>04620         <span class="keyword">virtual</span> D3DXMATRIX GetMatrix() <span class="keyword">override</span>;
<a name="l04621"></a>04621 
<a name="l04622"></a>04622         DEPENDENCY_CLASS(MatrixTransform3D, Transform3D)
<a name="l04623"></a>04623 
<a name="l04624"></a>04624         D3DXMATRIX m_matrix;
<a name="l04625"></a>04625 };
<a name="l04626"></a>04626 
<a name="l04627"></a>04627 class GUIEXT Group : public Visual3D
<a name="l04628"></a>04628 {
<a name="l04629"></a>04629 <span class="keyword">public</span>:
<a name="l04630"></a>04630 
<a name="l04631"></a>04631         CTOR Group();
<a name="l04632"></a>04632 
<a name="l04633"></a>04633         <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> GetChildrenCount() throw () override;
<a name="l04634"></a>04634         virtual Visual3D* GetChild(<span class="keywordtype">size_t</span> index) throw (ArgumentOutOfRangeException*) override;
<a name="l04635"></a>04635 
<a name="l04636"></a>04636         <span class="keywordtype">void</span> AddChild(Visual3D* obj) throw (ArgumentNullException*);
<a name="l04637"></a>04637 
<a name="l04638"></a>04638         <span class="comment">/*</span>
<a name="l04639"></a>04639 <span class="comment">        void SetTransform(const LDraw::matrix4f&amp; transform)</span>
<a name="l04640"></a>04640 <span class="comment">        {</span>
<a name="l04641"></a>04641 <span class="comment">                m_transform = transform;</span>
<a name="l04642"></a>04642 <span class="comment">        }</span>
<a name="l04643"></a>04643 <span class="comment">        */</span>
<a name="l04644"></a>04644 
<a name="l04645"></a>04645         virtual <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) override;
<a name="l04646"></a>04646         virtual <span class="keywordtype">void</span> SetLight(ImmediateRenderContext*) override;
<a name="l04647"></a>04647 
<a name="l04648"></a>04648         DEPENDENCY_CLASS(Group, Visual3D)
<a name="l04649"></a>04649 
<a name="l04650"></a>04650         vector&lt;Visual3D*&gt; m_children;
<a name="l04651"></a>04651 <span class="comment">//      LDraw::matrix4f m_transform;</span>
<a name="l04652"></a>04652 };
<a name="l04653"></a>04653 
<a name="l04654"></a>04654 class RayMeshIntersect : public DependencyProperty
<a name="l04655"></a>04655 {
<a name="l04656"></a>04656 <span class="keyword">public</span>:
<a name="l04657"></a>04657 
<a name="l04658"></a>04658         <span class="comment">// in</span>
<a name="l04659"></a>04659         <span class="keyword">static</span> TypedDependencyProperty&lt;Mesh*&gt; MeshProperty;
<a name="l04660"></a>04660         <span class="keyword">static</span> TypedDependencyProperty&lt;Vector3_F*&gt; RayStartProperty;
<a name="l04661"></a>04661         <span class="keyword">static</span> TypedDependencyProperty&lt;Vector3_F*&gt; RayDirectionProperty;
<a name="l04662"></a>04662 
<a name="l04663"></a>04663         <span class="comment">// out</span>
<a name="l04664"></a>04664         <span class="keyword">static</span> TypedDependencyProperty&lt;int&gt; FaceIndexProperty;
<a name="l04665"></a>04665         <span class="keyword">static</span> TypedDependencyProperty&lt;float&gt; UProperty;
<a name="l04666"></a>04666         <span class="keyword">static</span> TypedDependencyProperty&lt;float&gt; VProperty;
<a name="l04667"></a>04667         <span class="keyword">static</span> TypedDependencyProperty&lt;float&gt; DistProperty;
<a name="l04668"></a>04668 };
<a name="l04669"></a>04669 
<a name="l04670"></a>04670 <span class="keyword">class </span>GUIEXT AnimationKey : <span class="keyword">public</span> Object
<a name="l04671"></a>04671 {
<a name="l04672"></a>04672 <span class="keyword">public</span>:
<a name="l04673"></a>04673         <span class="keywordtype">double</span> m_time;
<a name="l04674"></a>04674 };
<a name="l04675"></a>04675 
<a name="l04676"></a>04676 <span class="keyword">class </span>GUIEXT Animation : <span class="keyword">public</span> Object
<a name="l04677"></a>04677 {
<a name="l04678"></a>04678 <span class="keyword">public</span>:
<a name="l04679"></a>04679         Object3D* m_Target;
<a name="l04680"></a>04680 
<a name="l04681"></a>04681         vector&lt;AnimationKey*&gt; m_keys;
<a name="l04682"></a>04682 };
<a name="l04683"></a>04683 
<a name="l04684"></a>04684 <span class="comment">/*</span>
<a name="l04685"></a>04685 <span class="comment">interface Object3DCollection</span>
<a name="l04686"></a>04686 <span class="comment">{</span>
<a name="l04687"></a>04687 <span class="comment">};</span>
<a name="l04688"></a>04688 <span class="comment">*/</span>
<a name="l04689"></a>04689 
<a name="l04690"></a>04690 <span class="keyword">class </span>GUIEXT MatrixAnimationKey : <span class="keyword">public</span> AnimationKey
<a name="l04691"></a>04691 {
<a name="l04692"></a>04692 <span class="keyword">public</span>:
<a name="l04693"></a>04693         CTOR MatrixAnimationKey()
<a name="l04694"></a>04694         {
<a name="l04695"></a>04695         }
<a name="l04696"></a>04696 
<a name="l04697"></a>04697         gm::matrix4f m_value;
<a name="l04698"></a>04698 };
<a name="l04699"></a>04699 
<a name="l04700"></a>04700 <span class="keyword">class </span>GUIEXT MatrixAnimation : <span class="keyword">public</span> Animation
<a name="l04701"></a>04701 {
<a name="l04702"></a>04702 <span class="keyword">public</span>:
<a name="l04703"></a>04703         CTOR MatrixAnimation()
<a name="l04704"></a>04704         {
<a name="l04705"></a>04705                 m_Target = NULL;
<a name="l04706"></a>04706         }
<a name="l04707"></a>04707 };
<a name="l04708"></a>04708 
<a name="l04709"></a>04709 <span class="keyword">class </span>GUIEXT Document3D : <span class="keyword">public</span> Object
<a name="l04710"></a>04710 {
<a name="l04711"></a>04711 <span class="keyword">public</span>:
<a name="l04712"></a>04712 <span class="comment">//      virtual Group* CreateGroup(String name) = 0;</span>
<a name="l04713"></a>04713 <span class="comment">//      virtual IMesh* CreateMesh(uint nVertices, uint nFaces) = 0;</span>
<a name="l04714"></a>04714         Object3D* FindByName(String name);
<a name="l04715"></a>04715         <span class="keywordtype">void</span> AddAnimation(Animation* animation);
<a name="l04716"></a>04716 };
<a name="l04717"></a>04717 
<a name="l04718"></a>04718 <span class="keyword">class </span>GUIEXT Camera : <span class="keyword">public</span> DependencyObject, <span class="keyword">public</span> ICamera
<a name="l04719"></a>04719 {
<a name="l04720"></a>04720 <span class="keyword">protected</span>:
<a name="l04721"></a>04721 
<a name="l04722"></a>04722         CTOR Camera(DependencyClass* depClass) : DependencyObject(depClass)
<a name="l04723"></a>04723         {
<a name="l04724"></a>04724         }
<a name="l04725"></a>04725 
<a name="l04726"></a>04726 <span class="keyword">public</span>:
<a name="l04727"></a>04727 
<a name="l04728"></a>04728 <span class="comment">//      static DependencyClass* get_Class();</span>
<a name="l04729"></a>04729 <span class="comment">//      typedef DependencyObject baseClass;</span>
<a name="l04730"></a>04730         DEPENDENCY_CLASS_ABSTRACT(Camera, DependencyObject)
<a name="l04731"></a>04731 };
<a name="l04732"></a>04732 
<a name="l04733"></a>04733 }       <span class="comment">// Media3D</span>
<a name="l04734"></a>04734 }       <span class="comment">// Gui</span>
<a name="l04735"></a>04735 }       <span class="comment">// System</span>
<a name="l04736"></a>04736 
<a name="l04737"></a>04737 <span class="preprocessor">#include &quot;PerspectiveCamera.h&quot;</span>
<a name="l04738"></a>04738 <span class="preprocessor">#include &quot;Object3DVisual.h&quot;</span>
<a name="l04739"></a>04739 
<a name="l04740"></a>04740 <span class="keyword">namespace </span>System
<a name="l04741"></a>04741 {
<a name="l04742"></a>04742 <span class="keyword">namespace </span>Gui
<a name="l04743"></a>04743 {
<a name="l04744"></a>04744 <span class="keyword">namespace </span>Media3D
<a name="l04745"></a>04745 {
<a name="l04746"></a>04746 
<a name="l04747"></a>04747 <span class="keyword">struct </span>VERTEX_XYZ_NORMAL
<a name="l04748"></a>04748 {
<a name="l04749"></a>04749         gm::vector3f position;
<a name="l04750"></a>04750         gm::vector3f normal;
<a name="l04751"></a>04751 };
<a name="l04752"></a>04752 
<a name="l04753"></a>04753 <span class="keyword">struct </span>VERTEX_XYZ_COLOR
<a name="l04754"></a>04754 {
<a name="l04755"></a>04755         gm::vector3f position;
<a name="l04756"></a>04756         gm::vector4f color;
<a name="l04757"></a>04757 };
<a name="l04758"></a>04758 
<a name="l04759"></a>04759 <span class="keyword">struct </span>VERTEX_NORMAL_TEX
<a name="l04760"></a>04760 {
<a name="l04761"></a>04761         gm::vector3f position;
<a name="l04762"></a>04762         gm::vector3f normal;
<a name="l04763"></a>04763         gm::vector2f texCoord[1];
<a name="l04764"></a>04764 };
<a name="l04765"></a>04765 
<a name="l04766"></a>04766 <span class="keyword">class </span>GUIEXT SkySphereShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04767"></a>04767 {
<a name="l04768"></a>04768 <span class="keyword">public</span>:
<a name="l04769"></a>04769 
<a name="l04770"></a>04770         CTOR SkySphereShape();
<a name="l04771"></a>04771         <span class="keyword">virtual</span> ~SkySphereShape();
<a name="l04772"></a>04772 
<a name="l04773"></a>04773         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04774"></a>04774         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04775"></a>04775         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Destroy() <span class="keyword">override</span>;
<a name="l04776"></a>04776         <span class="keywordtype">void</span> Create(RenderContext* renderContext, <span class="keywordtype">double</span> radius, <span class="keywordtype">int</span> slices, vector&lt;float&gt;&amp; angles, vector&lt;gm::vector4f&gt;&amp; colors, <span class="keywordtype">int</span> nsign = 1);
<a name="l04777"></a>04777 
<a name="l04778"></a>04778         ID3DX10EffectTechnique* m_d3d10_technique;
<a name="l04779"></a>04779         ID3D10Buffer* m_d3d10_VertexBuffer[1];
<a name="l04780"></a>04780         ID3D10InputLayout* m_inputLayout;
<a name="l04781"></a>04781         uint m_slices;
<a name="l04782"></a>04782         uint m_stacks;
<a name="l04783"></a>04783 };
<a name="l04784"></a>04784 
<a name="l04785"></a>04785 <span class="keyword">class </span>GUIEXT Lines2 : <span class="keyword">public</span> PrimitiveShape
<a name="l04786"></a>04786 {
<a name="l04787"></a>04787 <span class="keyword">public</span>:
<a name="l04788"></a>04788 
<a name="l04789"></a>04789         CTOR Lines2();
<a name="l04790"></a>04790         <span class="keyword">virtual</span> ~Lines2();
<a name="l04791"></a>04791 
<a name="l04792"></a>04792         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04793"></a>04793         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04794"></a>04794         <span class="keywordtype">void</span> Create(RenderContext* renderContext, gm::vector3f* points, uint nvertices, gm::vector3f* colors, <span class="keywordtype">bool</span> colorPerVertex);
<a name="l04795"></a>04795         <span class="keywordtype">void</span> Create(RenderContext* renderContext, gm::vector3f* points, uint nvertices, gm::vector4f color);
<a name="l04796"></a>04796 
<a name="l04797"></a>04797         ID3D10Buffer* m_d3d10_VertexBuffer;
<a name="l04798"></a>04798         uint m_nvertices;
<a name="l04799"></a>04799 };
<a name="l04800"></a>04800 
<a name="l04801"></a>04801 <span class="keyword">class </span>GUIEXT IndexedLines : <span class="keyword">public</span> PrimitiveShape
<a name="l04802"></a>04802 {
<a name="l04803"></a>04803 <span class="keyword">public</span>:
<a name="l04804"></a>04804 
<a name="l04805"></a>04805         CTOR IndexedLines();
<a name="l04806"></a>04806         <span class="keyword">virtual</span> ~IndexedLines();
<a name="l04807"></a>04807 
<a name="l04808"></a>04808         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04809"></a>04809         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04810"></a>04810         <span class="keywordtype">void</span> Create(RenderContext* renderContext, gm::vector3f* points, uint nvertices, uint* indices, uint nindices, gm::vector4f color);
<a name="l04811"></a>04811 
<a name="l04812"></a>04812         ID3D10Buffer* m_d3d10_VertexBuffer;
<a name="l04813"></a>04813         ID3D10Buffer* m_d3d10_IndexBuffer;
<a name="l04814"></a>04814         uint m_nvertices;
<a name="l04815"></a>04815         uint m_nindices;
<a name="l04816"></a>04816 };
<a name="l04817"></a>04817 
<a name="l04818"></a>04818 <span class="keyword">class </span>GUIEXT CylinderShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04819"></a>04819 {
<a name="l04820"></a>04820 <span class="keyword">public</span>:
<a name="l04821"></a>04821 
<a name="l04822"></a>04822         CTOR CylinderShape()
<a name="l04823"></a>04823         {
<a name="l04824"></a>04824                 m_d3d10_VertexBuffer = NULL;
<a name="l04825"></a>04825         }
<a name="l04826"></a>04826 
<a name="l04827"></a>04827         <span class="keyword">virtual</span> ~CylinderShape();
<a name="l04828"></a>04828 
<a name="l04829"></a>04829         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04830"></a>04830         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04831"></a>04831         <span class="keywordtype">void</span> Create(RenderContext* renderContext, <span class="keywordtype">float</span> bottomRadius, <span class="keywordtype">float</span> topRadius, <span class="keywordtype">float</span> height);
<a name="l04832"></a>04832 
<a name="l04833"></a>04833         ID3D10Buffer* m_d3d10_VertexBuffer;
<a name="l04834"></a>04834         uint m_nvertices;
<a name="l04835"></a>04835 };
<a name="l04836"></a>04836 
<a name="l04837"></a>04837 <span class="keyword">class </span>GUIEXT DiskShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04838"></a>04838 {
<a name="l04839"></a>04839 <span class="keyword">public</span>:
<a name="l04840"></a>04840 
<a name="l04841"></a>04841         CTOR DiskShape();
<a name="l04842"></a>04842 
<a name="l04843"></a>04843         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04844"></a>04844         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04845"></a>04845         <span class="keywordtype">void</span> Create(RenderContext* renderContext, <span class="keywordtype">float</span> innerRadius, <span class="keywordtype">float</span> outerRadius);
<a name="l04846"></a>04846 
<a name="l04847"></a>04847         ID3D10Buffer* m_d3d10_VertexBuffer;
<a name="l04848"></a>04848         ID3D10Buffer* m_d3d10_IndexBuffer;
<a name="l04849"></a>04849 };
<a name="l04850"></a>04850 
<a name="l04851"></a>04851 <span class="keyword">class </span>GUIEXT Rectangle2DShape : <span class="keyword">public</span> PrimitiveShape
<a name="l04852"></a>04852 {
<a name="l04853"></a>04853 <span class="keyword">public</span>:
<a name="l04854"></a>04854 
<a name="l04855"></a>04855         CTOR Rectangle2DShape();
<a name="l04856"></a>04856         <span class="keyword">virtual</span> ~Rectangle2DShape();
<a name="l04857"></a>04857 
<a name="l04858"></a>04858         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsValid(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04859"></a>04859         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Draw(ImmediateRenderContext* renderContext) <span class="keyword">override</span>;
<a name="l04860"></a>04860         <span class="keywordtype">void</span> Create(RenderContext* renderContext, gm::vector2f size);
<a name="l04861"></a>04861 
<a name="l04862"></a>04862         ID3D10Buffer* m_d3d10_VertexBuffer[2];
<a name="l04863"></a>04863 };
<a name="l04864"></a>04864 
<a name="l04865"></a>04865 }
<a name="l04866"></a>04866 
<a name="l04867"></a>04867 <span class="keyword">class </span>GUIEXT Viewbox : <span class="keyword">public</span> Decorator
<a name="l04868"></a>04868 {
<a name="l04869"></a>04869 <span class="keyword">public</span>:
<a name="l04870"></a>04870 
<a name="l04871"></a>04871         CTOR Viewbox();
<a name="l04872"></a>04872 
<a name="l04873"></a>04873         gm::RectF m_rect;
<a name="l04874"></a>04874 
<a name="l04875"></a>04875         <span class="keyword">static</span> DependencyClass Class;
<a name="l04876"></a>04876 
<a name="l04877"></a>04877 <span class="keyword">protected</span>:
<a name="l04878"></a>04878 
<a name="l04879"></a>04879         <span class="keyword">virtual</span> <span class="keywordtype">void</span> RenderRetained(ManagedRetainedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l04880"></a>04880 };
<a name="l04881"></a>04881 
<a name="l04882"></a>04882 <span class="keyword">class </span>GUIEXT ItemsControl : <span class="keyword">public</span> Control
<a name="l04883"></a>04883 {
<a name="l04884"></a>04884 <span class="keyword">public</span>:
<a name="l04885"></a>04885         CTOR ItemsControl(DependencyClass* depClass);
<a name="l04886"></a>04886 
<a name="l04887"></a>04887         <span class="keyword">virtual</span> <span class="keywordtype">void</span> AddItem(Object* item);
<a name="l04888"></a>04888         <span class="keywordtype">void</span> AddItem(StringIn str);
<a name="l04889"></a>04889 
<a name="l04890"></a>04890         DEPENDENCY_PROPERTY(<span class="keywordtype">int</span>, SelectedIndex)
<a name="l04891"></a>04891         DEPENDENCY_PROPERTY(Object*, SelectedItem)
<a name="l04892"></a>04892 
<a name="l04893"></a>04893         DEPENDENCY_CLASS_ABSTRACT(ItemsControl, Control)
<a name="l04894"></a>04894 
<a name="l04895"></a>04895 protected:
<a name="l04896"></a>04896 
<a name="l04897"></a>04897         map&lt;Object*,UIElement*&gt; m_objectToElement;
<a name="l04898"></a>04898         map&lt;UIElement*,Object*&gt; m_elementToObject;
<a name="l04899"></a>04899 
<a name="l04900"></a>04900         virtual <span class="keywordtype">void</span> OnAddElement(UIElement* element) abstract;
<a name="l04901"></a>04901 };
<a name="l04902"></a>04902 
<a name="l04903"></a>04903 }
<a name="l04904"></a>04904 }
<a name="l04905"></a>04905 
<a name="l04906"></a>04906 <span class="preprocessor">#include &quot;ListBox.h&quot;</span>
<a name="l04907"></a>04907 <span class="preprocessor"></span>
<a name="l04908"></a>04908 <span class="keyword">namespace </span>System
<a name="l04909"></a>04909 {
<a name="l04910"></a>04910 <span class="keyword">namespace </span>Gui
<a name="l04911"></a>04911 {
<a name="l04912"></a>04912 <span class="comment">/*</span>
<a name="l04913"></a>04913 <span class="comment">class GUIEXT Module</span>
<a name="l04914"></a>04914 <span class="comment">{</span>
<a name="l04915"></a>04915 <span class="comment">};</span>
<a name="l04916"></a>04916 <span class="comment">*/</span>
<a name="l04917"></a>04917 
<a name="l04918"></a>04918 <span class="keyword">class </span>GUIEXT TimeManager
<a name="l04919"></a>04919 {
<a name="l04920"></a>04920 <span class="keyword">public</span>:
<a name="l04921"></a>04921 
<a name="l04922"></a>04922         <span class="keywordtype">void</span> Tick();
<a name="l04923"></a>04923 
<a name="l04924"></a>04924         <span class="keyword">static</span> TimeManager manager;
<a name="l04925"></a>04925 
<a name="l04926"></a>04926         <span class="keyword">static</span> ValueBinding&lt;double&gt;* get_GlobalTime();
<a name="l04927"></a>04927 
<a name="l04928"></a>04928         Event1&lt;double&gt; OnTick;
<a name="l04929"></a>04929 
<a name="l04930"></a>04930 <span class="keyword">private</span>:
<a name="l04931"></a>04931 
<a name="l04932"></a>04932         CTOR TimeManager();
<a name="l04933"></a>04933 
<a name="l04934"></a>04934         <span class="keyword">static</span> ValueBinding&lt;double&gt; s_GlobalTime;
<a name="l04935"></a>04935 
<a name="l04936"></a>04936         list&lt;Clock*&gt; m_clocks;  <span class="comment">// TODO remove ??</span>
<a name="l04937"></a>04937 <span class="comment">//      double m_globalTime;</span>
<a name="l04938"></a>04938 };
<a name="l04939"></a>04939 
<a name="l04940"></a>04940 <span class="keyword">class </span>GUIEXT ColorDialog
<a name="l04941"></a>04941 {
<a name="l04942"></a>04942 <span class="keyword">public</span>:
<a name="l04943"></a>04943         <span class="keyword">static</span> ColorF ChooseColor();
<a name="l04944"></a>04944 
<a name="l04945"></a>04945         COLORREF m_customColors[16];
<a name="l04946"></a>04946 
<a name="l04947"></a>04947         <span class="keyword">static</span> COLORREF customColors[16];
<a name="l04948"></a>04948 };
<a name="l04949"></a>04949 
<a name="l04950"></a>04950 }       <span class="comment">// Gui</span>
<a name="l04951"></a>04951 }       <span class="comment">// System</span>
<a name="l04952"></a>04952 
<a name="l04953"></a>04953 <span class="preprocessor">#include &quot;Clipboard.h&quot;</span>
<a name="l04954"></a>04954 
<a name="l04955"></a>04955 <span class="preprocessor">#include &quot;Application.h&quot;</span>
<a name="l04956"></a>04956 
<a name="l04957"></a>04957 <span class="keyword">namespace </span>System
<a name="l04958"></a>04958 {
<a name="l04959"></a>04959 <span class="keyword">namespace </span>Gui
<a name="l04960"></a>04960 {
<a name="l04961"></a>04961 
<a name="l04962"></a>04962 <span class="keyword">class </span>GUIEXT Directory : <span class="keyword">public</span> Object
<a name="l04963"></a>04963 {
<a name="l04964"></a>04964 <span class="keyword">public</span>:
<a name="l04965"></a>04965 
<a name="l04966"></a>04966         CTOR Directory();
<a name="l04967"></a>04967 
<a name="l04968"></a>04968         <span class="keyword">virtual</span> String ToString()<span class="keyword"> override</span>
<a name="l04969"></a>04969 <span class="keyword">        </span>{
<a name="l04970"></a>04970                 <span class="keywordflow">return</span> m_path;
<a name="l04971"></a>04971         }
<a name="l04972"></a>04972 
<a name="l04973"></a>04973         Event1&lt;int&gt;&amp; get_Changed()
<a name="l04974"></a>04974         {
<a name="l04975"></a>04975                 <span class="keywordflow">return</span> Changed;
<a name="l04976"></a>04976         }
<a name="l04977"></a>04977 
<a name="l04978"></a>04978         Event1&lt;int&gt; Changed;
<a name="l04979"></a>04979         String m_path;
<a name="l04980"></a>04980 
<a name="l04981"></a>04981         <span class="keyword">static</span> Directory* get_Current();
<a name="l04982"></a>04982 
<a name="l04983"></a>04983 <span class="keyword">private</span>:
<a name="l04984"></a>04984 
<a name="l04985"></a>04985         <span class="keyword">static</span> Directory s_Current;
<a name="l04986"></a>04986 };
<a name="l04987"></a>04987 
<a name="l04988"></a>04988 <span class="keyword">extern</span> GUIEXT IXAudio2* pXAudio2;
<a name="l04989"></a>04989 <span class="keyword">extern</span> GUIEXT IXAudio2MasteringVoice* pMasteringVoice;
<a name="l04990"></a>04990 
<a name="l04991"></a>04991 <span class="keyword">class </span>WaveformVisual;
<a name="l04992"></a>04992 
<a name="l04993"></a>04993 }       <span class="comment">// Gui</span>
<a name="l04994"></a>04994 
<a name="l04995"></a>04995 <span class="keyword">class </span>CoString
<a name="l04996"></a>04996 {
<a name="l04997"></a>04997 <span class="keyword">public</span>:
<a name="l04998"></a>04998 
<a name="l04999"></a>04999         CTOR CoString() : m_wstr(nullptr)
<a name="l05000"></a>05000         {
<a name="l05001"></a>05001         }
<a name="l05002"></a>05002 
<a name="l05003"></a>05003         ~CoString()
<a name="l05004"></a>05004         {
<a name="l05005"></a>05005                 CoTaskMemFree(m_wstr);
<a name="l05006"></a>05006                 m_wstr = <span class="keyword">nullptr</span>;
<a name="l05007"></a>05007         }
<a name="l05008"></a>05008 
<a name="l05009"></a>05009         operator LPWSTR ()<span class="keyword"> const</span>
<a name="l05010"></a>05010 <span class="keyword">        </span>{
<a name="l05011"></a>05011                 <span class="keywordflow">return</span> m_wstr;
<a name="l05012"></a>05012         }
<a name="l05013"></a>05013 
<a name="l05014"></a>05014         LPWSTR* operator &amp; ()
<a name="l05015"></a>05015         {
<a name="l05016"></a>05016                 ASSERT(m_wstr == <span class="keyword">nullptr</span>);
<a name="l05017"></a>05017                 <span class="keywordflow">return</span> &amp;m_wstr;
<a name="l05018"></a>05018         }
<a name="l05019"></a>05019 
<a name="l05020"></a>05020         LPWSTR data()<span class="keyword"> const</span>
<a name="l05021"></a>05021 <span class="keyword">        </span>{
<a name="l05022"></a>05022                 <span class="keywordflow">return</span> m_wstr;
<a name="l05023"></a>05023         }
<a name="l05024"></a>05024 
<a name="l05025"></a>05025         LPWSTR Detach()
<a name="l05026"></a>05026         {
<a name="l05027"></a>05027                 LPWSTR wstr = m_wstr;
<a name="l05028"></a>05028                 m_wstr = <span class="keyword">nullptr</span>;
<a name="l05029"></a>05029                 <span class="keywordflow">return</span> wstr;
<a name="l05030"></a>05030         }
<a name="l05031"></a>05031 
<a name="l05032"></a>05032         LPWSTR m_wstr;
<a name="l05033"></a>05033 };
<a name="l05034"></a>05034 
<a name="l05035"></a>05035 <span class="keyword">class </span>GUIEXT KnownFolders
<a name="l05036"></a>05036 {
<a name="l05037"></a>05037 <span class="keyword">public</span>:
<a name="l05038"></a>05038 
<a name="l05039"></a>05039         <span class="keyword">static</span> String GetPathOf(<span class="keyword">const</span> KNOWNFOLDERID&amp; folderid);
<a name="l05040"></a>05040 
<a name="l05041"></a>05041         <span class="keyword">static</span> String get_Pictures()
<a name="l05042"></a>05042         {
<a name="l05043"></a>05043                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Pictures);
<a name="l05044"></a>05044         }
<a name="l05045"></a>05045 
<a name="l05046"></a>05046         <span class="keyword">static</span> String get_PublicPictures()
<a name="l05047"></a>05047         {
<a name="l05048"></a>05048                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_PublicPictures);
<a name="l05049"></a>05049         }
<a name="l05050"></a>05050 
<a name="l05051"></a>05051         <span class="keyword">static</span> String get_Videos()
<a name="l05052"></a>05052         {
<a name="l05053"></a>05053                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Videos);
<a name="l05054"></a>05054         }
<a name="l05055"></a>05055 
<a name="l05056"></a>05056         <span class="keyword">static</span> String get_PublicVideos()
<a name="l05057"></a>05057         {
<a name="l05058"></a>05058                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_PublicVideos);
<a name="l05059"></a>05059         }
<a name="l05060"></a>05060 
<a name="l05061"></a>05061         <span class="keyword">static</span> String get_Downloads()
<a name="l05062"></a>05062         {
<a name="l05063"></a>05063                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Downloads);
<a name="l05064"></a>05064         }
<a name="l05065"></a>05065 
<a name="l05066"></a>05066         <span class="keyword">static</span> String get_PublicDownloads()
<a name="l05067"></a>05067         {
<a name="l05068"></a>05068                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_PublicDownloads);
<a name="l05069"></a>05069         }
<a name="l05070"></a>05070 
<a name="l05071"></a>05071         <span class="keyword">static</span> String get_Cookies()
<a name="l05072"></a>05072         {
<a name="l05073"></a>05073                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Cookies);
<a name="l05074"></a>05074         }
<a name="l05075"></a>05075 
<a name="l05076"></a>05076         <span class="keyword">static</span> String get_ControlPanelFolder()
<a name="l05077"></a>05077         {
<a name="l05078"></a>05078                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_ControlPanelFolder);
<a name="l05079"></a>05079         }
<a name="l05080"></a>05080 
<a name="l05081"></a>05081         <span class="keyword">static</span> String get_Documents()
<a name="l05082"></a>05082         {
<a name="l05083"></a>05083                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Documents);
<a name="l05084"></a>05084         }
<a name="l05085"></a>05085 
<a name="l05086"></a>05086         <span class="keyword">static</span> String get_PublicDocuments()
<a name="l05087"></a>05087         {
<a name="l05088"></a>05088                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_PublicDocuments);
<a name="l05089"></a>05089         }
<a name="l05090"></a>05090 
<a name="l05091"></a>05091         <span class="keyword">static</span> String get_Desktop()
<a name="l05092"></a>05092         {
<a name="l05093"></a>05093                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Desktop);
<a name="l05094"></a>05094         }
<a name="l05095"></a>05095 
<a name="l05096"></a>05096         <span class="keyword">static</span> String get_PublicDesktop()
<a name="l05097"></a>05097         {
<a name="l05098"></a>05098                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_PublicDesktop);
<a name="l05099"></a>05099         }
<a name="l05100"></a>05100 
<a name="l05101"></a>05101         <span class="keyword">static</span> String get_History()
<a name="l05102"></a>05102         {
<a name="l05103"></a>05103                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_History);
<a name="l05104"></a>05104         }
<a name="l05105"></a>05105 
<a name="l05106"></a>05106         <span class="keyword">static</span> String get_SendTo()
<a name="l05107"></a>05107         {
<a name="l05108"></a>05108                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_SendTo);
<a name="l05109"></a>05109         }
<a name="l05110"></a>05110 
<a name="l05111"></a>05111         <span class="keyword">static</span> String get_StartMenu()
<a name="l05112"></a>05112         {
<a name="l05113"></a>05113                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_StartMenu);
<a name="l05114"></a>05114         }
<a name="l05115"></a>05115 
<a name="l05116"></a>05116         <span class="keyword">static</span> String get_CommonStartMenu()
<a name="l05117"></a>05117         {
<a name="l05118"></a>05118                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_CommonStartMenu);
<a name="l05119"></a>05119         }
<a name="l05120"></a>05120 
<a name="l05121"></a>05121         <span class="keyword">static</span> String get_Recent()
<a name="l05122"></a>05122         {
<a name="l05123"></a>05123                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Recent);
<a name="l05124"></a>05124         }
<a name="l05125"></a>05125 
<a name="l05126"></a>05126         <span class="keyword">static</span> String get_PrintersFolder()
<a name="l05127"></a>05127         {
<a name="l05128"></a>05128                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_PrintersFolder);
<a name="l05129"></a>05129         }
<a name="l05130"></a>05130 
<a name="l05131"></a>05131         <span class="keyword">static</span> String get_RecycleBinFolder()
<a name="l05132"></a>05132         {
<a name="l05133"></a>05133                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_RecycleBinFolder);
<a name="l05134"></a>05134         }
<a name="l05135"></a>05135 
<a name="l05136"></a>05136         <span class="keyword">static</span> String get_Templates()
<a name="l05137"></a>05137         {
<a name="l05138"></a>05138                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Templates);
<a name="l05139"></a>05139         }
<a name="l05140"></a>05140 
<a name="l05141"></a>05141         <span class="keyword">static</span> String get_CommonTemplates()
<a name="l05142"></a>05142         {
<a name="l05143"></a>05143                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_CommonTemplates);
<a name="l05144"></a>05144         }
<a name="l05145"></a>05145 
<a name="l05146"></a>05146         <span class="keyword">static</span> String get_AdminTools()
<a name="l05147"></a>05147         {
<a name="l05148"></a>05148                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_AdminTools);
<a name="l05149"></a>05149         }
<a name="l05150"></a>05150 
<a name="l05151"></a>05151         <span class="keyword">static</span> String get_CommonAdminTools()
<a name="l05152"></a>05152         {
<a name="l05153"></a>05153                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_CommonAdminTools);
<a name="l05154"></a>05154         }
<a name="l05155"></a>05155 
<a name="l05156"></a>05156         <span class="keyword">static</span> String get_Startup()
<a name="l05157"></a>05157         {
<a name="l05158"></a>05158                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Startup);
<a name="l05159"></a>05159         }
<a name="l05160"></a>05160 
<a name="l05161"></a>05161         <span class="keyword">static</span> String get_CommonStartup()
<a name="l05162"></a>05162         {
<a name="l05163"></a>05163                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_CommonStartup);
<a name="l05164"></a>05164         }
<a name="l05165"></a>05165 
<a name="l05166"></a>05166         <span class="keyword">static</span> String get_LocalAppData()
<a name="l05167"></a>05167         {
<a name="l05168"></a>05168                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_LocalAppData);
<a name="l05169"></a>05169         }
<a name="l05170"></a>05170 
<a name="l05171"></a>05171         <span class="keyword">static</span> String get_System()
<a name="l05172"></a>05172         {
<a name="l05173"></a>05173                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_System);
<a name="l05174"></a>05174         }
<a name="l05175"></a>05175 
<a name="l05176"></a>05176         <span class="keyword">static</span> String get_Windows()
<a name="l05177"></a>05177         {
<a name="l05178"></a>05178                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_Windows);
<a name="l05179"></a>05179         }
<a name="l05180"></a>05180 
<a name="l05181"></a>05181         <span class="keyword">static</span> String get_ProgramFiles()
<a name="l05182"></a>05182         {
<a name="l05183"></a>05183                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_ProgramFiles);
<a name="l05184"></a>05184         }
<a name="l05185"></a>05185 
<a name="l05186"></a>05186         <span class="keyword">static</span> String get_ProgramFilesCommon()
<a name="l05187"></a>05187         {
<a name="l05188"></a>05188                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_ProgramFilesCommon);
<a name="l05189"></a>05189         }
<a name="l05190"></a>05190 
<a name="l05191"></a>05191         <span class="keyword">static</span> String get_ProgramFilesX64()
<a name="l05192"></a>05192         {
<a name="l05193"></a>05193                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_ProgramFilesX64);
<a name="l05194"></a>05194         }
<a name="l05195"></a>05195 
<a name="l05196"></a>05196         <span class="keyword">static</span> String get_ProgramFilesX86()
<a name="l05197"></a>05197         {
<a name="l05198"></a>05198                 <span class="keywordflow">return</span> GetPathOf(FOLDERID_ProgramFilesX86);
<a name="l05199"></a>05199         }
<a name="l05200"></a>05200 
<a name="l05201"></a>05201 <span class="keyword">private</span>:
<a name="l05202"></a>05202         CTOR KnownFolders();
<a name="l05203"></a>05203 };
<a name="l05204"></a>05204 
<a name="l05205"></a>05205 }       <span class="comment">// System</span>
<a name="l05206"></a>05206 
<a name="l05207"></a>05207 <span class="preprocessor">#include &quot;WaveformData.h&quot;</span>
<a name="l05208"></a>05208 
<a name="l05209"></a>05209 <span class="keyword">namespace </span>System
<a name="l05210"></a>05210 {
<a name="l05211"></a>05211 <span class="keyword">namespace </span>Gui
<a name="l05212"></a>05212 {
<a name="l05213"></a>05213 
<a name="l05214"></a>05214 <span class="keyword">class </span>GUIEXT AudioSourceVoice : <span class="keyword">public</span> DependencyObject
<a name="l05215"></a>05215 {
<a name="l05216"></a>05216 <span class="keyword">public</span>:
<a name="l05217"></a>05217 
<a name="l05218"></a>05218         CTOR AudioSourceVoice();
<a name="l05219"></a>05219 
<a name="l05220"></a>05220         <span class="keywordtype">void</span> Play();
<a name="l05221"></a>05221 
<a name="l05222"></a>05222         <span class="keywordtype">void</span> Create();
<a name="l05223"></a>05223 
<a name="l05224"></a>05224 <span class="comment">//      DEPENDENCY_CLASS(AudioSourceVoice, DependencyObject)</span>
<a name="l05225"></a>05225 
<a name="l05226"></a>05226         DEPENDENCY_PROPERTY(<span class="keywordtype">bool</span>, IsPlaying)
<a name="l05227"></a>05227         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, Volume)
<a name="l05228"></a>05228         DEPENDENCY_PROPERTY(<span class="keywordtype">float</span>, FrequencyRatio)
<a name="l05229"></a>05229         DEPENDENCY_PROPERTY(int64, SamplesPlayed)
<a name="l05230"></a>05230 
<a name="l05231"></a>05231         DEPENDENCY_CLASS(AudioSourceVoice, DependencyObject)
<a name="l05232"></a>05232 
<a name="l05233"></a>05233         IXAudio2SourceVoice* m_pSourceVoice;
<a name="l05234"></a>05234         <span class="comment">//WAVEFORMATEX m_wfx;</span>
<a name="l05235"></a>05235         WaveformData* m_wave;
<a name="l05236"></a>05236 };
<a name="l05237"></a>05237 
<a name="l05238"></a>05238 }       <span class="comment">// Gui</span>
<a name="l05239"></a>05239 }       <span class="comment">// System</span>
<a name="l05240"></a>05240 
<a name="l05241"></a>05241 <span class="preprocessor">#include &quot;WaveformVisual.h&quot;</span>
<a name="l05242"></a>05242 <span class="preprocessor"></span>
<a name="l05243"></a>05243 <span class="keyword">namespace </span>System
<a name="l05244"></a>05244 {
<a name="l05245"></a>05245 <span class="keyword">namespace </span>Gui
<a name="l05246"></a>05246 {
<a name="l05247"></a>05247 
<a name="l05248"></a>05248 <span class="keyword">class </span>GUIEXT GraphAxisVisual : <span class="keyword">public</span> UIElement
<a name="l05249"></a>05249 {
<a name="l05250"></a>05250 <span class="keyword">public</span>:
<a name="l05251"></a>05251         CTOR GraphAxisVisual();
<a name="l05252"></a>05252 
<a name="l05253"></a>05253         <span class="keyword">virtual</span> <span class="keywordtype">void</span> Render(ManagedRenderContext renderContext) <span class="keyword">override</span>;
<a name="l05254"></a>05254 
<a name="l05255"></a>05255         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnMouseLeftButtonDown(MouseButtonEventArgs* args) <span class="keyword">override</span>;
<a name="l05256"></a>05256         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnMouseLeftButtonUp(MouseButtonEventArgs* args) <span class="keyword">override</span>;
<a name="l05257"></a>05257         <span class="keyword">virtual</span> <span class="keywordtype">void</span> OnMouseMove(MouseEventArgs* args) <span class="keyword">override</span>;
<a name="l05258"></a>05258 
<a name="l05259"></a>05259         <span class="comment">/*</span>
<a name="l05260"></a>05260 <span class="comment">        DEPENDENCY_PROPERTY(WaveformData*, Data)</span>
<a name="l05261"></a>05261 <span class="comment">        DEPENDENCY_PROPERTY(int64, AtSample)</span>
<a name="l05262"></a>05262 <span class="comment">        DEPENDENCY_PROPERTY(int64, SelectionStart)</span>
<a name="l05263"></a>05263 <span class="comment">        DEPENDENCY_PROPERTY(int64, SelectionEnd)</span>
<a name="l05264"></a>05264 <span class="comment">        */</span>
<a name="l05265"></a>05265 
<a name="l05266"></a>05266         vector&lt;Color*&gt; m_colors;
<a name="l05267"></a>05267         vector&lt;Vector2_F*&gt; m_points;
<a name="l05268"></a>05268 
<a name="l05269"></a>05269         Point m_oldpoint;
<a name="l05270"></a>05270 
<a name="l05271"></a>05271         <span class="keyword">static</span> DependencyClass* get_Class();
<a name="l05272"></a>05272         <span class="keyword">static</span> DependencyClass* pClass;
<a name="l05273"></a>05273         <span class="keyword">typedef</span> UIElement baseClass;
<a name="l05274"></a>05274 };
<a name="l05275"></a>05275 
<a name="l05276"></a>05276 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l05277"></a>05277 <span class="keyword">inline</span> IBinding* typed&lt;T&gt;::binding(DependencyObject* _this)<span class="keyword"> const</span>
<a name="l05278"></a>05278 <span class="keyword"></span>{
<a name="l05279"></a>05279         <span class="keywordflow">if</span> (m_exp)
<a name="l05280"></a>05280                 <span class="keywordflow">return</span> <span class="keyword">new</span> ExpressionBinding(_this, m_exp);
<a name="l05281"></a>05281         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_binding)
<a name="l05282"></a>05282                 <span class="keywordflow">return</span> m_binding;
<a name="l05283"></a>05283         <span class="keywordflow">else</span>
<a name="l05284"></a>05284                 <span class="keywordflow">return</span> NULL;
<a name="l05285"></a>05285 }
<a name="l05286"></a>05286 
<a name="l05287"></a>05287 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l05288"></a>05288 <span class="keywordtype">void</span> SetBinding(DependencyObject* depObj, DependencyProperty* dp, typed&lt;T&gt; value)
<a name="l05289"></a>05289 {
<a name="l05290"></a>05290         <span class="keywordflow">if</span> (value.hasBinding())
<a name="l05291"></a>05291         {
<a name="l05292"></a>05292                 depObj-&gt;GetProperty(dp)-&gt;SetInputBinding(value.binding(depObj));
<a name="l05293"></a>05293         }
<a name="l05294"></a>05294         <span class="keywordflow">else</span>
<a name="l05295"></a>05295         {
<a name="l05296"></a>05296                 depObj-&gt;GetProperty(dp)-&gt;SetLocalValue(value.m_const_value);
<a name="l05297"></a>05297         }
<a name="l05298"></a>05298 }
<a name="l05299"></a>05299 
<a name="l05300"></a>05300 <span class="preprocessor">#ifndef __LERSTAD__</span>
<a name="l05301"></a>05301 <span class="preprocessor"></span><span class="keyword">template</span> <span class="keyword">class </span>GUIEXT typed&lt;int&gt;;
<a name="l05302"></a>05302 <span class="keyword">template</span> <span class="keyword">class </span>GUIEXT typed&lt;float&gt;;
<a name="l05303"></a>05303 <span class="keyword">template</span> <span class="keyword">class </span>GUIEXT typed&lt;UIElement*&gt;;
<a name="l05304"></a>05304 <span class="preprocessor">#endif</span>
<a name="l05305"></a>05305 <span class="preprocessor"></span>
<a name="l05306"></a>05306 <span class="comment">// TODO, make a member of some class</span>
<a name="l05307"></a>05307 <span class="comment">//Object* Create(Refs2* refs, Window* ownerWindow, UIElement* templatedOwner, Object* object);</span>
<a name="l05308"></a>05308 UIElement* CreateObjectShadowTree(Object* <span class="keywordtype">object</span>);
<a name="l05309"></a>05309 
<a name="l05310"></a>05310 DependencyObject* GetTemplatedOwner(DependencyObject* depObject);
<a name="l05311"></a>05311 
<a name="l05312"></a>05312 GUIEXT <span class="keywordtype">int</span> MessageLoop();
<a name="l05313"></a>05313 
<a name="l05314"></a>05314 GUIEXT <span class="keywordtype">void</span> InitPhysics();
<a name="l05315"></a>05315 <span class="keyword">extern</span> GUIEXT NxPhysicsSDK* gPhysicsSDK;
<a name="l05316"></a>05316 
<a name="l05317"></a>05317 <span class="comment">// TODO: somewhere else</span>
<a name="l05318"></a>05318 GUIEXT <span class="keywordtype">bool</span> SaveBMP(Graphics::Bitmap* bitmap, StringIn filename);
<a name="l05319"></a>05319 GUIEXT <span class="keywordtype">bool</span> SaveBMP(Graphics::Bitmap* bitmap, IO::Stream* stream);
<a name="l05320"></a>05320 
<a name="l05321"></a>05321 GUIEXT Window* Show(Geometry* pgeometry);
<a name="l05322"></a>05322 GUIEXT Window* Show(Visual* visual);
<a name="l05323"></a>05323 
<a name="l05324"></a>05324 GUIEXT String DefaultPrinter();
<a name="l05325"></a>05325 GUIEXT <span class="keywordtype">bool</span> Print(Visual* visual);
<a name="l05326"></a>05326 
<a name="l05327"></a>05327 <span class="keyword">class </span>GUIEXT MessageWindow
<a name="l05328"></a>05328 {
<a name="l05329"></a>05329 <span class="keyword">public</span>:
<a name="l05330"></a>05330 
<a name="l05331"></a>05331         <span class="keyword">static</span> <span class="keywordtype">void</span> Init();
<a name="l05332"></a>05332         <span class="keyword">static</span> HWND GetHwnd();
<a name="l05333"></a>05333 
<a name="l05334"></a>05334 <span class="keyword">private</span>:
<a name="l05335"></a>05335 
<a name="l05336"></a>05336         CTOR MessageWindow();
<a name="l05337"></a>05337 
<a name="l05338"></a>05338         <span class="keyword">static</span> HWND m_hWnd;
<a name="l05339"></a>05339         <span class="keyword">static</span> LRESULT CALLBACK WndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
<a name="l05340"></a>05340 };
<a name="l05341"></a>05341 
<a name="l05342"></a>05342 GUIEXT Window* View(List&lt;String&gt;* pList);
<a name="l05343"></a>05343 
<a name="l05344"></a>05344 GUIEXT <span class="keywordtype">void</span> MakeScrollable(UIElement* element);
<a name="l05345"></a>05345 
<a name="l05346"></a>05346 <span class="keyword">class </span>GUIEXT MetafileLoader : <span class="keyword">public</span> Graphics::Loader2
<a name="l05347"></a>05347 {
<a name="l05348"></a>05348 <span class="keyword">public</span>:
<a name="l05349"></a>05349 
<a name="l05350"></a>05350         CTOR MetafileLoader();
<a name="l05351"></a>05351 
<a name="l05352"></a>05352         <span class="keyword">virtual</span> <span class="keywordtype">void</span> FileType() <span class="keyword">override</span>;
<a name="l05353"></a>05353 <span class="comment">//      virtual void SetMapMode(int mapmode) override;</span>
<a name="l05354"></a>05354 <span class="comment">//      virtual void SetWindowOrg(int x, int y) override;</span>
<a name="l05355"></a>05355 <span class="comment">//      virtual void SetWindowExt(int cx, int cy) override;</span>
<a name="l05356"></a>05356 <span class="comment">//      virtual void SetViewportOrg(int x, int y) override;</span>
<a name="l05357"></a>05357 <span class="comment">//      virtual void SetViewportExt(int cx, int cy) override;</span>
<a name="l05358"></a>05358 <span class="comment">//      virtual void SetTextColor(COLORREF color) override;</span>
<a name="l05359"></a>05359 <span class="comment">//      virtual void SetTextAlign(uint32 textAlign) override;</span>
<a name="l05360"></a>05360 <span class="comment">//      virtual void SetMiterLimit(float miterLimit) override;</span>
<a name="l05361"></a>05361         <span class="keyword">virtual</span> <span class="keywordtype">void</span> MoveTo(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) <span class="keyword">override</span>;
<a name="l05362"></a>05362         <span class="keyword">virtual</span> <span class="keywordtype">void</span> ExtTextOut(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, StringIn <span class="keywordtype">string</span>, <span class="keyword">const</span> <span class="keywordtype">int</span>* distances) <span class="keyword">override</span>;
<a name="l05363"></a>05363         <span class="keyword">virtual</span> <span class="keywordtype">void</span> SelectObject(<span class="keywordtype">int</span> n) <span class="keyword">override</span>;
<a name="l05364"></a>05364         <span class="keyword">virtual</span> <span class="keywordtype">void</span> DeleteObject(<span class="keywordtype">int</span> n) <span class="keyword">override</span>;
<a name="l05365"></a>05365         <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreatePenIndirect(<span class="keywordtype">int</span> index, <span class="keyword">const</span> Graphics::LOGPEN&amp; lp) <span class="keyword">override</span>;
<a name="l05366"></a>05366         <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreatePenIndirect(<span class="keywordtype">int</span> index, <span class="keyword">const</span> Graphics::EXTLOGPEN&amp; lp) <span class="keyword">override</span>;
<a name="l05367"></a>05367         <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateBrushIndirect(<span class="keywordtype">int</span> index, <span class="keyword">const</span> Graphics::LOGBRUSH&amp; lb) <span class="keyword">override</span>;
<a name="l05368"></a>05368         <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateFontIndirect(<span class="keywordtype">int</span> index, <span class="keyword">const</span> Graphics::LOGFONT_16&amp; lf) <span class="keyword">override</span>;
<a name="l05369"></a>05369         <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateFontIndirect(<span class="keywordtype">int</span> index, <span class="keyword">const</span> Graphics::LOGFONTA&amp; lf) <span class="keyword">override</span>;
<a name="l05370"></a>05370         <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateFontIndirect(<span class="keywordtype">int</span> index, <span class="keyword">const</span> Graphics::LOGFONTW&amp; lf) <span class="keyword">override</span>;
<a name="l05371"></a>05371         <span class="keyword">virtual</span> <span class="keywordtype">void</span> StretchDIBits(<span class="keywordtype">int</span> destX, <span class="keywordtype">int</span> destY, <span class="keywordtype">int</span> destWidth, <span class="keywordtype">int</span> destHeight, <span class="keywordtype">int</span> srcX, <span class="keywordtype">int</span> srcY, <span class="keywordtype">int</span> srcWidth, <span class="keywordtype">int</span> srcHeight, Graphics::Bitmap* bitmap) <span class="keyword">override</span>;
<a name="l05372"></a>05372         <span class="keyword">virtual</span> <span class="keywordtype">void</span> FillPath() <span class="keyword">override</span>;
<a name="l05373"></a>05373 
<a name="l05374"></a>05374         Visuals* pCommands;
<a name="l05375"></a>05375 
<a name="l05376"></a>05376 <span class="keyword">protected</span>:
<a name="l05377"></a>05377 
<a name="l05378"></a>05378         <span class="keyword">class </span>ObjectPen : <span class="keyword">public</span> Graphics::wmfObject
<a name="l05379"></a>05379         {
<a name="l05380"></a>05380         <span class="keyword">public</span>:
<a name="l05381"></a>05381                 CTOR ObjectPen()
<a name="l05382"></a>05382                 {
<a name="l05383"></a>05383                         m_type = Graphics::wmfOBJ_PEN;
<a name="l05384"></a>05384                 }
<a name="l05385"></a>05385 
<a name="l05386"></a>05386         <span class="comment">//      LDraw::Pen* m_pPen;</span>
<a name="l05387"></a>05387                 Brush* m_brush;
<a name="l05388"></a>05388                 <span class="keywordtype">float</span> m_width;
<a name="l05389"></a>05389         };
<a name="l05390"></a>05390 
<a name="l05391"></a>05391         <span class="keyword">class </span>ObjectBrush : <span class="keyword">public</span> Graphics::wmfObject
<a name="l05392"></a>05392         {
<a name="l05393"></a>05393         <span class="keyword">public</span>:
<a name="l05394"></a>05394                 CTOR ObjectBrush()
<a name="l05395"></a>05395                 {
<a name="l05396"></a>05396                         m_type = Graphics::wmfOBJ_BRUSH;
<a name="l05397"></a>05397                 }
<a name="l05398"></a>05398                 Brush* m_pBrush;
<a name="l05399"></a>05399         };
<a name="l05400"></a>05400 
<a name="l05401"></a>05401         <span class="keyword">class </span>ObjectFont : <span class="keyword">public</span> Graphics::wmfObject
<a name="l05402"></a>05402         {
<a name="l05403"></a>05403         <span class="keyword">public</span>:
<a name="l05404"></a>05404                 CTOR ObjectFont()
<a name="l05405"></a>05405                 {
<a name="l05406"></a>05406                         m_type = Graphics::wmfOBJ_FONT;
<a name="l05407"></a>05407                 }
<a name="l05408"></a>05408 <span class="preprocessor">        #if 0</span>
<a name="l05409"></a>05409 <span class="preprocessor"></span>                LDraw::Font* m_pFont;
<a name="l05410"></a>05410 <span class="preprocessor">        #endif</span>
<a name="l05411"></a>05411 <span class="preprocessor"></span>        };
<a name="l05412"></a>05412 
<a name="l05413"></a>05413         PathGeometry* m_path;
<a name="l05414"></a>05414 
<a name="l05415"></a>05415         ObjectPen* m_pCurPen;
<a name="l05416"></a>05416         ObjectBrush* m_pCurBrush;
<a name="l05417"></a>05417         ObjectFont* m_pCurFont;
<a name="l05418"></a>05418 };
<a name="l05419"></a>05419 
<a name="l05420"></a>05420 GUIEXT <span class="keywordtype">void</span> print_(Visual* visual);
<a name="l05421"></a>05421 
<a name="l05422"></a>05422 }       <span class="comment">// Gui</span>
<a name="l05423"></a>05423 
<a name="l05424"></a>05424 GUIEXT <span class="keywordtype">void</span> AddView(Object* obj, Object* view);
<a name="l05425"></a>05425 
<a name="l05426"></a>05426 GUIEXT Object* GetSource(Object* obj);
<a name="l05427"></a>05427 GUIEXT Object* GetView(Object* obj);
<a name="l05428"></a>05428 GUIEXT IEnumerator&lt;Object*&gt;* GetViews(Object* obj);
<a name="l05429"></a>05429 
<a name="l05430"></a>05430 GUIEXT Object* GetFile(StringIn name);
<a name="l05431"></a>05431 GUIEXT <span class="keywordtype">void</span> SaveAs(Object* obj, StringIn name);
<a name="l05432"></a>05432 
<a name="l05433"></a>05433 GUIEXT <span class="keywordtype">void</span> Show(Graphics::Bitmap* bitmap);
<a name="l05434"></a>05434 
<a name="l05435"></a>05435 GUIEXT TextDocument* ascpp(ClassType* pType);
<a name="l05436"></a>05436 
<a name="l05437"></a>05437 GUIEXT Gui::Window* Edit(Gui::Vector2_F* vec);
<a name="l05438"></a>05438 
<a name="l05439"></a>05439 GUIEXT <span class="keywordtype">int</span> OSVersion();
<a name="l05440"></a>05440 
<a name="l05441"></a>05441 <span class="keyword">class </span>GUIEXT Math
<a name="l05442"></a>05442 {
<a name="l05443"></a>05443 <span class="keyword">public</span>:
<a name="l05444"></a>05444 
<a name="l05445"></a>05445         <span class="keyword">static</span> <span class="keywordtype">float</span> cos(<span class="keywordtype">float</span> x)
<a name="l05446"></a>05446         {
<a name="l05447"></a>05447                 return ::cosf(x);
<a name="l05448"></a>05448         }
<a name="l05449"></a>05449 
<a name="l05450"></a>05450         <span class="keyword">static</span> <span class="keywordtype">float</span> sin(<span class="keywordtype">float</span> x)
<a name="l05451"></a>05451         {
<a name="l05452"></a>05452                 return ::sinf(x);
<a name="l05453"></a>05453         }
<a name="l05454"></a>05454 
<a name="l05455"></a>05455         <span class="keyword">static</span> <span class="keywordtype">float</span> acos(<span class="keywordtype">float</span> x)
<a name="l05456"></a>05456         {
<a name="l05457"></a>05457                 return ::acosf(x);
<a name="l05458"></a>05458         }
<a name="l05459"></a>05459 
<a name="l05460"></a>05460         <span class="keyword">static</span> <span class="keywordtype">float</span> asin(<span class="keywordtype">float</span> x)
<a name="l05461"></a>05461         {
<a name="l05462"></a>05462                 return ::asinf(x);
<a name="l05463"></a>05463         }
<a name="l05464"></a>05464 
<a name="l05465"></a>05465         <span class="keyword">static</span> <span class="keywordtype">float</span> tan(<span class="keywordtype">float</span> x)
<a name="l05466"></a>05466         {
<a name="l05467"></a>05467                 return ::tanf(x);
<a name="l05468"></a>05468         }
<a name="l05469"></a>05469 
<a name="l05470"></a>05470         <span class="keyword">static</span> <span class="keywordtype">float</span> atan(<span class="keywordtype">float</span> x)
<a name="l05471"></a>05471         {
<a name="l05472"></a>05472                 return ::atanf(x);
<a name="l05473"></a>05473         }
<a name="l05474"></a>05474 
<a name="l05475"></a>05475 <span class="comment">//      const double PI = 3.14159265358979323846;</span>
<a name="l05476"></a>05476 <span class="comment">//      const double SQRT2 = 1.4142135623730950488016887242097;</span>
<a name="l05477"></a>05477 
<a name="l05478"></a>05478 <span class="comment">//      static const float PI = 3.141592653f;</span>
<a name="l05479"></a>05479 <span class="comment">//      static const float SQRT2 = 1.4142135623f;</span>
<a name="l05480"></a>05480 
<a name="l05481"></a>05481 <span class="keyword">private</span>:
<a name="l05482"></a>05482 
<a name="l05483"></a>05483         CTOR Math();
<a name="l05484"></a>05484 };
<a name="l05485"></a>05485 
<a name="l05486"></a>05486 }       <span class="comment">// System</span>
<a name="l05487"></a>05487 
<a name="l05488"></a>05488 <span class="keyword">namespace </span>System
<a name="l05489"></a>05489 {
<a name="l05490"></a>05490 <span class="keyword">namespace </span>Gui
<a name="l05491"></a>05491 {
<a name="l05492"></a>05492 
<a name="l05493"></a>05493 <span class="keyword">class </span>GUIEXT VidCap : <span class="keyword">public</span> Object
<a name="l05494"></a>05494 {
<a name="l05495"></a>05495 <span class="keyword">public</span>:
<a name="l05496"></a>05496 
<a name="l05497"></a>05497         CTOR VidCap();
<a name="l05498"></a>05498 
<a name="l05499"></a>05499         <span class="keywordtype">void</span> Capture();
<a name="l05500"></a>05500 
<a name="l05501"></a>05501         ComPtr&lt;IGraphBuilder&gt; m_pGraph;
<a name="l05502"></a>05502         ComPtr&lt;ICaptureGraphBuilder2&gt; m_pBuild;
<a name="l05503"></a>05503 };
<a name="l05504"></a>05504 
<a name="l05505"></a>05505 }
<a name="l05506"></a>05506 }
<a name="l05507"></a>05507 
<a name="l05508"></a>05508 <span class="preprocessor">#include &quot;MLTranslate.h&quot;</span>
<a name="l05509"></a>05509 
<a name="l05510"></a>05510 <span class="preprocessor">#endif  // GUI_h</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 17 2011 00:57:10 for FirstProject2 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
